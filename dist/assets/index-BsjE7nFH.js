(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();function Gs(i){const t=Object.create(null);for(const e of i.split(","))t[e]=1;return e=>e in t}const yt={},oi=[],ae=()=>{},po=()=>!1,kn=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&(i.charCodeAt(2)>122||i.charCodeAt(2)<97),Ds=i=>i.startsWith("onUpdate:"),kt=Object.assign,Fs=(i,t)=>{const e=i.indexOf(t);e>-1&&i.splice(e,1)},sl=Object.prototype.hasOwnProperty,dt=(i,t)=>sl.call(i,t),et=Array.isArray,ai=i=>On(i)==="[object Map]",mo=i=>On(i)==="[object Set]",nt=i=>typeof i=="function",Tt=i=>typeof i=="string",Ie=i=>typeof i=="symbol",vt=i=>i!==null&&typeof i=="object",_o=i=>(vt(i)||nt(i))&&nt(i.then)&&nt(i.catch),yo=Object.prototype.toString,On=i=>yo.call(i),rl=i=>On(i).slice(8,-1),bo=i=>On(i)==="[object Object]",Ns=i=>Tt(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,Li=Gs(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ln=i=>{const t=Object.create(null);return(e=>t[e]||(t[e]=i(e)))},ol=/-\w/g,ke=Ln(i=>i.replace(ol,t=>t.slice(1).toUpperCase())),al=/\B([A-Z])/g,Xe=Ln(i=>i.replace(al,"-$1").toLowerCase()),xo=Ln(i=>i.charAt(0).toUpperCase()+i.slice(1)),Yn=Ln(i=>i?`on${xo(i)}`:""),Me=(i,t)=>!Object.is(i,t),jn=(i,...t)=>{for(let e=0;e<i.length;e++)i[e](...t)},vo=(i,t,e,n=!1)=>{Object.defineProperty(i,t,{configurable:!0,enumerable:!1,writable:n,value:e})},ll=i=>{const t=parseFloat(i);return isNaN(t)?i:t};let hr;const In=()=>hr||(hr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Bs(i){if(et(i)){const t={};for(let e=0;e<i.length;e++){const n=i[e],s=Tt(n)?fl(n):Bs(n);if(s)for(const r in s)t[r]=s[r]}return t}else if(Tt(i)||vt(i))return i}const hl=/;(?![^(]*\))/g,cl=/:([^]+)/,dl=/\/\*[^]*?\*\//g;function fl(i){const t={};return i.replace(dl,"").split(hl).forEach(e=>{if(e){const n=e.split(cl);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function Yi(i){let t="";if(Tt(i))t=i;else if(et(i))for(let e=0;e<i.length;e++){const n=Yi(i[e]);n&&(t+=n+" ")}else if(vt(i))for(const e in i)i[e]&&(t+=e+" ");return t.trim()}const ul="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",gl=Gs(ul);function So(i){return!!i||i===""}const Co=i=>!!(i&&i.__v_isRef===!0),ie=i=>Tt(i)?i:i==null?"":et(i)||vt(i)&&(i.toString===yo||!nt(i.toString))?Co(i)?ie(i.value):JSON.stringify(i,wo,2):String(i),wo=(i,t)=>Co(t)?wo(i,t.value):ai(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[n,s],r)=>(e[Kn(n,r)+" =>"]=s,e),{})}:mo(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Kn(e))}:Ie(t)?Kn(t):vt(t)&&!et(t)&&!bo(t)?String(t):t,Kn=(i,t="")=>{var e;return Ie(i)?`Symbol(${(e=i.description)!=null?e:t})`:i};let Ft;class pl{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ft,!t&&Ft&&(this.index=(Ft.scopes||(Ft.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Ft;try{return Ft=this,t()}finally{Ft=e}}}on(){++this._on===1&&(this.prevScope=Ft,Ft=this)}off(){this._on>0&&--this._on===0&&(Ft=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(this.effects.length=0,e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function ml(){return Ft}let mt;const Xn=new WeakSet;class To{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ft&&Ft.active&&Ft.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Xn.has(this)&&(Xn.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ao(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,cr(this),Eo(this);const t=mt,e=$t;mt=this,$t=!0;try{return this.fn()}finally{Ro(this),mt=t,$t=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)zs(t);this.deps=this.depsTail=void 0,cr(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Xn.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ds(this)&&this.run()}get dirty(){return ds(this)}}let Po=0,Ii,Gi;function Ao(i,t=!1){if(i.flags|=8,t){i.next=Gi,Gi=i;return}i.next=Ii,Ii=i}function Hs(){Po++}function Ws(){if(--Po>0)return;if(Gi){let t=Gi;for(Gi=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let i;for(;Ii;){let t=Ii;for(Ii=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){i||(i=n)}t=e}}if(i)throw i}function Eo(i){for(let t=i.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Ro(i){let t,e=i.depsTail,n=e;for(;n;){const s=n.prevDep;n.version===-1?(n===e&&(e=s),zs(n),_l(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}i.deps=t,i.depsTail=e}function ds(i){for(let t=i.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Mo(t.dep.computed)||t.dep.version!==t.version))return!0;return!!i._dirty}function Mo(i){if(i.flags&4&&!(i.flags&16)||(i.flags&=-17,i.globalVersion===ji)||(i.globalVersion=ji,!i.isSSR&&i.flags&128&&(!i.deps&&!i._dirty||!ds(i))))return;i.flags|=2;const t=i.dep,e=mt,n=$t;mt=i,$t=!0;try{Eo(i);const s=i.fn(i._value);(t.version===0||Me(s,i._value))&&(i.flags|=128,i._value=s,t.version++)}catch(s){throw t.version++,s}finally{mt=e,$t=n,Ro(i),i.flags&=-3}}function zs(i,t=!1){const{dep:e,prevSub:n,nextSub:s}=i;if(n&&(n.nextSub=s,i.prevSub=void 0),s&&(s.prevSub=n,i.nextSub=void 0),e.subs===i&&(e.subs=n,!n&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)zs(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function _l(i){const{prevDep:t,nextDep:e}=i;t&&(t.nextDep=e,i.prevDep=void 0),e&&(e.prevDep=t,i.nextDep=void 0)}let $t=!0;const ko=[];function pe(){ko.push($t),$t=!1}function me(){const i=ko.pop();$t=i===void 0?!0:i}function cr(i){const{cleanup:t}=i;if(i.cleanup=void 0,t){const e=mt;mt=void 0;try{t()}finally{mt=e}}}let ji=0;class yl{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Us{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!mt||!$t||mt===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==mt)e=this.activeLink=new yl(mt,this),mt.deps?(e.prevDep=mt.depsTail,mt.depsTail.nextDep=e,mt.depsTail=e):mt.deps=mt.depsTail=e,Oo(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const n=e.nextDep;n.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=n),e.prevDep=mt.depsTail,e.nextDep=void 0,mt.depsTail.nextDep=e,mt.depsTail=e,mt.deps===e&&(mt.deps=n)}return e}trigger(t){this.version++,ji++,this.notify(t)}notify(t){Hs();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{Ws()}}}function Oo(i){if(i.dep.sc++,i.sub.flags&4){const t=i.dep.computed;if(t&&!i.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)Oo(n)}const e=i.dep.subs;e!==i&&(i.prevSub=e,e&&(e.nextSub=i)),i.dep.subs=i}}const fs=new WeakMap,je=Symbol(""),us=Symbol(""),Ki=Symbol("");function Rt(i,t,e){if($t&&mt){let n=fs.get(i);n||fs.set(i,n=new Map);let s=n.get(e);s||(n.set(e,s=new Us),s.map=n,s.key=e),s.track()}}function ue(i,t,e,n,s,r){const o=fs.get(i);if(!o){ji++;return}const a=l=>{l&&l.trigger()};if(Hs(),t==="clear")o.forEach(a);else{const l=et(i),c=l&&Ns(e);if(l&&e==="length"){const h=Number(n);o.forEach((d,f)=>{(f==="length"||f===Ki||!Ie(f)&&f>=h)&&a(d)})}else switch((e!==void 0||o.has(void 0))&&a(o.get(e)),c&&a(o.get(Ki)),t){case"add":l?c&&a(o.get("length")):(a(o.get(je)),ai(i)&&a(o.get(us)));break;case"delete":l||(a(o.get(je)),ai(i)&&a(o.get(us)));break;case"set":ai(i)&&a(o.get(je));break}}Ws()}function Ze(i){const t=ct(i);return t===i?t:(Rt(t,"iterate",Ki),Xt(i)?t:t.map(qt))}function Gn(i){return Rt(i=ct(i),"iterate",Ki),i}function Te(i,t){return _e(i)?ci(Ke(i)?qt(t):t):qt(t)}const bl={__proto__:null,[Symbol.iterator](){return Vn(this,Symbol.iterator,i=>Te(this,i))},concat(...i){return Ze(this).concat(...i.map(t=>et(t)?Ze(t):t))},entries(){return Vn(this,"entries",i=>(i[1]=Te(this,i[1]),i))},every(i,t){return ce(this,"every",i,t,void 0,arguments)},filter(i,t){return ce(this,"filter",i,t,e=>e.map(n=>Te(this,n)),arguments)},find(i,t){return ce(this,"find",i,t,e=>Te(this,e),arguments)},findIndex(i,t){return ce(this,"findIndex",i,t,void 0,arguments)},findLast(i,t){return ce(this,"findLast",i,t,e=>Te(this,e),arguments)},findLastIndex(i,t){return ce(this,"findLastIndex",i,t,void 0,arguments)},forEach(i,t){return ce(this,"forEach",i,t,void 0,arguments)},includes(...i){return $n(this,"includes",i)},indexOf(...i){return $n(this,"indexOf",i)},join(i){return Ze(this).join(i)},lastIndexOf(...i){return $n(this,"lastIndexOf",i)},map(i,t){return ce(this,"map",i,t,void 0,arguments)},pop(){return yi(this,"pop")},push(...i){return yi(this,"push",i)},reduce(i,...t){return dr(this,"reduce",i,t)},reduceRight(i,...t){return dr(this,"reduceRight",i,t)},shift(){return yi(this,"shift")},some(i,t){return ce(this,"some",i,t,void 0,arguments)},splice(...i){return yi(this,"splice",i)},toReversed(){return Ze(this).toReversed()},toSorted(i){return Ze(this).toSorted(i)},toSpliced(...i){return Ze(this).toSpliced(...i)},unshift(...i){return yi(this,"unshift",i)},values(){return Vn(this,"values",i=>Te(this,i))}};function Vn(i,t,e){const n=Gn(i),s=n[t]();return n!==i&&!Xt(i)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.done||(r.value=e(r.value)),r}),s}const xl=Array.prototype;function ce(i,t,e,n,s,r){const o=Gn(i),a=o!==i&&!Xt(i),l=o[t];if(l!==xl[t]){const d=l.apply(i,r);return a?qt(d):d}let c=e;o!==i&&(a?c=function(d,f){return e.call(this,Te(i,d),f,i)}:e.length>2&&(c=function(d,f){return e.call(this,d,f,i)}));const h=l.call(o,c,n);return a&&s?s(h):h}function dr(i,t,e,n){const s=Gn(i);let r=e;return s!==i&&(Xt(i)?e.length>3&&(r=function(o,a,l){return e.call(this,o,a,l,i)}):r=function(o,a,l){return e.call(this,o,Te(i,a),l,i)}),s[t](r,...n)}function $n(i,t,e){const n=ct(i);Rt(n,"iterate",Ki);const s=n[t](...e);return(s===-1||s===!1)&&Ks(e[0])?(e[0]=ct(e[0]),n[t](...e)):s}function yi(i,t,e=[]){pe(),Hs();const n=ct(i)[t].apply(i,e);return Ws(),me(),n}const vl=Gs("__proto__,__v_isRef,__isVue"),Lo=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(Ie));function Sl(i){Ie(i)||(i=String(i));const t=ct(this);return Rt(t,"has",i),t.hasOwnProperty(i)}class Io{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,n){if(e==="__v_skip")return t.__v_skip;const s=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!s;if(e==="__v_isReadonly")return s;if(e==="__v_isShallow")return r;if(e==="__v_raw")return n===(s?r?Ol:No:r?Fo:Do).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const o=et(t);if(!s){let l;if(o&&(l=bl[e]))return l;if(e==="hasOwnProperty")return Sl}const a=Reflect.get(t,e,Mt(t)?t:n);if((Ie(e)?Lo.has(e):vl(e))||(s||Rt(t,"get",e),r))return a;if(Mt(a)){const l=o&&Ns(e)?a:a.value;return s&&vt(l)?ps(l):l}return vt(a)?s?ps(a):Xi(a):a}}class Go extends Io{constructor(t=!1){super(!1,t)}set(t,e,n,s){let r=t[e];const o=et(t)&&Ns(e);if(!this._isShallow){const c=_e(r);if(!Xt(n)&&!_e(n)&&(r=ct(r),n=ct(n)),!o&&Mt(r)&&!Mt(n))return c||(r.value=n),!0}const a=o?Number(e)<t.length:dt(t,e),l=Reflect.set(t,e,n,Mt(t)?t:s);return t===ct(s)&&(a?Me(n,r)&&ue(t,"set",e,n):ue(t,"add",e,n)),l}deleteProperty(t,e){const n=dt(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&n&&ue(t,"delete",e,void 0),s}has(t,e){const n=Reflect.has(t,e);return(!Ie(e)||!Lo.has(e))&&Rt(t,"has",e),n}ownKeys(t){return Rt(t,"iterate",et(t)?"length":je),Reflect.ownKeys(t)}}class Cl extends Io{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const wl=new Go,Tl=new Cl,Pl=new Go(!0);const gs=i=>i,nn=i=>Reflect.getPrototypeOf(i);function Al(i,t,e){return function(...n){const s=this.__v_raw,r=ct(s),o=ai(r),a=i==="entries"||i===Symbol.iterator&&o,l=i==="keys"&&o,c=s[i](...n),h=e?gs:t?ci:qt;return!t&&Rt(r,"iterate",l?us:je),kt(Object.create(c),{next(){const{value:d,done:f}=c.next();return f?{value:d,done:f}:{value:a?[h(d[0]),h(d[1])]:h(d),done:f}}})}}function sn(i){return function(...t){return i==="delete"?!1:i==="clear"?void 0:this}}function El(i,t){const e={get(s){const r=this.__v_raw,o=ct(r),a=ct(s);i||(Me(s,a)&&Rt(o,"get",s),Rt(o,"get",a));const{has:l}=nn(o),c=t?gs:i?ci:qt;if(l.call(o,s))return c(r.get(s));if(l.call(o,a))return c(r.get(a));r!==o&&r.get(s)},get size(){const s=this.__v_raw;return!i&&Rt(ct(s),"iterate",je),s.size},has(s){const r=this.__v_raw,o=ct(r),a=ct(s);return i||(Me(s,a)&&Rt(o,"has",s),Rt(o,"has",a)),s===a?r.has(s):r.has(s)||r.has(a)},forEach(s,r){const o=this,a=o.__v_raw,l=ct(a),c=t?gs:i?ci:qt;return!i&&Rt(l,"iterate",je),a.forEach((h,d)=>s.call(r,c(h),c(d),o))}};return kt(e,i?{add:sn("add"),set:sn("set"),delete:sn("delete"),clear:sn("clear")}:{add(s){!t&&!Xt(s)&&!_e(s)&&(s=ct(s));const r=ct(this);return nn(r).has.call(r,s)||(r.add(s),ue(r,"add",s,s)),this},set(s,r){!t&&!Xt(r)&&!_e(r)&&(r=ct(r));const o=ct(this),{has:a,get:l}=nn(o);let c=a.call(o,s);c||(s=ct(s),c=a.call(o,s));const h=l.call(o,s);return o.set(s,r),c?Me(r,h)&&ue(o,"set",s,r):ue(o,"add",s,r),this},delete(s){const r=ct(this),{has:o,get:a}=nn(r);let l=o.call(r,s);l||(s=ct(s),l=o.call(r,s)),a&&a.call(r,s);const c=r.delete(s);return l&&ue(r,"delete",s,void 0),c},clear(){const s=ct(this),r=s.size!==0,o=s.clear();return r&&ue(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=Al(s,i,t)}),e}function Ys(i,t){const e=El(i,t);return(n,s,r)=>s==="__v_isReactive"?!i:s==="__v_isReadonly"?i:s==="__v_raw"?n:Reflect.get(dt(e,s)&&s in n?e:n,s,r)}const Rl={get:Ys(!1,!1)},Ml={get:Ys(!1,!0)},kl={get:Ys(!0,!1)};const Do=new WeakMap,Fo=new WeakMap,No=new WeakMap,Ol=new WeakMap;function Ll(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Il(i){return i.__v_skip||!Object.isExtensible(i)?0:Ll(rl(i))}function Xi(i){return _e(i)?i:js(i,!1,wl,Rl,Do)}function Gl(i){return js(i,!1,Pl,Ml,Fo)}function ps(i){return js(i,!0,Tl,kl,No)}function js(i,t,e,n,s){if(!vt(i)||i.__v_raw&&!(t&&i.__v_isReactive))return i;const r=Il(i);if(r===0)return i;const o=s.get(i);if(o)return o;const a=new Proxy(i,r===2?n:e);return s.set(i,a),a}function Ke(i){return _e(i)?Ke(i.__v_raw):!!(i&&i.__v_isReactive)}function _e(i){return!!(i&&i.__v_isReadonly)}function Xt(i){return!!(i&&i.__v_isShallow)}function Ks(i){return i?!!i.__v_raw:!1}function ct(i){const t=i&&i.__v_raw;return t?ct(t):i}function Dl(i){return!dt(i,"__v_skip")&&Object.isExtensible(i)&&vo(i,"__v_skip",!0),i}const qt=i=>vt(i)?Xi(i):i,ci=i=>vt(i)?ps(i):i;function Mt(i){return i?i.__v_isRef===!0:!1}function bi(i){return Fl(i,!1)}function Fl(i,t){return Mt(i)?i:new Nl(i,t)}class Nl{constructor(t,e){this.dep=new Us,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:ct(t),this._value=e?t:qt(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,n=this.__v_isShallow||Xt(t)||_e(t);t=n?t:ct(t),Me(t,e)&&(this._rawValue=t,this._value=n?t:qt(t),this.dep.trigger())}}function ms(i){return Mt(i)?i.value:i}const Bl={get:(i,t,e)=>t==="__v_raw"?i:ms(Reflect.get(i,t,e)),set:(i,t,e,n)=>{const s=i[t];return Mt(s)&&!Mt(e)?(s.value=e,!0):Reflect.set(i,t,e,n)}};function Bo(i){return Ke(i)?i:new Proxy(i,Bl)}class Hl{constructor(t,e,n){this.fn=t,this.setter=e,this._value=void 0,this.dep=new Us(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ji-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&mt!==this)return Ao(this,!0),!0}get value(){const t=this.dep.track();return Mo(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Wl(i,t,e=!1){let n,s;return nt(i)?n=i:(n=i.get,s=i.set),new Hl(n,s,e)}const rn={},Sn=new WeakMap;let ze;function zl(i,t=!1,e=ze){if(e){let n=Sn.get(e);n||Sn.set(e,n=[]),n.push(i)}}function Ul(i,t,e=yt){const{immediate:n,deep:s,once:r,scheduler:o,augmentJob:a,call:l}=e,c=S=>s?S:Xt(S)||s===!1||s===0?Ee(S,1):Ee(S);let h,d,f,g,u=!1,_=!1;if(Mt(i)?(d=()=>i.value,u=Xt(i)):Ke(i)?(d=()=>c(i),u=!0):et(i)?(_=!0,u=i.some(S=>Ke(S)||Xt(S)),d=()=>i.map(S=>{if(Mt(S))return S.value;if(Ke(S))return c(S);if(nt(S))return l?l(S,2):S()})):nt(i)?t?d=l?()=>l(i,2):i:d=()=>{if(f){pe();try{f()}finally{me()}}const S=ze;ze=h;try{return l?l(i,3,[g]):i(g)}finally{ze=S}}:d=ae,t&&s){const S=d,I=s===!0?1/0:s;d=()=>Ee(S(),I)}const C=ml(),b=()=>{h.stop(),C&&C.active&&Fs(C.effects,h)};if(r&&t){const S=t;t=(...I)=>{S(...I),b()}}let v=_?new Array(i.length).fill(rn):rn;const w=S=>{if(!(!(h.flags&1)||!h.dirty&&!S))if(t){const I=h.run();if(s||u||(_?I.some((k,K)=>Me(k,v[K])):Me(I,v))){f&&f();const k=ze;ze=h;try{const K=[I,v===rn?void 0:_&&v[0]===rn?[]:v,g];v=I,l?l(t,3,K):t(...K)}finally{ze=k}}}else h.run()};return a&&a(w),h=new To(d),h.scheduler=o?()=>o(w,!1):w,g=S=>zl(S,!1,h),f=h.onStop=()=>{const S=Sn.get(h);if(S){if(l)l(S,4);else for(const I of S)I();Sn.delete(h)}},t?n?w(!0):v=h.run():o?o(w.bind(null,!0),!0):h.run(),b.pause=h.pause.bind(h),b.resume=h.resume.bind(h),b.stop=b,b}function Ee(i,t=1/0,e){if(t<=0||!vt(i)||i.__v_skip||(e=e||new Map,(e.get(i)||0)>=t))return i;if(e.set(i,t),t--,Mt(i))Ee(i.value,t,e);else if(et(i))for(let n=0;n<i.length;n++)Ee(i[n],t,e);else if(mo(i)||ai(i))i.forEach(n=>{Ee(n,t,e)});else if(bo(i)){for(const n in i)Ee(i[n],t,e);for(const n of Object.getOwnPropertySymbols(i))Object.prototype.propertyIsEnumerable.call(i,n)&&Ee(i[n],t,e)}return i}function Ji(i,t,e,n){try{return n?i(...n):i()}catch(s){Dn(s,t,e)}}function le(i,t,e,n){if(nt(i)){const s=Ji(i,t,e,n);return s&&_o(s)&&s.catch(r=>{Dn(r,t,e)}),s}if(et(i)){const s=[];for(let r=0;r<i.length;r++)s.push(le(i[r],t,e,n));return s}}function Dn(i,t,e,n=!0){const s=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||yt;if(t){let a=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${e}`;for(;a;){const h=a.ec;if(h){for(let d=0;d<h.length;d++)if(h[d](i,l,c)===!1)return}a=a.parent}if(r){pe(),Ji(r,null,10,[i,l,c]),me();return}}Yl(i,e,s,n,o)}function Yl(i,t,e,n=!0,s=!1){if(s)throw i;console.error(i)}const Lt=[];let ne=-1;const li=[];let Pe=null,ni=0;const Ho=Promise.resolve();let Cn=null;function Wo(i){const t=Cn||Ho;return i?t.then(this?i.bind(this):i):t}function jl(i){let t=ne+1,e=Lt.length;for(;t<e;){const n=t+e>>>1,s=Lt[n],r=Vi(s);r<i||r===i&&s.flags&2?t=n+1:e=n}return t}function Xs(i){if(!(i.flags&1)){const t=Vi(i),e=Lt[Lt.length-1];!e||!(i.flags&2)&&t>=Vi(e)?Lt.push(i):Lt.splice(jl(t),0,i),i.flags|=1,zo()}}function zo(){Cn||(Cn=Ho.then(Yo))}function Kl(i){et(i)?li.push(...i):Pe&&i.id===-1?Pe.splice(ni+1,0,i):i.flags&1||(li.push(i),i.flags|=1),zo()}function fr(i,t,e=ne+1){for(;e<Lt.length;e++){const n=Lt[e];if(n&&n.flags&2){if(i&&n.id!==i.uid)continue;Lt.splice(e,1),e--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Uo(i){if(li.length){const t=[...new Set(li)].sort((e,n)=>Vi(e)-Vi(n));if(li.length=0,Pe){Pe.push(...t);return}for(Pe=t,ni=0;ni<Pe.length;ni++){const e=Pe[ni];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}Pe=null,ni=0}}const Vi=i=>i.id==null?i.flags&2?-1:1/0:i.id;function Yo(i){try{for(ne=0;ne<Lt.length;ne++){const t=Lt[ne];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Ji(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;ne<Lt.length;ne++){const t=Lt[ne];t&&(t.flags&=-2)}ne=-1,Lt.length=0,Uo(),Cn=null,(Lt.length||li.length)&&Yo()}}let oe=null,jo=null;function wn(i){const t=oe;return oe=i,jo=i&&i.type.__scopeId||null,t}function Xl(i,t=oe,e){if(!t||i._n)return i;const n=(...s)=>{n._d&&Sr(-1);const r=wn(t);let o;try{o=i(...s)}finally{wn(r),n._d&&Sr(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function Be(i,t,e,n){const s=i.dirs,r=t&&t.dirs;for(let o=0;o<s.length;o++){const a=s[o];r&&(a.oldValue=r[o].value);let l=a.dir[n];l&&(pe(),le(l,e,8,[i.el,a,i,t]),me())}}function Vl(i,t){if(It){let e=It.provides;const n=It.parent&&It.parent.provides;n===e&&(e=It.provides=Object.create(n)),e[i]=t}}function mn(i,t,e=!1){const n=Kh();if(n||hi){let s=hi?hi._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&i in s)return s[i];if(arguments.length>1)return e&&nt(t)?t.call(n&&n.proxy):t}}const $l=Symbol.for("v-scx"),ql=()=>mn($l);function _n(i,t,e){return Ko(i,t,e)}function Ko(i,t,e=yt){const{immediate:n,deep:s,flush:r,once:o}=e,a=kt({},e),l=t&&n||!t&&r!=="post";let c;if(qi){if(r==="sync"){const g=ql();c=g.__watcherHandles||(g.__watcherHandles=[])}else if(!l){const g=()=>{};return g.stop=ae,g.resume=ae,g.pause=ae,g}}const h=It;a.call=(g,u,_)=>le(g,h,u,_);let d=!1;r==="post"?a.scheduler=g=>{Ht(g,h&&h.suspense)}:r!=="sync"&&(d=!0,a.scheduler=(g,u)=>{u?g():Xs(g)}),a.augmentJob=g=>{t&&(g.flags|=4),d&&(g.flags|=2,h&&(g.id=h.uid,g.i=h))};const f=Ul(i,t,a);return qi&&(c?c.push(f):l&&f()),f}function Ql(i,t,e){const n=this.proxy,s=Tt(i)?i.includes(".")?Xo(n,i):()=>n[i]:i.bind(n,n);let r;nt(t)?r=t:(r=t.handler,e=t);const o=Zi(this),a=Ko(s,r.bind(n),e);return o(),a}function Xo(i,t){const e=t.split(".");return()=>{let n=i;for(let s=0;s<e.length&&n;s++)n=n[e[s]];return n}}const Jl=Symbol("_vte"),Zl=i=>i.__isTeleport,th=Symbol("_leaveCb");function Vs(i,t){i.shapeFlag&6&&i.component?(i.transition=t,Vs(i.component.subTree,t)):i.shapeFlag&128?(i.ssContent.transition=t.clone(i.ssContent),i.ssFallback.transition=t.clone(i.ssFallback)):i.transition=t}function Vo(i){i.ids=[i.ids[0]+i.ids[2]+++"-",0,0]}const Tn=new WeakMap;function Di(i,t,e,n,s=!1){if(et(i)){i.forEach((u,_)=>Di(u,t&&(et(t)?t[_]:t),e,n,s));return}if(Fi(n)&&!s){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Di(i,t,e,n.component.subTree);return}const r=n.shapeFlag&4?Js(n.component):n.el,o=s?null:r,{i:a,r:l}=i,c=t&&t.r,h=a.refs===yt?a.refs={}:a.refs,d=a.setupState,f=ct(d),g=d===yt?po:u=>dt(f,u);if(c!=null&&c!==l){if(ur(t),Tt(c))h[c]=null,g(c)&&(d[c]=null);else if(Mt(c)){c.value=null;const u=t;u.k&&(h[u.k]=null)}}if(nt(l))Ji(l,a,12,[o,h]);else{const u=Tt(l),_=Mt(l);if(u||_){const C=()=>{if(i.f){const b=u?g(l)?d[l]:h[l]:l.value;if(s)et(b)&&Fs(b,r);else if(et(b))b.includes(r)||b.push(r);else if(u)h[l]=[r],g(l)&&(d[l]=h[l]);else{const v=[r];l.value=v,i.k&&(h[i.k]=v)}}else u?(h[l]=o,g(l)&&(d[l]=o)):_&&(l.value=o,i.k&&(h[i.k]=o))};if(o){const b=()=>{C(),Tn.delete(i)};b.id=-1,Tn.set(i,b),Ht(b,e)}else ur(i),C()}}}function ur(i){const t=Tn.get(i);t&&(t.flags|=8,Tn.delete(i))}In().requestIdleCallback;In().cancelIdleCallback;const Fi=i=>!!i.type.__asyncLoader,$o=i=>i.type.__isKeepAlive;function eh(i,t){qo(i,"a",t)}function ih(i,t){qo(i,"da",t)}function qo(i,t,e=It){const n=i.__wdc||(i.__wdc=()=>{let s=e;for(;s;){if(s.isDeactivated)return;s=s.parent}return i()});if(Fn(t,n,e),e){let s=e.parent;for(;s&&s.parent;)$o(s.parent.vnode)&&nh(n,t,e,s),s=s.parent}}function nh(i,t,e,n){const s=Fn(t,i,n,!0);Zo(()=>{Fs(n[t],s)},e)}function Fn(i,t,e=It,n=!1){if(e){const s=e[i]||(e[i]=[]),r=t.__weh||(t.__weh=(...o)=>{pe();const a=Zi(e),l=le(t,e,i,o);return a(),me(),l});return n?s.unshift(r):s.push(r),r}}const ye=i=>(t,e=It)=>{(!qi||i==="sp")&&Fn(i,(...n)=>t(...n),e)},sh=ye("bm"),Qo=ye("m"),rh=ye("bu"),oh=ye("u"),Jo=ye("bum"),Zo=ye("um"),ah=ye("sp"),lh=ye("rtg"),hh=ye("rtc");function ch(i,t=It){Fn("ec",i,t)}const dh=Symbol.for("v-ndc");function qn(i,t,e,n){let s;const r=e,o=et(i);if(o||Tt(i)){const a=o&&Ke(i);let l=!1,c=!1;a&&(l=!Xt(i),c=_e(i),i=Gn(i)),s=new Array(i.length);for(let h=0,d=i.length;h<d;h++)s[h]=t(l?c?ci(qt(i[h])):qt(i[h]):i[h],h,void 0,r)}else if(typeof i=="number"){s=new Array(i);for(let a=0;a<i;a++)s[a]=t(a+1,a,void 0,r)}else if(vt(i))if(i[Symbol.iterator])s=Array.from(i,(a,l)=>t(a,l,void 0,r));else{const a=Object.keys(i);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];s[l]=t(i[h],h,l,r)}}else s=[];return s}const _s=i=>i?xa(i)?Js(i):_s(i.parent):null,Ni=kt(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>_s(i.parent),$root:i=>_s(i.root),$host:i=>i.ce,$emit:i=>i.emit,$options:i=>ea(i),$forceUpdate:i=>i.f||(i.f=()=>{Xs(i.update)}),$nextTick:i=>i.n||(i.n=Wo.bind(i.proxy)),$watch:i=>Ql.bind(i)}),Qn=(i,t)=>i!==yt&&!i.__isScriptSetup&&dt(i,t),fh={get({_:i},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:n,data:s,props:r,accessCache:o,type:a,appContext:l}=i;if(t[0]!=="$"){const f=o[t];if(f!==void 0)switch(f){case 1:return n[t];case 2:return s[t];case 4:return e[t];case 3:return r[t]}else{if(Qn(n,t))return o[t]=1,n[t];if(s!==yt&&dt(s,t))return o[t]=2,s[t];if(dt(r,t))return o[t]=3,r[t];if(e!==yt&&dt(e,t))return o[t]=4,e[t];ys&&(o[t]=0)}}const c=Ni[t];let h,d;if(c)return t==="$attrs"&&Rt(i.attrs,"get",""),c(i);if((h=a.__cssModules)&&(h=h[t]))return h;if(e!==yt&&dt(e,t))return o[t]=4,e[t];if(d=l.config.globalProperties,dt(d,t))return d[t]},set({_:i},t,e){const{data:n,setupState:s,ctx:r}=i;return Qn(s,t)?(s[t]=e,!0):n!==yt&&dt(n,t)?(n[t]=e,!0):dt(i.props,t)||t[0]==="$"&&t.slice(1)in i?!1:(r[t]=e,!0)},has({_:{data:i,setupState:t,accessCache:e,ctx:n,appContext:s,props:r,type:o}},a){let l;return!!(e[a]||i!==yt&&a[0]!=="$"&&dt(i,a)||Qn(t,a)||dt(r,a)||dt(n,a)||dt(Ni,a)||dt(s.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(i,t,e){return e.get!=null?i._.accessCache[t]=0:dt(e,"value")&&this.set(i,t,e.value,null),Reflect.defineProperty(i,t,e)}};function gr(i){return et(i)?i.reduce((t,e)=>(t[e]=null,t),{}):i}let ys=!0;function uh(i){const t=ea(i),e=i.proxy,n=i.ctx;ys=!1,t.beforeCreate&&pr(t.beforeCreate,i,"bc");const{data:s,computed:r,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:d,mounted:f,beforeUpdate:g,updated:u,activated:_,deactivated:C,beforeDestroy:b,beforeUnmount:v,destroyed:w,unmounted:S,render:I,renderTracked:k,renderTriggered:K,errorCaptured:F,serverPrefetch:X,expose:D,inheritAttrs:O,components:N,directives:tt,filters:it}=t;if(c&&gh(c,n,null),o)for(const Q in o){const z=o[Q];nt(z)&&(n[Q]=z.bind(e))}if(s){const Q=s.call(e,e);vt(Q)&&(i.data=Xi(Q))}if(ys=!0,r)for(const Q in r){const z=r[Q],ot=nt(z)?z.bind(e,e):nt(z.get)?z.get.bind(e,e):ae,xt=!nt(z)&&nt(z.set)?z.set.bind(e):ae,st=Ss({get:ot,set:xt});Object.defineProperty(n,Q,{enumerable:!0,configurable:!0,get:()=>st.value,set:lt=>st.value=lt})}if(a)for(const Q in a)ta(a[Q],n,e,Q);if(l){const Q=nt(l)?l.call(e):l;Reflect.ownKeys(Q).forEach(z=>{Vl(z,Q[z])})}h&&pr(h,i,"c");function W(Q,z){et(z)?z.forEach(ot=>Q(ot.bind(e))):z&&Q(z.bind(e))}if(W(sh,d),W(Qo,f),W(rh,g),W(oh,u),W(eh,_),W(ih,C),W(ch,F),W(hh,k),W(lh,K),W(Jo,v),W(Zo,S),W(ah,X),et(D))if(D.length){const Q=i.exposed||(i.exposed={});D.forEach(z=>{Object.defineProperty(Q,z,{get:()=>e[z],set:ot=>e[z]=ot,enumerable:!0})})}else i.exposed||(i.exposed={});I&&i.render===ae&&(i.render=I),O!=null&&(i.inheritAttrs=O),N&&(i.components=N),tt&&(i.directives=tt),X&&Vo(i)}function gh(i,t,e=ae){et(i)&&(i=bs(i));for(const n in i){const s=i[n];let r;vt(s)?"default"in s?r=mn(s.from||n,s.default,!0):r=mn(s.from||n):r=mn(s),Mt(r)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):t[n]=r}}function pr(i,t,e){le(et(i)?i.map(n=>n.bind(t.proxy)):i.bind(t.proxy),t,e)}function ta(i,t,e,n){let s=n.includes(".")?Xo(e,n):()=>e[n];if(Tt(i)){const r=t[i];nt(r)&&_n(s,r)}else if(nt(i))_n(s,i.bind(e));else if(vt(i))if(et(i))i.forEach(r=>ta(r,t,e,n));else{const r=nt(i.handler)?i.handler.bind(e):t[i.handler];nt(r)&&_n(s,r,i)}}function ea(i){const t=i.type,{mixins:e,extends:n}=t,{mixins:s,optionsCache:r,config:{optionMergeStrategies:o}}=i.appContext,a=r.get(t);let l;return a?l=a:!s.length&&!e&&!n?l=t:(l={},s.length&&s.forEach(c=>Pn(l,c,o,!0)),Pn(l,t,o)),vt(t)&&r.set(t,l),l}function Pn(i,t,e,n=!1){const{mixins:s,extends:r}=t;r&&Pn(i,r,e,!0),s&&s.forEach(o=>Pn(i,o,e,!0));for(const o in t)if(!(n&&o==="expose")){const a=ph[o]||e&&e[o];i[o]=a?a(i[o],t[o]):t[o]}return i}const ph={data:mr,props:_r,emits:_r,methods:Ai,computed:Ai,beforeCreate:Ot,created:Ot,beforeMount:Ot,mounted:Ot,beforeUpdate:Ot,updated:Ot,beforeDestroy:Ot,beforeUnmount:Ot,destroyed:Ot,unmounted:Ot,activated:Ot,deactivated:Ot,errorCaptured:Ot,serverPrefetch:Ot,components:Ai,directives:Ai,watch:_h,provide:mr,inject:mh};function mr(i,t){return t?i?function(){return kt(nt(i)?i.call(this,this):i,nt(t)?t.call(this,this):t)}:t:i}function mh(i,t){return Ai(bs(i),bs(t))}function bs(i){if(et(i)){const t={};for(let e=0;e<i.length;e++)t[i[e]]=i[e];return t}return i}function Ot(i,t){return i?[...new Set([].concat(i,t))]:t}function Ai(i,t){return i?kt(Object.create(null),i,t):t}function _r(i,t){return i?et(i)&&et(t)?[...new Set([...i,...t])]:kt(Object.create(null),gr(i),gr(t??{})):t}function _h(i,t){if(!i)return t;if(!t)return i;const e=kt(Object.create(null),i);for(const n in t)e[n]=Ot(i[n],t[n]);return e}function ia(){return{app:null,config:{isNativeTag:po,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let yh=0;function bh(i,t){return function(n,s=null){nt(n)||(n=kt({},n)),s!=null&&!vt(s)&&(s=null);const r=ia(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:yh++,_component:n,_props:s,_container:null,_context:r,_instance:null,version:Jh,get config(){return r.config},set config(h){},use(h,...d){return o.has(h)||(h&&nt(h.install)?(o.add(h),h.install(c,...d)):nt(h)&&(o.add(h),h(c,...d))),c},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),c},component(h,d){return d?(r.components[h]=d,c):r.components[h]},directive(h,d){return d?(r.directives[h]=d,c):r.directives[h]},mount(h,d,f){if(!l){const g=c._ceVNode||ge(n,s);return g.appContext=r,f===!0?f="svg":f===!1&&(f=void 0),i(g,h,f),l=!0,c._container=h,h.__vue_app__=c,Js(g.component)}},onUnmount(h){a.push(h)},unmount(){l&&(le(a,c._instance,16),i(null,c._container),delete c._container.__vue_app__)},provide(h,d){return r.provides[h]=d,c},runWithContext(h){const d=hi;hi=c;try{return h()}finally{hi=d}}};return c}}let hi=null;const xh=(i,t)=>t==="modelValue"||t==="model-value"?i.modelModifiers:i[`${t}Modifiers`]||i[`${ke(t)}Modifiers`]||i[`${Xe(t)}Modifiers`];function vh(i,t,...e){if(i.isUnmounted)return;const n=i.vnode.props||yt;let s=e;const r=t.startsWith("update:"),o=r&&xh(n,t.slice(7));o&&(o.trim&&(s=e.map(h=>Tt(h)?h.trim():h)),o.number&&(s=e.map(ll)));let a,l=n[a=Yn(t)]||n[a=Yn(ke(t))];!l&&r&&(l=n[a=Yn(Xe(t))]),l&&le(l,i,6,s);const c=n[a+"Once"];if(c){if(!i.emitted)i.emitted={};else if(i.emitted[a])return;i.emitted[a]=!0,le(c,i,6,s)}}const Sh=new WeakMap;function na(i,t,e=!1){const n=e?Sh:t.emitsCache,s=n.get(i);if(s!==void 0)return s;const r=i.emits;let o={},a=!1;if(!nt(i)){const l=c=>{const h=na(c,t,!0);h&&(a=!0,kt(o,h))};!e&&t.mixins.length&&t.mixins.forEach(l),i.extends&&l(i.extends),i.mixins&&i.mixins.forEach(l)}return!r&&!a?(vt(i)&&n.set(i,null),null):(et(r)?r.forEach(l=>o[l]=null):kt(o,r),vt(i)&&n.set(i,o),o)}function Nn(i,t){return!i||!kn(t)?!1:(t=t.slice(2).replace(/Once$/,""),dt(i,t[0].toLowerCase()+t.slice(1))||dt(i,Xe(t))||dt(i,t))}function yr(i){const{type:t,vnode:e,proxy:n,withProxy:s,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:d,data:f,setupState:g,ctx:u,inheritAttrs:_}=i,C=wn(i);let b,v;try{if(e.shapeFlag&4){const S=s||n,I=S;b=se(c.call(I,S,h,d,g,f,u)),v=a}else{const S=t;b=se(S.length>1?S(d,{attrs:a,slots:o,emit:l}):S(d,null)),v=t.props?a:Ch(a)}}catch(S){Bi.length=0,Dn(S,i,1),b=ge(Oe)}let w=b;if(v&&_!==!1){const S=Object.keys(v),{shapeFlag:I}=w;S.length&&I&7&&(r&&S.some(Ds)&&(v=wh(v,r)),w=di(w,v,!1,!0))}return e.dirs&&(w=di(w,null,!1,!0),w.dirs=w.dirs?w.dirs.concat(e.dirs):e.dirs),e.transition&&Vs(w,e.transition),b=w,wn(C),b}const Ch=i=>{let t;for(const e in i)(e==="class"||e==="style"||kn(e))&&((t||(t={}))[e]=i[e]);return t},wh=(i,t)=>{const e={};for(const n in i)(!Ds(n)||!(n.slice(9)in t))&&(e[n]=i[n]);return e};function Th(i,t,e){const{props:n,children:s,component:r}=i,{props:o,children:a,patchFlag:l}=t,c=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return n?br(n,o,c):!!o;if(l&8){const h=t.dynamicProps;for(let d=0;d<h.length;d++){const f=h[d];if(o[f]!==n[f]&&!Nn(c,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:n===o?!1:n?o?br(n,o,c):!0:!!o;return!1}function br(i,t,e){const n=Object.keys(t);if(n.length!==Object.keys(i).length)return!0;for(let s=0;s<n.length;s++){const r=n[s];if(t[r]!==i[r]&&!Nn(e,r))return!0}return!1}function Ph({vnode:i,parent:t},e){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===i&&(n.el=i.el),n===i)(i=t.vnode).el=e,t=t.parent;else break}}const sa={},ra=()=>Object.create(sa),oa=i=>Object.getPrototypeOf(i)===sa;function Ah(i,t,e,n=!1){const s={},r=ra();i.propsDefaults=Object.create(null),aa(i,t,s,r);for(const o in i.propsOptions[0])o in s||(s[o]=void 0);e?i.props=n?s:Gl(s):i.type.props?i.props=s:i.props=r,i.attrs=r}function Eh(i,t,e,n){const{props:s,attrs:r,vnode:{patchFlag:o}}=i,a=ct(s),[l]=i.propsOptions;let c=!1;if((n||o>0)&&!(o&16)){if(o&8){const h=i.vnode.dynamicProps;for(let d=0;d<h.length;d++){let f=h[d];if(Nn(i.emitsOptions,f))continue;const g=t[f];if(l)if(dt(r,f))g!==r[f]&&(r[f]=g,c=!0);else{const u=ke(f);s[u]=xs(l,a,u,g,i,!1)}else g!==r[f]&&(r[f]=g,c=!0)}}}else{aa(i,t,s,r)&&(c=!0);let h;for(const d in a)(!t||!dt(t,d)&&((h=Xe(d))===d||!dt(t,h)))&&(l?e&&(e[d]!==void 0||e[h]!==void 0)&&(s[d]=xs(l,a,d,void 0,i,!0)):delete s[d]);if(r!==a)for(const d in r)(!t||!dt(t,d))&&(delete r[d],c=!0)}c&&ue(i.attrs,"set","")}function aa(i,t,e,n){const[s,r]=i.propsOptions;let o=!1,a;if(t)for(let l in t){if(Li(l))continue;const c=t[l];let h;s&&dt(s,h=ke(l))?!r||!r.includes(h)?e[h]=c:(a||(a={}))[h]=c:Nn(i.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,o=!0)}if(r){const l=ct(e),c=a||yt;for(let h=0;h<r.length;h++){const d=r[h];e[d]=xs(s,l,d,c[d],i,!dt(c,d))}}return o}function xs(i,t,e,n,s,r){const o=i[e];if(o!=null){const a=dt(o,"default");if(a&&n===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&nt(l)){const{propsDefaults:c}=s;if(e in c)n=c[e];else{const h=Zi(s);n=c[e]=l.call(null,t),h()}}else n=l;s.ce&&s.ce._setProp(e,n)}o[0]&&(r&&!a?n=!1:o[1]&&(n===""||n===Xe(e))&&(n=!0))}return n}const Rh=new WeakMap;function la(i,t,e=!1){const n=e?Rh:t.propsCache,s=n.get(i);if(s)return s;const r=i.props,o={},a=[];let l=!1;if(!nt(i)){const h=d=>{l=!0;const[f,g]=la(d,t,!0);kt(o,f),g&&a.push(...g)};!e&&t.mixins.length&&t.mixins.forEach(h),i.extends&&h(i.extends),i.mixins&&i.mixins.forEach(h)}if(!r&&!l)return vt(i)&&n.set(i,oi),oi;if(et(r))for(let h=0;h<r.length;h++){const d=ke(r[h]);xr(d)&&(o[d]=yt)}else if(r)for(const h in r){const d=ke(h);if(xr(d)){const f=r[h],g=o[d]=et(f)||nt(f)?{type:f}:kt({},f),u=g.type;let _=!1,C=!0;if(et(u))for(let b=0;b<u.length;++b){const v=u[b],w=nt(v)&&v.name;if(w==="Boolean"){_=!0;break}else w==="String"&&(C=!1)}else _=nt(u)&&u.name==="Boolean";g[0]=_,g[1]=C,(_||dt(g,"default"))&&a.push(d)}}const c=[o,a];return vt(i)&&n.set(i,c),c}function xr(i){return i[0]!=="$"&&!Li(i)}const $s=i=>i==="_"||i==="_ctx"||i==="$stable",qs=i=>et(i)?i.map(se):[se(i)],Mh=(i,t,e)=>{if(t._n)return t;const n=Xl((...s)=>qs(t(...s)),e);return n._c=!1,n},ha=(i,t,e)=>{const n=i._ctx;for(const s in i){if($s(s))continue;const r=i[s];if(nt(r))t[s]=Mh(s,r,n);else if(r!=null){const o=qs(r);t[s]=()=>o}}},ca=(i,t)=>{const e=qs(t);i.slots.default=()=>e},da=(i,t,e)=>{for(const n in t)(e||!$s(n))&&(i[n]=t[n])},kh=(i,t,e)=>{const n=i.slots=ra();if(i.vnode.shapeFlag&32){const s=t._;s?(da(n,t,e),e&&vo(n,"_",s,!0)):ha(t,n)}else t&&ca(i,t)},Oh=(i,t,e)=>{const{vnode:n,slots:s}=i;let r=!0,o=yt;if(n.shapeFlag&32){const a=t._;a?e&&a===1?r=!1:da(s,t,e):(r=!t.$stable,ha(t,s)),o=t}else t&&(ca(i,t),o={default:1});if(r)for(const a in s)!$s(a)&&o[a]==null&&delete s[a]},Ht=Fh;function Lh(i){return Ih(i)}function Ih(i,t){const e=In();e.__VUE__=!0;const{insert:n,remove:s,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:d,nextSibling:f,setScopeId:g=ae,insertStaticContent:u}=i,_=(m,y,T,M=null,P=null,A=null,Y=void 0,U=null,H=!!y.dynamicChildren)=>{if(m===y)return;m&&!xi(m,y)&&(M=en(m),lt(m,P,A,!0),m=null),y.patchFlag===-2&&(H=!1,y.dynamicChildren=null);const{type:R,ref:J,shapeFlag:j}=y;switch(R){case Bn:C(m,y,T,M);break;case Oe:b(m,y,T,M);break;case Zn:m==null&&v(y,T,M,Y);break;case Wt:N(m,y,T,M,P,A,Y,U,H);break;default:j&1?I(m,y,T,M,P,A,Y,U,H):j&6?tt(m,y,T,M,P,A,Y,U,H):(j&64||j&128)&&R.process(m,y,T,M,P,A,Y,U,H,mi)}J!=null&&P?Di(J,m&&m.ref,A,y||m,!y):J==null&&m&&m.ref!=null&&Di(m.ref,null,A,m,!0)},C=(m,y,T,M)=>{if(m==null)n(y.el=a(y.children),T,M);else{const P=y.el=m.el;y.children!==m.children&&c(P,y.children)}},b=(m,y,T,M)=>{m==null?n(y.el=l(y.children||""),T,M):y.el=m.el},v=(m,y,T,M)=>{[m.el,m.anchor]=u(m.children,y,T,M,m.el,m.anchor)},w=({el:m,anchor:y},T,M)=>{let P;for(;m&&m!==y;)P=f(m),n(m,T,M),m=P;n(y,T,M)},S=({el:m,anchor:y})=>{let T;for(;m&&m!==y;)T=f(m),s(m),m=T;s(y)},I=(m,y,T,M,P,A,Y,U,H)=>{if(y.type==="svg"?Y="svg":y.type==="math"&&(Y="mathml"),m==null)k(y,T,M,P,A,Y,U,H);else{const R=m.el&&m.el._isVueCE?m.el:null;try{R&&R._beginPatch(),X(m,y,P,A,Y,U,H)}finally{R&&R._endPatch()}}},k=(m,y,T,M,P,A,Y,U)=>{let H,R;const{props:J,shapeFlag:j,transition:V,dirs:Z}=m;if(H=m.el=o(m.type,A,J&&J.is,J),j&8?h(H,m.children):j&16&&F(m.children,H,null,M,P,Jn(m,A),Y,U),Z&&Be(m,null,M,"created"),K(H,m,m.scopeId,Y,M),J){for(const gt in J)gt!=="value"&&!Li(gt)&&r(H,gt,null,J[gt],A,M);"value"in J&&r(H,"value",null,J.value,A),(R=J.onVnodeBeforeMount)&&ee(R,M,m)}Z&&Be(m,null,M,"beforeMount");const at=Gh(P,V);at&&V.beforeEnter(H),n(H,y,T),((R=J&&J.onVnodeMounted)||at||Z)&&Ht(()=>{R&&ee(R,M,m),at&&V.enter(H),Z&&Be(m,null,M,"mounted")},P)},K=(m,y,T,M,P)=>{if(T&&g(m,T),M)for(let A=0;A<M.length;A++)g(m,M[A]);if(P){let A=P.subTree;if(y===A||pa(A.type)&&(A.ssContent===y||A.ssFallback===y)){const Y=P.vnode;K(m,Y,Y.scopeId,Y.slotScopeIds,P.parent)}}},F=(m,y,T,M,P,A,Y,U,H=0)=>{for(let R=H;R<m.length;R++){const J=m[R]=U?Ae(m[R]):se(m[R]);_(null,J,y,T,M,P,A,Y,U)}},X=(m,y,T,M,P,A,Y)=>{const U=y.el=m.el;let{patchFlag:H,dynamicChildren:R,dirs:J}=y;H|=m.patchFlag&16;const j=m.props||yt,V=y.props||yt;let Z;if(T&&He(T,!1),(Z=V.onVnodeBeforeUpdate)&&ee(Z,T,y,m),J&&Be(y,m,T,"beforeUpdate"),T&&He(T,!0),(j.innerHTML&&V.innerHTML==null||j.textContent&&V.textContent==null)&&h(U,""),R?D(m.dynamicChildren,R,U,T,M,Jn(y,P),A):Y||z(m,y,U,null,T,M,Jn(y,P),A,!1),H>0){if(H&16)O(U,j,V,T,P);else if(H&2&&j.class!==V.class&&r(U,"class",null,V.class,P),H&4&&r(U,"style",j.style,V.style,P),H&8){const at=y.dynamicProps;for(let gt=0;gt<at.length;gt++){const ft=at[gt],Gt=j[ft],Dt=V[ft];(Dt!==Gt||ft==="value")&&r(U,ft,Gt,Dt,P,T)}}H&1&&m.children!==y.children&&h(U,y.children)}else!Y&&R==null&&O(U,j,V,T,P);((Z=V.onVnodeUpdated)||J)&&Ht(()=>{Z&&ee(Z,T,y,m),J&&Be(y,m,T,"updated")},M)},D=(m,y,T,M,P,A,Y)=>{for(let U=0;U<y.length;U++){const H=m[U],R=y[U],J=H.el&&(H.type===Wt||!xi(H,R)||H.shapeFlag&198)?d(H.el):T;_(H,R,J,null,M,P,A,Y,!0)}},O=(m,y,T,M,P)=>{if(y!==T){if(y!==yt)for(const A in y)!Li(A)&&!(A in T)&&r(m,A,y[A],null,P,M);for(const A in T){if(Li(A))continue;const Y=T[A],U=y[A];Y!==U&&A!=="value"&&r(m,A,U,Y,P,M)}"value"in T&&r(m,"value",y.value,T.value,P)}},N=(m,y,T,M,P,A,Y,U,H)=>{const R=y.el=m?m.el:a(""),J=y.anchor=m?m.anchor:a("");let{patchFlag:j,dynamicChildren:V,slotScopeIds:Z}=y;Z&&(U=U?U.concat(Z):Z),m==null?(n(R,T,M),n(J,T,M),F(y.children||[],T,J,P,A,Y,U,H)):j>0&&j&64&&V&&m.dynamicChildren&&m.dynamicChildren.length===V.length?(D(m.dynamicChildren,V,T,P,A,Y,U),(y.key!=null||P&&y===P.subTree)&&fa(m,y,!0)):z(m,y,T,J,P,A,Y,U,H)},tt=(m,y,T,M,P,A,Y,U,H)=>{y.slotScopeIds=U,m==null?y.shapeFlag&512?P.ctx.activate(y,T,M,Y,H):it(y,T,M,P,A,Y,H):q(m,y,H)},it=(m,y,T,M,P,A,Y)=>{const U=m.component=jh(m,M,P);if($o(m)&&(U.ctx.renderer=mi),Xh(U,!1,Y),U.asyncDep){if(P&&P.registerDep(U,W,Y),!m.el){const H=U.subTree=ge(Oe);b(null,H,y,T),m.placeholder=H.el}}else W(U,m,y,T,P,A,Y)},q=(m,y,T)=>{const M=y.component=m.component;if(Th(m,y,T))if(M.asyncDep&&!M.asyncResolved){Q(M,y,T);return}else M.next=y,M.update();else y.el=m.el,M.vnode=y},W=(m,y,T,M,P,A,Y)=>{const U=()=>{if(m.isMounted){let{next:j,bu:V,u:Z,parent:at,vnode:gt}=m;{const Zt=ua(m);if(Zt){j&&(j.el=gt.el,Q(m,j,Y)),Zt.asyncDep.then(()=>{m.isUnmounted||U()});return}}let ft=j,Gt;He(m,!1),j?(j.el=gt.el,Q(m,j,Y)):j=gt,V&&jn(V),(Gt=j.props&&j.props.onVnodeBeforeUpdate)&&ee(Gt,at,j,gt),He(m,!0);const Dt=yr(m),Jt=m.subTree;m.subTree=Dt,_(Jt,Dt,d(Jt.el),en(Jt),m,P,A),j.el=Dt.el,ft===null&&Ph(m,Dt.el),Z&&Ht(Z,P),(Gt=j.props&&j.props.onVnodeUpdated)&&Ht(()=>ee(Gt,at,j,gt),P)}else{let j;const{el:V,props:Z}=y,{bm:at,m:gt,parent:ft,root:Gt,type:Dt}=m,Jt=Fi(y);He(m,!1),at&&jn(at),!Jt&&(j=Z&&Z.onVnodeBeforeMount)&&ee(j,ft,y),He(m,!0);{Gt.ce&&Gt.ce._def.shadowRoot!==!1&&Gt.ce._injectChildStyle(Dt);const Zt=m.subTree=yr(m);_(null,Zt,T,M,m,P,A),y.el=Zt.el}if(gt&&Ht(gt,P),!Jt&&(j=Z&&Z.onVnodeMounted)){const Zt=y;Ht(()=>ee(j,ft,Zt),P)}(y.shapeFlag&256||ft&&Fi(ft.vnode)&&ft.vnode.shapeFlag&256)&&m.a&&Ht(m.a,P),m.isMounted=!0,y=T=M=null}};m.scope.on();const H=m.effect=new To(U);m.scope.off();const R=m.update=H.run.bind(H),J=m.job=H.runIfDirty.bind(H);J.i=m,J.id=m.uid,H.scheduler=()=>Xs(J),He(m,!0),R()},Q=(m,y,T)=>{y.component=m;const M=m.vnode.props;m.vnode=y,m.next=null,Eh(m,y.props,M,T),Oh(m,y.children,T),pe(),fr(m),me()},z=(m,y,T,M,P,A,Y,U,H=!1)=>{const R=m&&m.children,J=m?m.shapeFlag:0,j=y.children,{patchFlag:V,shapeFlag:Z}=y;if(V>0){if(V&128){xt(R,j,T,M,P,A,Y,U,H);return}else if(V&256){ot(R,j,T,M,P,A,Y,U,H);return}}Z&8?(J&16&&pi(R,P,A),j!==R&&h(T,j)):J&16?Z&16?xt(R,j,T,M,P,A,Y,U,H):pi(R,P,A,!0):(J&8&&h(T,""),Z&16&&F(j,T,M,P,A,Y,U,H))},ot=(m,y,T,M,P,A,Y,U,H)=>{m=m||oi,y=y||oi;const R=m.length,J=y.length,j=Math.min(R,J);let V;for(V=0;V<j;V++){const Z=y[V]=H?Ae(y[V]):se(y[V]);_(m[V],Z,T,null,P,A,Y,U,H)}R>J?pi(m,P,A,!0,!1,j):F(y,T,M,P,A,Y,U,H,j)},xt=(m,y,T,M,P,A,Y,U,H)=>{let R=0;const J=y.length;let j=m.length-1,V=J-1;for(;R<=j&&R<=V;){const Z=m[R],at=y[R]=H?Ae(y[R]):se(y[R]);if(xi(Z,at))_(Z,at,T,null,P,A,Y,U,H);else break;R++}for(;R<=j&&R<=V;){const Z=m[j],at=y[V]=H?Ae(y[V]):se(y[V]);if(xi(Z,at))_(Z,at,T,null,P,A,Y,U,H);else break;j--,V--}if(R>j){if(R<=V){const Z=V+1,at=Z<J?y[Z].el:M;for(;R<=V;)_(null,y[R]=H?Ae(y[R]):se(y[R]),T,at,P,A,Y,U,H),R++}}else if(R>V)for(;R<=j;)lt(m[R],P,A,!0),R++;else{const Z=R,at=R,gt=new Map;for(R=at;R<=V;R++){const Bt=y[R]=H?Ae(y[R]):se(y[R]);Bt.key!=null&&gt.set(Bt.key,R)}let ft,Gt=0;const Dt=V-at+1;let Jt=!1,Zt=0;const _i=new Array(Dt);for(R=0;R<Dt;R++)_i[R]=0;for(R=Z;R<=j;R++){const Bt=m[R];if(Gt>=Dt){lt(Bt,P,A,!0);continue}let te;if(Bt.key!=null)te=gt.get(Bt.key);else for(ft=at;ft<=V;ft++)if(_i[ft-at]===0&&xi(Bt,y[ft])){te=ft;break}te===void 0?lt(Bt,P,A,!0):(_i[te-at]=R+1,te>=Zt?Zt=te:Jt=!0,_(Bt,y[te],T,null,P,A,Y,U,H),Gt++)}const or=Jt?Dh(_i):oi;for(ft=or.length-1,R=Dt-1;R>=0;R--){const Bt=at+R,te=y[Bt],ar=y[Bt+1],lr=Bt+1<J?ar.el||ga(ar):M;_i[R]===0?_(null,te,T,lr,P,A,Y,U,H):Jt&&(ft<0||R!==or[ft]?st(te,T,lr,2):ft--)}}},st=(m,y,T,M,P=null)=>{const{el:A,type:Y,transition:U,children:H,shapeFlag:R}=m;if(R&6){st(m.component.subTree,y,T,M);return}if(R&128){m.suspense.move(y,T,M);return}if(R&64){Y.move(m,y,T,mi);return}if(Y===Wt){n(A,y,T);for(let j=0;j<H.length;j++)st(H[j],y,T,M);n(m.anchor,y,T);return}if(Y===Zn){w(m,y,T);return}if(M!==2&&R&1&&U)if(M===0)U.beforeEnter(A),n(A,y,T),Ht(()=>U.enter(A),P);else{const{leave:j,delayLeave:V,afterLeave:Z}=U,at=()=>{m.ctx.isUnmounted?s(A):n(A,y,T)},gt=()=>{A._isLeaving&&A[th](!0),j(A,()=>{at(),Z&&Z()})};V?V(A,at,gt):gt()}else n(A,y,T)},lt=(m,y,T,M=!1,P=!1)=>{const{type:A,props:Y,ref:U,children:H,dynamicChildren:R,shapeFlag:J,patchFlag:j,dirs:V,cacheIndex:Z}=m;if(j===-2&&(P=!1),U!=null&&(pe(),Di(U,null,T,m,!0),me()),Z!=null&&(y.renderCache[Z]=void 0),J&256){y.ctx.deactivate(m);return}const at=J&1&&V,gt=!Fi(m);let ft;if(gt&&(ft=Y&&Y.onVnodeBeforeUnmount)&&ee(ft,y,m),J&6)nl(m.component,T,M);else{if(J&128){m.suspense.unmount(T,M);return}at&&Be(m,null,y,"beforeUnmount"),J&64?m.type.remove(m,y,T,mi,M):R&&!R.hasOnce&&(A!==Wt||j>0&&j&64)?pi(R,y,T,!1,!0):(A===Wt&&j&384||!P&&J&16)&&pi(H,y,T),M&&At(m)}(gt&&(ft=Y&&Y.onVnodeUnmounted)||at)&&Ht(()=>{ft&&ee(ft,y,m),at&&Be(m,null,y,"unmounted")},T)},At=m=>{const{type:y,el:T,anchor:M,transition:P}=m;if(y===Wt){il(T,M);return}if(y===Zn){S(m);return}const A=()=>{s(T),P&&!P.persisted&&P.afterLeave&&P.afterLeave()};if(m.shapeFlag&1&&P&&!P.persisted){const{leave:Y,delayLeave:U}=P,H=()=>Y(T,A);U?U(m.el,A,H):H()}else A()},il=(m,y)=>{let T;for(;m!==y;)T=f(m),s(m),m=T;s(y)},nl=(m,y,T)=>{const{bum:M,scope:P,job:A,subTree:Y,um:U,m:H,a:R}=m;vr(H),vr(R),M&&jn(M),P.stop(),A&&(A.flags|=8,lt(Y,m,y,T)),U&&Ht(U,y),Ht(()=>{m.isUnmounted=!0},y)},pi=(m,y,T,M=!1,P=!1,A=0)=>{for(let Y=A;Y<m.length;Y++)lt(m[Y],y,T,M,P)},en=m=>{if(m.shapeFlag&6)return en(m.component.subTree);if(m.shapeFlag&128)return m.suspense.next();const y=f(m.anchor||m.el),T=y&&y[Jl];return T?f(T):y};let Un=!1;const rr=(m,y,T)=>{let M;m==null?y._vnode&&(lt(y._vnode,null,null,!0),M=y._vnode.component):_(y._vnode||null,m,y,null,null,null,T),y._vnode=m,Un||(Un=!0,fr(M),Uo(),Un=!1)},mi={p:_,um:lt,m:st,r:At,mt:it,mc:F,pc:z,pbc:D,n:en,o:i};return{render:rr,hydrate:void 0,createApp:bh(rr)}}function Jn({type:i,props:t},e){return e==="svg"&&i==="foreignObject"||e==="mathml"&&i==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function He({effect:i,job:t},e){e?(i.flags|=32,t.flags|=4):(i.flags&=-33,t.flags&=-5)}function Gh(i,t){return(!i||i&&!i.pendingBranch)&&t&&!t.persisted}function fa(i,t,e=!1){const n=i.children,s=t.children;if(et(n)&&et(s))for(let r=0;r<n.length;r++){const o=n[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=Ae(s[r]),a.el=o.el),!e&&a.patchFlag!==-2&&fa(o,a)),a.type===Bn&&(a.patchFlag!==-1?a.el=o.el:a.__elIndex=r+(i.type===Wt?1:0)),a.type===Oe&&!a.el&&(a.el=o.el)}}function Dh(i){const t=i.slice(),e=[0];let n,s,r,o,a;const l=i.length;for(n=0;n<l;n++){const c=i[n];if(c!==0){if(s=e[e.length-1],i[s]<c){t[n]=s,e.push(n);continue}for(r=0,o=e.length-1;r<o;)a=r+o>>1,i[e[a]]<c?r=a+1:o=a;c<i[e[r]]&&(r>0&&(t[n]=e[r-1]),e[r]=n)}}for(r=e.length,o=e[r-1];r-- >0;)e[r]=o,o=t[o];return e}function ua(i){const t=i.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:ua(t)}function vr(i){if(i)for(let t=0;t<i.length;t++)i[t].flags|=8}function ga(i){if(i.placeholder)return i.placeholder;const t=i.component;return t?ga(t.subTree):null}const pa=i=>i.__isSuspense;function Fh(i,t){t&&t.pendingBranch?et(i)?t.effects.push(...i):t.effects.push(i):Kl(i)}const Wt=Symbol.for("v-fgt"),Bn=Symbol.for("v-txt"),Oe=Symbol.for("v-cmt"),Zn=Symbol.for("v-stc"),Bi=[];let Ut=null;function Ct(i=!1){Bi.push(Ut=i?null:[])}function Nh(){Bi.pop(),Ut=Bi[Bi.length-1]||null}let $i=1;function Sr(i,t=!1){$i+=i,i<0&&Ut&&t&&(Ut.hasOnce=!0)}function ma(i){return i.dynamicChildren=$i>0?Ut||oi:null,Nh(),$i>0&&Ut&&Ut.push(i),i}function wt(i,t,e,n,s,r){return ma($(i,t,e,n,s,r,!0))}function Bh(i,t,e,n,s){return ma(ge(i,t,e,n,s,!0))}function _a(i){return i?i.__v_isVNode===!0:!1}function xi(i,t){return i.type===t.type&&i.key===t.key}const ya=({key:i})=>i??null,yn=({ref:i,ref_key:t,ref_for:e})=>(typeof i=="number"&&(i=""+i),i!=null?Tt(i)||Mt(i)||nt(i)?{i:oe,r:i,k:t,f:!!e}:i:null);function $(i,t=null,e=null,n=0,s=null,r=i===Wt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:i,props:t,key:t&&ya(t),ref:t&&yn(t),scopeId:jo,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:oe};return a?(Qs(l,e),r&128&&i.normalize(l)):e&&(l.shapeFlag|=Tt(e)?8:16),$i>0&&!o&&Ut&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&Ut.push(l),l}const ge=Hh;function Hh(i,t=null,e=null,n=0,s=null,r=!1){if((!i||i===dh)&&(i=Oe),_a(i)){const a=di(i,t,!0);return e&&Qs(a,e),$i>0&&!r&&Ut&&(a.shapeFlag&6?Ut[Ut.indexOf(i)]=a:Ut.push(a)),a.patchFlag=-2,a}if(Qh(i)&&(i=i.__vccOpts),t){t=Wh(t);let{class:a,style:l}=t;a&&!Tt(a)&&(t.class=Yi(a)),vt(l)&&(Ks(l)&&!et(l)&&(l=kt({},l)),t.style=Bs(l))}const o=Tt(i)?1:pa(i)?128:Zl(i)?64:vt(i)?4:nt(i)?2:0;return $(i,t,e,n,s,o,r,!0)}function Wh(i){return i?Ks(i)||oa(i)?kt({},i):i:null}function di(i,t,e=!1,n=!1){const{props:s,ref:r,patchFlag:o,children:a,transition:l}=i,c=t?zh(s||{},t):s,h={__v_isVNode:!0,__v_skip:!0,type:i.type,props:c,key:c&&ya(c),ref:t&&t.ref?e&&r?et(r)?r.concat(yn(t)):[r,yn(t)]:yn(t):r,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:a,target:i.target,targetStart:i.targetStart,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:t&&i.type!==Wt?o===-1?16:o|16:o,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:l,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&di(i.ssContent),ssFallback:i.ssFallback&&di(i.ssFallback),placeholder:i.placeholder,el:i.el,anchor:i.anchor,ctx:i.ctx,ce:i.ce};return l&&n&&Vs(h,l.clone(h)),h}function ba(i=" ",t=0){return ge(Bn,null,i,t)}function Se(i="",t=!1){return t?(Ct(),Bh(Oe,null,i)):ge(Oe,null,i)}function se(i){return i==null||typeof i=="boolean"?ge(Oe):et(i)?ge(Wt,null,i.slice()):_a(i)?Ae(i):ge(Bn,null,String(i))}function Ae(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:di(i)}function Qs(i,t){let e=0;const{shapeFlag:n}=i;if(t==null)t=null;else if(et(t))e=16;else if(typeof t=="object")if(n&65){const s=t.default;s&&(s._c&&(s._d=!1),Qs(i,s()),s._c&&(s._d=!0));return}else{e=32;const s=t._;!s&&!oa(t)?t._ctx=oe:s===3&&oe&&(oe.slots._===1?t._=1:(t._=2,i.patchFlag|=1024))}else nt(t)?(t={default:t,_ctx:oe},e=32):(t=String(t),n&64?(e=16,t=[ba(t)]):e=8);i.children=t,i.shapeFlag|=e}function zh(...i){const t={};for(let e=0;e<i.length;e++){const n=i[e];for(const s in n)if(s==="class")t.class!==n.class&&(t.class=Yi([t.class,n.class]));else if(s==="style")t.style=Bs([t.style,n.style]);else if(kn(s)){const r=t[s],o=n[s];o&&r!==o&&!(et(r)&&r.includes(o))&&(t[s]=r?[].concat(r,o):o)}else s!==""&&(t[s]=n[s])}return t}function ee(i,t,e,n=null){le(i,t,7,[e,n])}const Uh=ia();let Yh=0;function jh(i,t,e){const n=i.type,s=(t?t.appContext:i.appContext)||Uh,r={uid:Yh++,vnode:i,type:n,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new pl(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:la(n,s),emitsOptions:na(n,s),emit:null,emitted:null,propsDefaults:yt,inheritAttrs:n.inheritAttrs,ctx:yt,data:yt,props:yt,attrs:yt,slots:yt,refs:yt,setupState:yt,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=vh.bind(null,r),i.ce&&i.ce(r),r}let It=null;const Kh=()=>It||oe;let An,vs;{const i=In(),t=(e,n)=>{let s;return(s=i[e])||(s=i[e]=[]),s.push(n),r=>{s.length>1?s.forEach(o=>o(r)):s[0](r)}};An=t("__VUE_INSTANCE_SETTERS__",e=>It=e),vs=t("__VUE_SSR_SETTERS__",e=>qi=e)}const Zi=i=>{const t=It;return An(i),i.scope.on(),()=>{i.scope.off(),An(t)}},Cr=()=>{It&&It.scope.off(),An(null)};function xa(i){return i.vnode.shapeFlag&4}let qi=!1;function Xh(i,t=!1,e=!1){t&&vs(t);const{props:n,children:s}=i.vnode,r=xa(i);Ah(i,n,r,t),kh(i,s,e||t);const o=r?Vh(i,t):void 0;return t&&vs(!1),o}function Vh(i,t){const e=i.type;i.accessCache=Object.create(null),i.proxy=new Proxy(i.ctx,fh);const{setup:n}=e;if(n){pe();const s=i.setupContext=n.length>1?qh(i):null,r=Zi(i),o=Ji(n,i,0,[i.props,s]),a=_o(o);if(me(),r(),(a||i.sp)&&!Fi(i)&&Vo(i),a){if(o.then(Cr,Cr),t)return o.then(l=>{wr(i,l)}).catch(l=>{Dn(l,i,0)});i.asyncDep=o}else wr(i,o)}else va(i)}function wr(i,t,e){nt(t)?i.type.__ssrInlineRender?i.ssrRender=t:i.render=t:vt(t)&&(i.setupState=Bo(t)),va(i)}function va(i,t,e){const n=i.type;i.render||(i.render=n.render||ae);{const s=Zi(i);pe();try{uh(i)}finally{me(),s()}}}const $h={get(i,t){return Rt(i,"get",""),i[t]}};function qh(i){const t=e=>{i.exposed=e||{}};return{attrs:new Proxy(i.attrs,$h),slots:i.slots,emit:i.emit,expose:t}}function Js(i){return i.exposed?i.exposeProxy||(i.exposeProxy=new Proxy(Bo(Dl(i.exposed)),{get(t,e){if(e in t)return t[e];if(e in Ni)return Ni[e](i)},has(t,e){return e in t||e in Ni}})):i.proxy}function Qh(i){return nt(i)&&"__vccOpts"in i}const Ss=(i,t)=>Wl(i,t,qi),Jh="3.5.27";let Cs;const Tr=typeof window<"u"&&window.trustedTypes;if(Tr)try{Cs=Tr.createPolicy("vue",{createHTML:i=>i})}catch{}const Sa=Cs?i=>Cs.createHTML(i):i=>i,Zh="http://www.w3.org/2000/svg",tc="http://www.w3.org/1998/Math/MathML",fe=typeof document<"u"?document:null,Pr=fe&&fe.createElement("template"),ec={insert:(i,t,e)=>{t.insertBefore(i,e||null)},remove:i=>{const t=i.parentNode;t&&t.removeChild(i)},createElement:(i,t,e,n)=>{const s=t==="svg"?fe.createElementNS(Zh,i):t==="mathml"?fe.createElementNS(tc,i):e?fe.createElement(i,{is:e}):fe.createElement(i);return i==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:i=>fe.createTextNode(i),createComment:i=>fe.createComment(i),setText:(i,t)=>{i.nodeValue=t},setElementText:(i,t)=>{i.textContent=t},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>fe.querySelector(i),setScopeId(i,t){i.setAttribute(t,"")},insertStaticContent(i,t,e,n,s,r){const o=e?e.previousSibling:t.lastChild;if(s&&(s===r||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),e),!(s===r||!(s=s.nextSibling)););else{Pr.innerHTML=Sa(n==="svg"?`<svg>${i}</svg>`:n==="mathml"?`<math>${i}</math>`:i);const a=Pr.content;if(n==="svg"||n==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},ic=Symbol("_vtc");function nc(i,t,e){const n=i[ic];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?i.removeAttribute("class"):e?i.setAttribute("class",t):i.className=t}const Ar=Symbol("_vod"),sc=Symbol("_vsh"),rc=Symbol(""),oc=/(?:^|;)\s*display\s*:/;function ac(i,t,e){const n=i.style,s=Tt(e);let r=!1;if(e&&!s){if(t)if(Tt(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();e[a]==null&&bn(n,a,"")}else for(const o in t)e[o]==null&&bn(n,o,"");for(const o in e)o==="display"&&(r=!0),bn(n,o,e[o])}else if(s){if(t!==e){const o=n[rc];o&&(e+=";"+o),n.cssText=e,r=oc.test(e)}}else t&&i.removeAttribute("style");Ar in i&&(i[Ar]=r?n.display:"",i[sc]&&(n.display="none"))}const Er=/\s*!important$/;function bn(i,t,e){if(et(e))e.forEach(n=>bn(i,t,n));else if(e==null&&(e=""),t.startsWith("--"))i.setProperty(t,e);else{const n=lc(i,t);Er.test(e)?i.setProperty(Xe(n),e.replace(Er,""),"important"):i[n]=e}}const Rr=["Webkit","Moz","ms"],ts={};function lc(i,t){const e=ts[t];if(e)return e;let n=ke(t);if(n!=="filter"&&n in i)return ts[t]=n;n=xo(n);for(let s=0;s<Rr.length;s++){const r=Rr[s]+n;if(r in i)return ts[t]=r}return t}const Mr="http://www.w3.org/1999/xlink";function kr(i,t,e,n,s,r=gl(t)){n&&t.startsWith("xlink:")?e==null?i.removeAttributeNS(Mr,t.slice(6,t.length)):i.setAttributeNS(Mr,t,e):e==null||r&&!So(e)?i.removeAttribute(t):i.setAttribute(t,r?"":Ie(e)?String(e):e)}function Or(i,t,e,n,s){if(t==="innerHTML"||t==="textContent"){e!=null&&(i[t]=t==="innerHTML"?Sa(e):e);return}const r=i.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?i.getAttribute("value")||"":i.value,l=e==null?i.type==="checkbox"?"on":"":String(e);(a!==l||!("_value"in i))&&(i.value=l),e==null&&i.removeAttribute(t),i._value=e;return}let o=!1;if(e===""||e==null){const a=typeof i[t];a==="boolean"?e=So(e):e==null&&a==="string"?(e="",o=!0):a==="number"&&(e=0,o=!0)}try{i[t]=e}catch{}o&&i.removeAttribute(s||t)}function hc(i,t,e,n){i.addEventListener(t,e,n)}function cc(i,t,e,n){i.removeEventListener(t,e,n)}const Lr=Symbol("_vei");function dc(i,t,e,n,s=null){const r=i[Lr]||(i[Lr]={}),o=r[t];if(n&&o)o.value=n;else{const[a,l]=fc(t);if(n){const c=r[t]=pc(n,s);hc(i,a,c,l)}else o&&(cc(i,a,o,l),r[t]=void 0)}}const Ir=/(?:Once|Passive|Capture)$/;function fc(i){let t;if(Ir.test(i)){t={};let n;for(;n=i.match(Ir);)i=i.slice(0,i.length-n[0].length),t[n[0].toLowerCase()]=!0}return[i[2]===":"?i.slice(3):Xe(i.slice(2)),t]}let es=0;const uc=Promise.resolve(),gc=()=>es||(uc.then(()=>es=0),es=Date.now());function pc(i,t){const e=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=e.attached)return;le(mc(n,e.value),t,5,[n])};return e.value=i,e.attached=gc(),e}function mc(i,t){if(et(t)){const e=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{e.call(i),i._stopped=!0},t.map(n=>s=>!s._stopped&&n&&n(s))}else return t}const Gr=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)>96&&i.charCodeAt(2)<123,_c=(i,t,e,n,s,r)=>{const o=s==="svg";t==="class"?nc(i,n,o):t==="style"?ac(i,e,n):kn(t)?Ds(t)||dc(i,t,e,n,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):yc(i,t,n,o))?(Or(i,t,n),!i.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&kr(i,t,n,o,r,t!=="value")):i._isVueCE&&(/[A-Z]/.test(t)||!Tt(n))?Or(i,ke(t),n,r,t):(t==="true-value"?i._trueValue=n:t==="false-value"&&(i._falseValue=n),kr(i,t,n,o))};function yc(i,t,e,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in i&&Gr(t)&&nt(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&i.tagName==="IFRAME"||t==="form"||t==="list"&&i.tagName==="INPUT"||t==="type"&&i.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=i.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Gr(t)&&Tt(e)?!1:t in i}const bc=["ctrl","shift","alt","meta"],xc={stop:i=>i.stopPropagation(),prevent:i=>i.preventDefault(),self:i=>i.target!==i.currentTarget,ctrl:i=>!i.ctrlKey,shift:i=>!i.shiftKey,alt:i=>!i.altKey,meta:i=>!i.metaKey,left:i=>"button"in i&&i.button!==0,middle:i=>"button"in i&&i.button!==1,right:i=>"button"in i&&i.button!==2,exact:(i,t)=>bc.some(e=>i[`${e}Key`]&&!t.includes(e))},vc=(i,t)=>{const e=i._withMods||(i._withMods={}),n=t.join(".");return e[n]||(e[n]=((s,...r)=>{for(let o=0;o<t.length;o++){const a=xc[t[o]];if(a&&a(s,t))return}return i(s,...r)}))},Sc=kt({patchProp:_c},ec);let Dr;function Cc(){return Dr||(Dr=Lh(Sc))}const wc=((...i)=>{const t=Cc().createApp(...i),{mount:e}=t;return t.mount=n=>{const s=Pc(n);if(!s)return;const r=t._component;!nt(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=e(s,!1,Tc(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},t});function Tc(i){if(i instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&i instanceof MathMLElement)return"mathml"}function Pc(i){return Tt(i)?document.querySelector(i):i}const Ac=Math.PI/180;function Ec(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const Ye=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},B={_global:Ye,version:"10.2.0",isBrowser:Ec(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return B.angleDeg?i*Ac:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return B.DD.isDragging},isTransforming(){var i,t;return(t=(i=B.Transformer)===null||i===void 0?void 0:i.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!B.DD.node},releaseCanvasOnDestroy:!0,document:Ye.document,_injectGlobal(i){typeof Ye.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),Ye.Konva=i}},St=i=>{B[i.prototype.getClassName()]=i};B._injectGlobal(B);const Rc=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,Fr=()=>{if(typeof document>"u")throw new Error(Rc)};class zt{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new zt(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),s=this.m[0]*e+this.m[2]*n,r=this.m[1]*e+this.m[3]*n,o=this.m[0]*-n+this.m[2]*e,a=this.m[1]*-n+this.m[3]*e;return this.m[0]=s,this.m[1]=r,this.m[2]=o,this.m[3]=a,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){const n=this.m[0]+this.m[2]*e,s=this.m[1]+this.m[3]*e,r=this.m[2]+this.m[0]*t,o=this.m[3]+this.m[1]*t;return this.m[0]=n,this.m[1]=s,this.m[2]=r,this.m[3]=o,this}multiply(t){const e=this.m[0]*t.m[0]+this.m[2]*t.m[1],n=this.m[1]*t.m[0]+this.m[3]*t.m[1],s=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],o=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],a=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=n,this.m[2]=s,this.m[3]=r,this.m[4]=o,this.m[5]=a,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,n=-this.m[1]*t,s=-this.m[2]*t,r=this.m[0]*t,o=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=n,this.m[2]=s,this.m[3]=r,this.m[4]=o,this.m[5]=a,this}getMatrix(){return this.m}decompose(){const t=this.m[0],e=this.m[1],n=this.m[2],s=this.m[3],r=this.m[4],o=this.m[5],a=t*s-e*n,l={x:r,y:o,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||e!=0){const c=Math.sqrt(t*t+e*e);l.rotation=e>0?Math.acos(t/c):-Math.acos(t/c),l.scaleX=c,l.scaleY=a/c,l.skewX=(t*n+e*s)/a,l.skewY=0}else if(n!=0||s!=0){const c=Math.sqrt(n*n+s*s);l.rotation=Math.PI/2-(s>0?Math.acos(-n/c):-Math.acos(n/c)),l.scaleX=a/c,l.scaleY=c,l.skewX=0,l.skewY=(t*n+e*s)/a}return l.rotation=x._getRotation(l.rotation),l}}const Mc="[object Array]",kc="[object Number]",Oc="[object String]",Lc="[object Boolean]",Ic=Math.PI/180,Gc=180/Math.PI,vi="#",Dc="",Fc="0",Nc="Konva warning: ",Nr="Konva error: ",Bc="rgb(",is={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},Hc=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let on=[],Si=null;const Wc=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(i){setTimeout(i,16)},x={_isElement(i){return!!(i&&i.nodeType==1)},_isFunction(i){return!!(i&&i.constructor&&i.call&&i.apply)},_isPlainObject(i){return!!i&&i.constructor===Object},_isArray(i){return Object.prototype.toString.call(i)===Mc},_isNumber(i){return Object.prototype.toString.call(i)===kc&&!isNaN(i)&&isFinite(i)},_isString(i){return Object.prototype.toString.call(i)===Oc},_isBoolean(i){return Object.prototype.toString.call(i)===Lc},isObject(i){return i instanceof Object},isValidSelector(i){if(typeof i!="string")return!1;const t=i[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(i){return i===0||i>0?1:-1},requestAnimFrame(i){on.push(i),on.length===1&&Wc(function(){const t=on;on=[],t.forEach(function(e){e()})})},createCanvasElement(){Fr();const i=document.createElement("canvas");try{i.style=i.style||{}}catch{}return i},createImageElement(){return Fr(),document.createElement("img")},_isInDocument(i){for(;i=i.parentNode;)if(i==document)return!0;return!1},_urlToImage(i,t){const e=x.createImageElement();e.onload=function(){t(e)},e.src=i},_rgbToHex(i,t,e){return((1<<24)+(i<<16)+(t<<8)+e).toString(16).slice(1)},_hexToRgb(i){i=i.replace(vi,Dc);const t=parseInt(i,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let i=(Math.random()*16777215<<0).toString(16);for(;i.length<6;)i=Fc+i;return vi+i},isCanvasFarblingActive(){if(Si!==null)return Si;if(typeof document>"u")return Si=!1,!1;const i=this.createCanvasElement();i.width=10,i.height=10;const t=i.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,10,10),t.fillStyle="#282828",t.fillRect(0,0,10,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let s=0;s<100;s++)if(e[s*4]!==40||e[s*4+1]!==40||e[s*4+2]!==40||e[s*4+3]!==255){n=!0;break}return Si=n,this.releaseCanvas(i),Si},getHitColor(){const i=this.getRandomColor();return this.isCanvasFarblingActive()?this.getSnappedHexColor(i):i},getHitColorKey(i,t,e){return this.isCanvasFarblingActive()&&(i=Math.round(i/5)*5,t=Math.round(t/5)*5,e=Math.round(e/5)*5),vi+this._rgbToHex(i,t,e)},getSnappedHexColor(i){const t=this._hexToRgb(i);return vi+this._rgbToHex(Math.round(t.r/5)*5,Math.round(t.g/5)*5,Math.round(t.b/5)*5)},getRGB(i){let t;return i in is?(t=is[i],{r:t[0],g:t[1],b:t[2]}):i[0]===vi?this._hexToRgb(i.substring(1)):i.substr(0,4)===Bc?(t=Hc.exec(i.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(i){return i=i||"black",x._namedColorToRBA(i)||x._hex3ColorToRGBA(i)||x._hex4ColorToRGBA(i)||x._hex6ColorToRGBA(i)||x._hex8ColorToRGBA(i)||x._rgbColorToRGBA(i)||x._rgbaColorToRGBA(i)||x._hslColorToRGBA(i)},_namedColorToRBA(i){const t=is[i.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(i){if(i.indexOf("rgb(")===0){i=i.match(/rgb\(([^)]+)\)/)[1];const t=i.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(i){if(i.indexOf("rgba(")===0){i=i.match(/rgba\(([^)]+)\)/)[1];const t=i.split(/ *, */).map((e,n)=>e.slice(-1)==="%"?n===3?parseInt(e)/100:parseInt(e)/100*255:Number(e));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(i){if(i[0]==="#"&&i.length===9)return{r:parseInt(i.slice(1,3),16),g:parseInt(i.slice(3,5),16),b:parseInt(i.slice(5,7),16),a:parseInt(i.slice(7,9),16)/255}},_hex6ColorToRGBA(i){if(i[0]==="#"&&i.length===7)return{r:parseInt(i.slice(1,3),16),g:parseInt(i.slice(3,5),16),b:parseInt(i.slice(5,7),16),a:1}},_hex4ColorToRGBA(i){if(i[0]==="#"&&i.length===5)return{r:parseInt(i[1]+i[1],16),g:parseInt(i[2]+i[2],16),b:parseInt(i[3]+i[3],16),a:parseInt(i[4]+i[4],16)/255}},_hex3ColorToRGBA(i){if(i[0]==="#"&&i.length===4)return{r:parseInt(i[1]+i[1],16),g:parseInt(i[2]+i[2],16),b:parseInt(i[3]+i[3],16),a:1}},_hslColorToRGBA(i){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(i)){const[t,...e]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(i),n=Number(e[0])/360,s=Number(e[1])/100,r=Number(e[2])/100;let o,a,l;if(s===0)return l=r*255,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};r<.5?o=r*(1+s):o=r+s-r*s;const c=2*r-o,h=[0,0,0];for(let d=0;d<3;d++)a=n+1/3*-(d-1),a<0&&a++,a>1&&a--,6*a<1?l=c+(o-c)*6*a:2*a<1?l=o:3*a<2?l=c+(o-c)*(2/3-a)*6:l=c,h[d]=l*255;return{r:Math.round(h[0]),g:Math.round(h[1]),b:Math.round(h[2]),a:1}}},haveIntersection(i,t){return!(t.x>i.x+i.width||t.x+t.width<i.x||t.y>i.y+i.height||t.y+t.height<i.y)},cloneObject(i){const t={};for(const e in i)this._isPlainObject(i[e])?t[e]=this.cloneObject(i[e]):this._isArray(i[e])?t[e]=this.cloneArray(i[e]):t[e]=i[e];return t},cloneArray(i){return i.slice(0)},degToRad(i){return i*Ic},radToDeg(i){return i*Gc},_degToRad(i){return x.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),x.degToRad(i)},_radToDeg(i){return x.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),x.radToDeg(i)},_getRotation(i){return B.angleDeg?x.radToDeg(i):i},_capitalize(i){return i.charAt(0).toUpperCase()+i.slice(1)},throw(i){throw new Error(Nr+i)},error(i){console.error(Nr+i)},warn(i){B.showWarnings&&console.warn(Nc+i)},each(i,t){for(const e in i)t(e,i[e])},_inRange(i,t,e){return t<=i&&i<e},_getProjectionToSegment(i,t,e,n,s,r){let o,a,l;const c=(i-e)*(i-e)+(t-n)*(t-n);if(c==0)o=i,a=t,l=(s-e)*(s-e)+(r-n)*(r-n);else{const h=((s-i)*(e-i)+(r-t)*(n-t))/c;h<0?(o=i,a=t,l=(i-s)*(i-s)+(t-r)*(t-r)):h>1?(o=e,a=n,l=(e-s)*(e-s)+(n-r)*(n-r)):(o=i+h*(e-i),a=t+h*(n-t),l=(o-s)*(o-s)+(a-r)*(a-r))}return[o,a,l]},_getProjectionToLine(i,t,e){const n=x.cloneObject(i);let s=Number.MAX_VALUE;return t.forEach(function(r,o){if(!e&&o===t.length-1)return;const a=t[(o+1)%t.length],l=x._getProjectionToSegment(r.x,r.y,a.x,a.y,i.x,i.y),c=l[0],h=l[1],d=l[2];d<s&&(n.x=c,n.y=h,s=d)}),n},_prepareArrayForTween(i,t,e){const n=[],s=[];if(i.length>t.length){const o=t;t=i,i=o}for(let o=0;o<i.length;o+=2)n.push({x:i[o],y:i[o+1]});for(let o=0;o<t.length;o+=2)s.push({x:t[o],y:t[o+1]});const r=[];return s.forEach(function(o){const a=x._getProjectionToLine(o,n,e);r.push(a.x),r.push(a.y)}),r},_prepareToStringify(i){let t;i.visitedByCircularReferenceRemoval=!0;for(const e in i)if(i.hasOwnProperty(e)&&i[e]&&typeof i[e]=="object"){if(t=Object.getOwnPropertyDescriptor(i,e),i[e].visitedByCircularReferenceRemoval||x._isElement(i[e]))if(t.configurable)delete i[e];else return null;else if(x._prepareToStringify(i[e])===null)if(t.configurable)delete i[e];else return null}return delete i.visitedByCircularReferenceRemoval,i},_assign(i,t){for(const e in t)i[e]=t[e];return i},_getFirstPointerId(i){return i.touches?i.changedTouches[0].identifier:i.pointerId||999},releaseCanvas(...i){B.releaseCanvasOnDestroy&&i.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(i,t,e,n){let s=t<0?t:0,r=e<0?e:0;t=Math.abs(t),e=Math.abs(e);let o=0,a=0,l=0,c=0;typeof n=="number"?o=a=l=c=Math.min(n,t/2,e/2):(o=Math.min(n[0]||0,t/2,e/2),a=Math.min(n[1]||0,t/2,e/2),c=Math.min(n[2]||0,t/2,e/2),l=Math.min(n[3]||0,t/2,e/2)),i.moveTo(s+o,r),i.lineTo(s+t-a,r),i.arc(s+t-a,r+a,a,Math.PI*3/2,0,!1),i.lineTo(s+t,r+e-c),i.arc(s+t-c,r+e-c,c,0,Math.PI/2,!1),i.lineTo(s+l,r+e),i.arc(s+l,r+e-l,l,Math.PI/2,Math.PI,!1),i.lineTo(s,r+o),i.arc(s+o,r+o,o,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(i,t,e,n,s){n=Math.abs(n);for(let r=0;r<e;r++){const o=t[(r-1+e)%e],a=t[r],l=t[(r+1)%e],c={x:a.x-o.x,y:a.y-o.y},h={x:l.x-a.x,y:l.y-a.y},d=Math.hypot(c.x,c.y),f=Math.hypot(h.x,h.y);let g;typeof s=="number"?g=s:g=r<s.length?s[r]:0,g=n*Math.cos(Math.PI/e)*Math.min(1,g/n*2);const _={x:c.x/d,y:c.y/d},C={x:h.x/f,y:h.y/f},b={x:a.x-_.x*g,y:a.y-_.y*g},v={x:a.x+C.x*g,y:a.y+C.y*g};r===0?i.moveTo(b.x,b.y):i.lineTo(b.x,b.y),i.arcTo(a.x,a.y,v.x,v.y,g)}}};function zc(i){const t=[],e=i.length,n=x;for(let s=0;s<e;s++){let r=i[s];n._isNumber(r)?r=Math.round(r*1e3)/1e3:n._isString(r)||(r=r+""),t.push(r)}return t}const Br=",",Uc="(",Yc=")",jc="([",Kc="])",Xc=";",Vc="()",$c="=",Hr=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],qc=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],Qc=100;let an=null;function Wr(){if(an!==null)return an;try{const t=x.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(an=!1,!1)}catch{return an=!1,!1}}class Hn{constructor(t){this.canvas=t,B.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){let n=this.traceArr,s=n.length,r="",o,a,l,c;for(o=0;o<s;o++)a=n[o],l=a.method,l?(c=a.args,r+=l,t?r+=Vc:x._isArray(c[0])?r+=jc+c.join(Br)+Kc:(e&&(c=c.map(h=>typeof h=="number"?Math.floor(h):h)),r+=Uc+c.join(Br)+Yc)):(r+=a.property,t||(r+=$c+a.val)),r+=Xc;return r}clearTrace(){this.traceArr=[]}_trace(t){let e=this.traceArr,n;e.push(t),n=e.length,n>=Qc&&e.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){const e=t.attrs.lineCap;e&&this.setAttr("lineCap",e)}_applyOpacity(t){const e=t.getAbsoluteOpacity();e!==1&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){const e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}_applyMiterLimit(t){const e=t.attrs.miterLimit;e!=null&&this.setAttr("miterLimit",e)}setAttr(t,e){this._context[t]=e}arc(t,e,n,s,r,o){this._context.arc(t,e,n,s,r,o)}arcTo(t,e,n,s,r){this._context.arcTo(t,e,n,s,r)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,n,s,r,o){this._context.bezierCurveTo(t,e,n,s,r,o)}clearRect(t,e,n,s){this._context.clearRect(t,e,n,s)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,e){const n=arguments;if(n.length===2)return this._context.createImageData(t,e);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,e,n,s){return this._context.createLinearGradient(t,e,n,s)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,n,s,r,o){return this._context.createRadialGradient(t,e,n,s,r,o)}drawImage(t,e,n,s,r,o,a,l,c){const h=arguments,d=this._context;h.length===3?d.drawImage(t,e,n):h.length===5?d.drawImage(t,e,n,s,r):h.length===9&&d.drawImage(t,e,n,s,r,o,a,l,c)}ellipse(t,e,n,s,r,o,a,l){this._context.ellipse(t,e,n,s,r,o,a,l)}isPointInPath(t,e,n,s){return n?this._context.isPointInPath(n,t,e,s):this._context.isPointInPath(t,e,s)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,e,n,s){this._context.fillRect(t,e,n,s)}strokeRect(t,e,n,s){this._context.strokeRect(t,e,n,s)}fillText(t,e,n,s){s?this._context.fillText(t,e,n,s):this._context.fillText(t,e,n)}measureText(t){return this._context.measureText(t)}getImageData(t,e,n,s){return this._context.getImageData(t,e,n,s)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,n,s){this._context.rect(t,e,n,s)}roundRect(t,e,n,s,r){this._context.roundRect(t,e,n,s,r)}putImageData(t,e,n){this._context.putImageData(t,e,n)}quadraticCurveTo(t,e,n,s){this._context.quadraticCurveTo(t,e,n,s)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,n,s,r,o){this._context.setTransform(t,e,n,s,r,o)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,n,s){this._context.strokeText(t,e,n,s)}transform(t,e,n,s,r,o){this._context.transform(t,e,n,s,r,o)}translate(t,e){this._context.translate(t,e)}_enableTrace(){let t=this,e=Hr.length,n=this.setAttr,s,r;const o=function(a){let l=t[a],c;t[a]=function(){return r=zc(Array.prototype.slice.call(arguments,0)),c=l.apply(t,arguments),t._trace({method:a,args:r}),c}};for(s=0;s<e;s++)o(Hr[s]);t.setAttr=function(){n.apply(t,arguments);const a=arguments[0];let l=arguments[1];(a==="shadowOffsetX"||a==="shadowOffsetY"||a==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),t._trace({property:a,val:l})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;!e||e==="source-over"||this.setAttr("globalCompositeOperation",e)}}qc.forEach(function(i){Object.defineProperty(Hn.prototype,i,{get(){return this._context[i]},set(t){this._context[i]=t}})});class Jc extends Hn{constructor(t,{willReadFrequently:e=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:e})}_fillColor(t){const e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){const e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){const e=t.fill(),n=t.getFillPriority();if(e&&n==="color"){this._fillColor(t);return}const s=t.getFillPatternImage();if(s&&n==="pattern"){this._fillPattern(t);return}const r=t.getFillLinearGradientColorStops();if(r&&n==="linear-gradient"){this._fillLinearGradient(t);return}const o=t.getFillRadialGradientColorStops();if(o&&n==="radial-gradient"){this._fillRadialGradient(t);return}e?this._fillColor(t):s?this._fillPattern(t):r?this._fillLinearGradient(t):o&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const e=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),s=t.getStrokeLinearGradientColorStops(),r=this.createLinearGradient(e.x,e.y,n.x,n.y);if(s){for(let o=0;o<s.length;o+=2)r.addColorStop(s[o],s[o+1]);this.setAttr("strokeStyle",r)}}_stroke(t){const e=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();const r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var e,n,s;const r=(e=t.getShadowRGBA())!==null&&e!==void 0?e:"black",o=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,a=(s=t.getShadowOffset())!==null&&s!==void 0?s:{x:0,y:0},l=t.getAbsoluteScale(),c=this.canvas.getPixelRatio(),h=l.x*c,d=l.y*c;this.setAttr("shadowColor",r),this.setAttr("shadowBlur",o*Math.min(Math.abs(h),Math.abs(d))),this.setAttr("shadowOffsetX",a.x*h),this.setAttr("shadowOffsetY",a.y*d)}}class Zc extends Hn{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const e=t.getStrokeScaleEnabled();if(!e){this.save();const r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(t);const n=t.hitStrokeWidth(),s=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",s),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}}let ln;function t0(){if(ln)return ln;const i=x.createCanvasElement(),t=i.getContext("2d");return ln=(function(){const e=B._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return e/n})(),x.releaseCanvas(i),ln}class Zs{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(t||{}).pixelRatio||B.pixelRatio||t0();this.pixelRatio=n,this._canvas=x.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const e=this.pixelRatio;this.getContext()._context.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const e=this.pixelRatio;this.getContext()._context.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch{try{return this._canvas.toDataURL()}catch(s){return x.error("Unable to get data URL. "+s.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class Re extends Zs{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new Jc(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}class tr extends Zs{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new Zc(this),this.setSize(t.width,t.height)}}const ht={get isDragging(){let i=!1;return ht._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return ht._dragElements.forEach(t=>{i=t.node}),i},_dragElements:new Map,_drag(i){const t=[];ht._dragElements.forEach((e,n)=>{const{node:s}=e,r=s.getStage();r.setPointersPositions(i),e.pointerId===void 0&&(e.pointerId=x._getFirstPointerId(i));const o=r._changedPointerPositions.find(a=>a.id===e.pointerId);if(o){if(e.dragStatus!=="dragging"){const a=s.dragDistance();if(Math.max(Math.abs(o.x-e.startPointerPos.x),Math.abs(o.y-e.startPointerPos.y))<a||(s.startDrag({evt:i}),!s.isDragging()))return}s._setDragPosition(i,e),t.push(s)}}),t.forEach(e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:i},!0)})},_endDragBefore(i){const t=[];ht._dragElements.forEach(e=>{const{node:n}=e,s=n.getStage();if(i&&s.setPointersPositions(i),!s._changedPointerPositions.find(a=>a.id===e.pointerId))return;(e.dragStatus==="dragging"||e.dragStatus==="stopped")&&(ht.justDragged=!0,B._mouseListenClick=!1,B._touchListenClick=!1,B._pointerListenClick=!1,e.dragStatus="stopped");const o=e.node.getLayer()||e.node instanceof B.Stage&&e.node;o&&t.indexOf(o)===-1&&t.push(o)}),t.forEach(e=>{e.draw()})},_endDragAfter(i){ht._dragElements.forEach((t,e)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:i},!0),t.dragStatus!=="dragging"&&ht._dragElements.delete(e)})}};B.isBrowser&&(window.addEventListener("mouseup",ht._endDragBefore,!0),window.addEventListener("touchend",ht._endDragBefore,!0),window.addEventListener("touchcancel",ht._endDragBefore,!0),window.addEventListener("mousemove",ht._drag),window.addEventListener("touchmove",ht._drag),window.addEventListener("mouseup",ht._endDragAfter,!1),window.addEventListener("touchend",ht._endDragAfter,!1),window.addEventListener("touchcancel",ht._endDragAfter,!1));function Ge(i){return x._isString(i)?'"'+i+'"':Object.prototype.toString.call(i)==="[object Number]"||x._isBoolean(i)?i:Object.prototype.toString.call(i)}function Ca(i){return i>255?255:i<0?0:Math.round(i)}function G(){if(B.isUnminified)return function(i,t){return x._isNumber(i)||x.warn(Ge(i)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),i}}function Wn(i){if(B.isUnminified)return function(t,e){let n=x._isNumber(t),s=x._isArray(t)&&t.length==i;return!n&&!s&&x.warn(Ge(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or Array<number>('+i+")"),t}}function er(){if(B.isUnminified)return function(i,t){return x._isNumber(i)||i==="auto"||x.warn(Ge(i)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),i}}function Ve(){if(B.isUnminified)return function(i,t){return x._isString(i)||x.warn(Ge(i)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),i}}function wa(){if(B.isUnminified)return function(i,t){const e=x._isString(i),n=Object.prototype.toString.call(i)==="[object CanvasGradient]"||i&&i.addColorStop;return e||n||x.warn(Ge(i)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),i}}function e0(){if(B.isUnminified)return function(i,t){const e=Int8Array?Object.getPrototypeOf(Int8Array):null;return e&&i instanceof e||(x._isArray(i)?i.forEach(function(n){x._isNumber(n)||x.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):x.warn(Ge(i)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),i}}function Qt(){if(B.isUnminified)return function(i,t){return i===!0||i===!1||x.warn(Ge(i)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),i}}function i0(i){if(B.isUnminified)return function(t,e){return t==null||x.isObject(t)||x.warn(Ge(t)+' is a not valid value for "'+e+'" attribute. The value should be an object with properties '+i),t}}const Ci="get",wi="set",p={addGetterSetter(i,t,e,n,s){p.addGetter(i,t,e),p.addSetter(i,t,n,s),p.addOverloadedGetterSetter(i,t)},addGetter(i,t,e){const n=Ci+x._capitalize(t);i.prototype[n]=i.prototype[n]||function(){const s=this.attrs[t];return s===void 0?e:s}},addSetter(i,t,e,n){const s=wi+x._capitalize(t);i.prototype[s]||p.overWriteSetter(i,t,e,n)},overWriteSetter(i,t,e,n){const s=wi+x._capitalize(t);i.prototype[s]=function(r){return e&&r!==void 0&&r!==null&&(r=e.call(this,r,t)),this._setAttr(t,r),n&&n.call(this),this}},addComponentsGetterSetter(i,t,e,n,s){const r=e.length,o=x._capitalize,a=Ci+o(t),l=wi+o(t);i.prototype[a]=function(){const h={};for(let d=0;d<r;d++){const f=e[d];h[f]=this.getAttr(t+o(f))}return h};const c=i0(e);i.prototype[l]=function(h){const d=this.attrs[t];n&&(h=n.call(this,h,t)),c&&c.call(this,h,t);for(const f in h)h.hasOwnProperty(f)&&this._setAttr(t+o(f),h[f]);return h||e.forEach(f=>{this._setAttr(t+o(f),void 0)}),this._fireChangeEvent(t,d,h),s&&s.call(this),this},p.addOverloadedGetterSetter(i,t)},addOverloadedGetterSetter(i,t){const e=x._capitalize(t),n=wi+e,s=Ci+e;i.prototype[t]=function(){return arguments.length?(this[n](arguments[0]),this):this[s]()}},addDeprecatedGetterSetter(i,t,e,n){x.error("Adding deprecated "+t);const s=Ci+x._capitalize(t),r=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";i.prototype[s]=function(){x.error(r);const o=this.attrs[t];return o===void 0?e:o},p.addSetter(i,t,n,function(){x.error(r)}),p.addOverloadedGetterSetter(i,t)},backCompat(i,t){x.each(t,function(e,n){const s=i.prototype[n],r=Ci+x._capitalize(e),o=wi+x._capitalize(e);function a(){s.apply(this,arguments),x.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}i.prototype[e]=a,i.prototype[r]=a,i.prototype[o]=a})},afterSetFilter(){this._filterUpToDate=!1}};function n0(i){const t=/(\w+)\(([^)]+)\)/g;let e;for(;(e=t.exec(i))!==null;){const[,n,s]=e;switch(n){case"blur":{const r=parseFloat(s.replace("px",""));return function(o){this.blurRadius(r*.5);const a=B.Filters;a&&a.Blur&&a.Blur.call(this,o)}}case"brightness":{const r=s.includes("%")?parseFloat(s)/100:parseFloat(s);return function(o){this.brightness(r);const a=B.Filters;a&&a.Brightness&&a.Brightness.call(this,o)}}case"contrast":{const r=parseFloat(s);return function(o){const a=100*(Math.sqrt(r)-1);this.contrast(a);const l=B.Filters;l&&l.Contrast&&l.Contrast.call(this,o)}}case"grayscale":return function(r){const o=B.Filters;o&&o.Grayscale&&o.Grayscale.call(this,r)};case"sepia":return function(r){const o=B.Filters;o&&o.Sepia&&o.Sepia.call(this,r)};case"invert":return function(r){const o=B.Filters;o&&o.Invert&&o.Invert.call(this,r)};default:x.warn(`CSS filter "${n}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const xn="absoluteOpacity",zr="allEventListeners",de="absoluteTransform",Ur="absoluteScale",We="canvas",s0="Change",r0="children",o0="konva",ws="listening",a0="mouseenter",l0="mouseleave",h0="pointerenter",c0="pointerleave",d0="touchenter",f0="touchleave",Yr="set",jr="Shape",vn=" ",Kr="stage",Ce="transform",u0="Stage",Ts="visible",g0=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(vn);let p0=1;class L{constructor(t){this._id=p0++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===Ce||t===de)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,e){let n=this._cache.get(t);return(n===void 0||(t===Ce||t===de)&&n.dirty===!0)&&(n=e.call(this),this._cache.set(t,n)),n}_calculate(t,e,n){if(!this._attachedDepsListeners.get(t)){const s=e.map(r=>r+"Change.konva").join(vn);this.on(s,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)}_getCanvasCache(){return this._cache.get(We)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===de&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(We)){const{scene:t,filter:e,hit:n}=this._cache.get(We);x.releaseCanvas(t._canvas,e._canvas,n._canvas),this._cache.delete(We)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const e=t||{};let n={};(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let s=Math.ceil(e.width||n.width),r=Math.ceil(e.height||n.height),o=e.pixelRatio,a=e.x===void 0?Math.floor(n.x):e.x,l=e.y===void 0?Math.floor(n.y):e.y,c=e.offset||0,h=e.drawBorder||!1,d=e.hitCanvasPixelRatio||1;if(!s||!r){x.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const f=Math.abs(Math.round(n.x)-a)>.5?1:0,g=Math.abs(Math.round(n.y)-l)>.5?1:0;s+=c*2+f,r+=c*2+g,a-=c,l-=c;const u=new Re({pixelRatio:o,width:s,height:r}),_=new Re({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),C=new tr({pixelRatio:d,width:s,height:r}),b=u.getContext(),v=C.getContext(),w=new Re({width:u.width/u.pixelRatio+Math.abs(a),height:u.height/u.pixelRatio+Math.abs(l),pixelRatio:u.pixelRatio}),S=w.getContext();return C.isCache=!0,u.isCache=!0,this._cache.delete(We),this._filterUpToDate=!1,e.imageSmoothingEnabled===!1&&(u.getContext()._context.imageSmoothingEnabled=!1,_.getContext()._context.imageSmoothingEnabled=!1),b.save(),v.save(),S.save(),b.translate(-a,-l),v.translate(-a,-l),S.translate(-a,-l),w.x=a,w.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(xn),this._clearSelfAndDescendantCache(Ur),this.drawScene(u,this,w),this.drawHit(C,this),this._isUnderCache=!1,b.restore(),v.restore(),h&&(b.save(),b.beginPath(),b.rect(0,0,s,r),b.closePath(),b.setAttr("strokeStyle","red"),b.setAttr("lineWidth",5),b.stroke(),b.restore()),x.releaseCanvas(w._canvas),this._cache.set(We,{scene:u,filter:_,hit:C,x:a,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(We)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){const n=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let s=1/0,r=1/0,o=-1/0,a=-1/0;const l=this.getAbsoluteTransform(e);return n.forEach(function(c){const h=l.point(c);s===void 0&&(s=o=h.x,r=a=h.y),s=Math.min(s,h.x),r=Math.min(r,h.y),o=Math.max(o,h.x),a=Math.max(a,h.y)}),{x:s,y:r,width:o-s,height:a-r}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);const n=this._getCachedSceneCanvas(),s=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/s,n.height/s),t.restore()}_drawCachedHitCanvas(t){const e=this._getCanvasCache(),n=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),e=this._getCanvasCache(),n=e.scene,s=e.filter,r=s.getContext(),o,a,l,c;if(!t||t.length===0)return n;if(this._filterUpToDate)return s;let h=!0;for(let f=0;f<t.length;f++)if(typeof t[f]=="string"&&Wr(),typeof t[f]!="string"||!Wr()){h=!1;break}const d=n.pixelRatio;if(s.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio),h){const f=t.join(" ");return r.save(),r.setAttr("filter",f),r.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),r.restore(),this._filterUpToDate=!0,s}try{for(o=t.length,r.clear(),r.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),a=r.getImageData(0,0,s.getWidth(),s.getHeight()),l=0;l<o;l++)c=t[l],typeof c=="string"&&(c=n0(c)),c.call(this,a),r.putImageData(a,0,0)}catch(f){x.error("Unable to apply filter. "+f.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,s}on(t,e){if(this._cache&&this._cache.delete(zr),arguments.length===3)return this._delegate.apply(this,arguments);const n=t.split(vn);for(let s=0;s<n.length;s++){const o=n[s].split("."),a=o[0],l=o[1]||"";this.eventListeners[a]||(this.eventListeners[a]=[]),this.eventListeners[a].push({name:l,handler:e})}return this}off(t,e){let n=(t||"").split(vn),s=n.length,r,o,a,l,c,h;if(this._cache&&this._cache.delete(zr),!t)for(o in this.eventListeners)this._off(o);for(r=0;r<s;r++)if(a=n[r],l=a.split("."),c=l[0],h=l[1],c)this.eventListeners[c]&&this._off(c,h,e);else for(o in this.eventListeners)this._off(o,h,e);return this}dispatchEvent(t){const e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,function(n){e.call(this,n.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,n){const s=this;this.on(t,function(r){const o=r.target.findAncestors(e,!0,s);for(let a=0;a<o.length;a++)r=x.cloneObject(r),r.currentTarget=o[a],n.call(o[a],r)})}remove(){return this.isDragging()&&this.stopDrag(),ht._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(de),this._clearSelfAndDescendantCache(xn),this._clearSelfAndDescendantCache(Ur),this._clearSelfAndDescendantCache(Kr),this._clearSelfAndDescendantCache(Ts),this._clearSelfAndDescendantCache(ws)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const e="get"+x._capitalize(t);return x._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){let t=this.getParent(),e=[];for(;t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let e,n;if(!t)return this;for(e in t)e!==r0&&(n=Yr+x._capitalize(e),x._isFunction(this[n])?this[n](t[e]):this._setAttr(e,t[e]))}),this}isListening(){return this._getCache(ws,this._isListening)}_isListening(t){if(!this.listening())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isListening(t):!0}isVisible(){return this._getCache(Ts,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isVisible(t):!0}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);const n=this.getLayer();let s=!1;ht._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===n)&&(s=!0)});const r=!e&&!B.hitOnDragEnabled&&(s||B.isTransforming());return this.isListening()&&this.isVisible()&&!r}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),e=this,n=0,s,r,o,a;function l(h){for(s=[],r=h.length,o=0;o<r;o++)a=h[o],n++,a.nodeType!==jr&&(s=s.concat(a.getChildren().slice())),a._id===e._id&&(o=r);s.length>0&&s[0].getDepth()<=t&&l(s)}const c=this.getStage();return e.nodeType!==u0&&c&&l(c.getChildren()),n}getDepth(){let t=0,e=this.parent;for(;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Ce),this._clearSelfAndDescendantCache(de)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const e=t.getPointerPosition();if(!e)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(e)}getAbsolutePosition(t){let e=!1,n=this.parent;for(;n;){if(n.isCached()){e=!0;break}n=n.parent}e&&!t&&(t=!0);const s=this.getAbsoluteTransform(t).getMatrix(),r=new zt,o=this.offset();return r.m=s.slice(),r.translate(o.x,o.y),r.getTranslation()}setAbsolutePosition(t){const{x:e,y:n,...s}=this._clearTransform();this.attrs.x=e,this.attrs.y=n,this._clearCache(Ce);const r=this._getAbsoluteTransform().copy();return r.invert(),r.translate(t.x,t.y),t={x:this.attrs.x+r.getTranslation().x,y:this.attrs.y+r.getTranslation().y},this._setTransform(s),this.setPosition({x:t.x,y:t.y}),this._clearCache(Ce),this._clearSelfAndDescendantCache(de),this}_setTransform(t){let e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let e=t.x,n=t.y,s=this.x(),r=this.y();return e!==void 0&&(s+=e),n!==void 0&&(r+=n),this.setPosition({x:s,y:r}),this}_eachAncestorReverse(t,e){let n=[],s=this.getParent(),r,o;if(!(e&&e._id===this._id)){for(n.unshift(this);s&&(!e||s._id!==e._id);)n.unshift(s),s=s.parent;for(r=n.length,o=0;o<r;o++)t(n[o])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return x.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return x.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return x.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return x.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return x.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&x.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(xn,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),e,n,s,r,o;const a={attrs:{},className:this.getClassName()};for(e in t)n=t[e],o=x.isObject(n)&&!x._isPlainObject(n)&&!x._isArray(n),!o&&(s=typeof this[e]=="function"&&this[e],delete t[e],r=s?s.call(this):null,t[e]=n,r!==n&&(a.attrs[e]=n));return x._prepareToStringify(a)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,n){const s=[];e&&this._isMatch(t)&&s.push(this);let r=this.parent;for(;r;){if(r===n)return s;r._isMatch(t)&&s.push(r),r=r.parent}return s}isAncestorOf(t){return!1}findAncestor(t,e,n){return this.findAncestors(t,e,n)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let e=t.replace(/ /g,"").split(","),n=e.length,s,r;for(s=0;s<n;s++)if(r=e[s],x.isValidSelector(r)||(x.warn('Selector "'+r+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),x.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),x.warn("Konva is awesome, right?")),r.charAt(0)==="#"){if(this.id()===r.slice(1))return!0}else if(r.charAt(0)==="."){if(this.hasName(r.slice(1)))return!0}else if(this.className===r||this.nodeType===r)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(Kr,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,e={},n){return e.target=e.target||this,n?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(de,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let e;if(t)return e=new zt,this._eachAncestorReverse(function(n){const s=n.transformsEnabled();s==="all"?e.multiply(n.getTransform()):s==="position"&&e.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),e;{e=this._cache.get(de)||new zt,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();const n=this.transformsEnabled();if(n==="all")e.multiply(this.getTransform());else if(n==="position"){const s=this.attrs.x||0,r=this.attrs.y||0,o=this.attrs.offsetX||0,a=this.attrs.offsetY||0;e.translate(s-o,r-a)}return e.dirty=!1,e}}getAbsoluteScale(t){let e=this;for(;e;)e._isUnderCache&&(t=e),e=e.getParent();const s=this.getAbsoluteTransform(t).decompose();return{x:s.scaleX,y:s.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Ce,this._getTransform)}_getTransform(){var t,e;const n=this._cache.get(Ce)||new zt;n.reset();const s=this.x(),r=this.y(),o=B.getAngle(this.rotation()),a=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,l=(e=this.attrs.scaleY)!==null&&e!==void 0?e:1,c=this.attrs.skewX||0,h=this.attrs.skewY||0,d=this.attrs.offsetX||0,f=this.attrs.offsetY||0;return(s!==0||r!==0)&&n.translate(s,r),o!==0&&n.rotate(o),(c!==0||h!==0)&&n.skew(c,h),(a!==1||l!==1)&&n.scale(a,l),(d!==0||f!==0)&&n.translate(-1*d,-1*f),n.dirty=!1,n}clone(t){let e=x.cloneObject(this.attrs),n,s,r,o,a;for(n in t)e[n]=t[n];const l=new this.constructor(e);for(n in this.eventListeners)for(s=this.eventListeners[n],r=s.length,o=0;o<r;o++)a=s[o],a.name.indexOf(o0)<0&&(l.eventListeners[n]||(l.eventListeners[n]=[]),l.eventListeners[n].push(a));return l}_toKonvaCanvas(t){t=t||{};const e=this.getClientRect(),n=this.getStage(),s=t.x!==void 0?t.x:Math.floor(e.x),r=t.y!==void 0?t.y:Math.floor(e.y),o=t.pixelRatio||1,a=new Re({width:t.width||Math.ceil(e.width)||(n?n.width():0),height:t.height||Math.ceil(e.height)||(n?n.height():0),pixelRatio:o}),l=a.getContext(),c=new Re({width:a.width/a.pixelRatio+Math.abs(s),height:a.height/a.pixelRatio+Math.abs(r),pixelRatio:a.pixelRatio});return t.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(s||r)&&l.translate(-1*s,-1*r),this.drawScene(a,void 0,c),l.restore(),a}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const e=t.mimeType||null,n=t.quality||null,s=this._toKonvaCanvas(t).toDataURL(e,n);return t.callback&&t.callback(s),s}toImage(t){return new Promise((e,n)=>{try{const s=t?.callback;s&&delete t.callback,x._urlToImage(this.toDataURL(t),function(r){e(r),s?.(r)})}catch(s){n(s)}})}toBlob(t){return new Promise((e,n)=>{try{const s=t?.callback;s&&delete t.callback,this.toCanvas(t).toBlob(r=>{e(r),s?.(r)},t?.mimeType,t?.quality)}catch(s){n(s)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():B.dragDistance}_off(t,e,n){let s=this.eventListeners[t],r,o,a;for(r=0;r<s.length;r++)if(o=s[r].name,a=s[r].handler,(o!=="konva"||e==="konva")&&(!e||o===e)&&(!n||n===a)){if(s.splice(r,1),s.length===0){delete this.eventListeners[t];break}r--}}_fireChangeEvent(t,e,n){this._fire(t+s0,{oldVal:e,newVal:n})}addName(t){if(!this.hasName(t)){const e=this.name(),n=e?e+" "+t:t;this.name(n)}return this}hasName(t){if(!t)return!1;const e=this.name();return e?(e||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const e=(this.name()||"").split(/\s/g),n=e.indexOf(t);return n!==-1&&(e.splice(n,1),this.name(e.join(" "))),this}setAttr(t,e){const n=this[Yr+x._capitalize(t)];return x._isFunction(n)?n.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(B.autoDrawEnabled){const t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,e){const n=this.attrs[t];n===e&&!x.isObject(e)||(e==null?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,n,e),this._requestDraw())}_setComponentAttr(t,e,n){let s;n!==void 0&&(s=this.attrs[t],s||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=n,this._fireChangeEvent(t,s,n))}_fireAndBubble(t,e,n){e&&this.nodeType===jr&&(e.target=this);const s=[a0,l0,h0,c0,d0,f0];if(!(s.indexOf(t)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(t,e);const o=s.indexOf(t)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!o&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,e,n):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){var e,n;const{nodeType:s}=this,r=L.protoListenerMap.get(s)||{};let o=r?.[t];if(o===void 0){o=[];let a=Object.getPrototypeOf(this);for(;a;){const l=(n=(e=a.eventListeners)===null||e===void 0?void 0:e[t])!==null&&n!==void 0?n:[];o.push(...l),a=Object.getPrototypeOf(a)}r[t]=o,L.protoListenerMap.set(s,r)}return o}_fire(t,e){e=e||{},e.currentTarget=this,e.type=t;const n=this._getProtoListeners(t);if(n)for(let r=0;r<n.length;r++)n[r].handler.call(this,e);const s=this.eventListeners[t];if(s)for(let r=0;r<s.length;r++)s[r].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const e=t?t.pointerId:void 0,n=this.getStage(),s=this.getAbsolutePosition();if(!n)return;const r=n._getPointerById(e)||n._changedPointerPositions[0]||s;ht._dragElements.set(this._id,{node:this,startPointerPos:r,offset:{x:r.x-s.x,y:r.y-s.y},dragStatus:"ready",pointerId:e})}startDrag(t,e=!0){ht._dragElements.has(this._id)||this._createDragElement(t);const n=ht._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const n=this.getStage()._getPointerById(e.pointerId);if(!n)return;let s={x:n.x-e.offset.x,y:n.y-e.offset.y};const r=this.dragBoundFunc();if(r!==void 0){const o=r.call(this,s,t);o?s=o:x.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==s.x||this._lastPos.y!==s.y)&&(this.setAbsolutePosition(s),this._requestDraw()),this._lastPos=s}stopDrag(t){const e=ht._dragElements.get(this._id);e&&(e.dragStatus="stopped"),ht._endDragBefore(t),ht._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=ht._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||B.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let s=!1;ht._dragElements.forEach(r=>{this.isAncestorOf(r.node)&&(s=!0)}),s||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const e=ht._dragElements.get(this._id),n=e&&e.dragStatus==="dragging",s=e&&e.dragStatus==="ready";n?this.stopDrag():s&&ht._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const n={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return x.haveIntersection(n,this.getClientRect())}static create(t,e){return x._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){let n=L.prototype.getClassName.call(t),s=t.children,r,o,a;e&&(t.attrs.container=e),B[n]||(x.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const l=B[n];if(r=new l(t.attrs),s)for(o=s.length,a=0;a<o;a++)r.add(L._createNode(s[a]));return r}}L.protoListenerMap=new Map;L.prototype.nodeType="Node";L.prototype._attrsAffectingSize=[];L.prototype.eventListeners={};L.prototype.on.call(L.prototype,g0,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Ce),this._clearSelfAndDescendantCache(de)});L.prototype.on.call(L.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Ts)});L.prototype.on.call(L.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(ws)});L.prototype.on.call(L.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(xn)});const ut=p.addGetterSetter;ut(L,"zIndex");ut(L,"absolutePosition");ut(L,"position");ut(L,"x",0,G());ut(L,"y",0,G());ut(L,"globalCompositeOperation","source-over",Ve());ut(L,"opacity",1,G());ut(L,"name","",Ve());ut(L,"id","",Ve());ut(L,"rotation",0,G());p.addComponentsGetterSetter(L,"scale",["x","y"]);ut(L,"scaleX",1,G());ut(L,"scaleY",1,G());p.addComponentsGetterSetter(L,"skew",["x","y"]);ut(L,"skewX",0,G());ut(L,"skewY",0,G());p.addComponentsGetterSetter(L,"offset",["x","y"]);ut(L,"offsetX",0,G());ut(L,"offsetY",0,G());ut(L,"dragDistance",void 0,G());ut(L,"width",0,G());ut(L,"height",0,G());ut(L,"listening",!0,Qt());ut(L,"preventDefault",!0,Qt());ut(L,"filters",void 0,function(i){return this._filterUpToDate=!1,i});ut(L,"visible",!0,Qt());ut(L,"transformsEnabled","all",Ve());ut(L,"size");ut(L,"dragBoundFunc");ut(L,"draggable",!1,Qt());p.backCompat(L,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class Yt extends L{constructor(){super(...arguments),this.children=[]}getChildren(t){const e=this.children||[];return t?e.filter(t):e}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let n=0;n<t.length;n++)this.add(t[n]);return this}const e=t[0];return e.getParent()?(e.moveTo(this),this):(this._validateAdd(e),e.index=this.getChildren().length,e.parent=this,e._clearCaches(),this.getChildren().push(e),this._fire("add",{child:e}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){const n=[];return this._descendants(s=>{const r=s._isMatch(t);return r&&n.push(s),!!(r&&e)}),n}_descendants(t){let e=!1;const n=this.getChildren();for(const s of n){if(e=t(s),e)return!0;if(s.hasChildren()&&(e=s._descendants(t),e))return!0}return!1}toObject(){const t=L.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(e=>{t.children.push(e.toObject())}),t}isAncestorOf(t){let e=t.getParent();for(;e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){const e=L.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){e.add(n.clone())}),e}getAllIntersections(t){const e=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&e.push(n)}),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),!this.isCached()&&((e=this.children)===null||e===void 0||e.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(e,n){e.index=n}),this._requestDraw()}drawScene(t,e,n){const s=this.getLayer(),r=t||s&&s.getCanvas(),o=r&&r.getContext(),a=this._getCanvasCache(),l=a&&a.scene,c=r&&r.isCache;if(!this.isVisible()&&!c)return this;if(l){o.save();const h=this.getAbsoluteTransform(e).getMatrix();o.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedSceneCanvas(o),o.restore()}else this._drawChildren("drawScene",r,e,n);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;const n=this.getLayer(),s=t||n&&n.hitCanvas,r=s&&s.getContext(),o=this._getCanvasCache();if(o&&o.hit){r.save();const l=this.getAbsoluteTransform(e).getMatrix();r.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(r),r.restore()}else this._drawChildren("drawHit",s,e);return this}_drawChildren(t,e,n,s){var r;const o=e&&e.getContext(),a=this.clipWidth(),l=this.clipHeight(),c=this.clipFunc(),h=typeof a=="number"&&typeof l=="number"||c,d=n===this;if(h){o.save();const g=this.getAbsoluteTransform(n);let u=g.getMatrix();o.transform(u[0],u[1],u[2],u[3],u[4],u[5]),o.beginPath();let _;if(c)_=c.call(this,o,this);else{const C=this.clipX(),b=this.clipY();o.rect(C||0,b||0,a,l)}o.clip.apply(o,_),u=g.copy().invert().getMatrix(),o.transform(u[0],u[1],u[2],u[3],u[4],u[5])}const f=!d&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";f&&(o.save(),o._applyGlobalCompositeOperation(this)),(r=this.children)===null||r===void 0||r.forEach(function(g){g[t](e,n,s)}),f&&o.restore(),h&&o.restore()}getClientRect(t={}){var e;const n=t.skipTransform,s=t.relativeTo;let r,o,a,l,c={x:1/0,y:1/0,width:0,height:0};const h=this;(e=this.children)===null||e===void 0||e.forEach(function(g){if(!g.visible())return;const u=g.getClientRect({relativeTo:h,skipShadow:t.skipShadow,skipStroke:t.skipStroke});u.width===0&&u.height===0||(r===void 0?(r=u.x,o=u.y,a=u.x+u.width,l=u.y+u.height):(r=Math.min(r,u.x),o=Math.min(o,u.y),a=Math.max(a,u.x+u.width),l=Math.max(l,u.y+u.height)))});const d=this.find("Shape");let f=!1;for(let g=0;g<d.length;g++)if(d[g]._isVisible(this)){f=!0;break}return f&&r!==void 0?c={x:r,y:o,width:a-r,height:l-o}:c={x:0,y:0,width:0,height:0},n?c:this._transformedRect(c,s)}}p.addComponentsGetterSetter(Yt,"clip",["x","y","width","height"]);p.addGetterSetter(Yt,"clipX",void 0,G());p.addGetterSetter(Yt,"clipY",void 0,G());p.addGetterSetter(Yt,"clipWidth",void 0,G());p.addGetterSetter(Yt,"clipHeight",void 0,G());p.addGetterSetter(Yt,"clipFunc");const Qi=new Map,Ta=B._global.PointerEvent!==void 0;function ns(i){return Qi.get(i)}function ir(i){return{evt:i,pointerId:i.pointerId}}function Pa(i,t){return Qi.get(i)===t}function Aa(i,t){Hi(i),t.getStage()&&(Qi.set(i,t),Ta&&t._fire("gotpointercapture",ir(new PointerEvent("gotpointercapture"))))}function Hi(i,t){const e=Qi.get(i);if(!e)return;const n=e.getStage();n&&n.content,Qi.delete(i),Ta&&e._fire("lostpointercapture",ir(new PointerEvent("lostpointercapture")))}const m0="Stage",_0="string",Xr="px",y0="mouseout",Ea="mouseleave",Ra="mouseover",Ma="mouseenter",ka="mousemove",Oa="mousedown",La="mouseup",Ei="pointermove",Ri="pointerdown",ri="pointerup",Mi="pointercancel",b0="lostpointercapture",hn="pointerout",ki="pointerleave",cn="pointerover",dn="pointerenter",Ps="contextmenu",Ia="touchstart",Ga="touchend",Da="touchmove",Fa="touchcancel",As="wheel",x0=5,v0=[[Ma,"_pointerenter"],[Oa,"_pointerdown"],[ka,"_pointermove"],[La,"_pointerup"],[Ea,"_pointerleave"],[Ia,"_pointerdown"],[Da,"_pointermove"],[Ga,"_pointerup"],[Fa,"_pointercancel"],[Ra,"_pointerover"],[As,"_wheel"],[Ps,"_contextmenu"],[Ri,"_pointerdown"],[Ei,"_pointermove"],[ri,"_pointerup"],[Mi,"_pointercancel"],[ki,"_pointerleave"],[b0,"_lostpointercapture"]],ss={mouse:{[hn]:y0,[ki]:Ea,[cn]:Ra,[dn]:Ma,[Ei]:ka,[Ri]:Oa,[ri]:La,[Mi]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[hn]:"touchout",[ki]:"touchleave",[cn]:"touchover",[dn]:"touchenter",[Ei]:Da,[Ri]:Ia,[ri]:Ga,[Mi]:Fa,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[hn]:hn,[ki]:ki,[cn]:cn,[dn]:dn,[Ei]:Ei,[Ri]:Ri,[ri]:ri,[Mi]:Mi,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Oi=i=>i.indexOf("pointer")>=0?"pointer":i.indexOf("touch")>=0?"touch":"mouse",ti=i=>{const t=Oi(i);if(t==="pointer")return B.pointerEventsEnabled&&ss.pointer;if(t==="touch")return ss.touch;if(t==="mouse")return ss.mouse};function Vr(i={}){return(i.clipFunc||i.clipWidth||i.clipHeight)&&x.warn("Stage does not support clipping. Please use clip for Layers or Groups."),i}const S0="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",Wi=[];class zn extends Yt{constructor(t){super(Vr(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),Wi.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Vr(this.attrs)}),this._checkVisibility()}_validateAdd(t){const e=t.getType()==="Layer",n=t.getType()==="FastLayer";e||n||x.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===_0){let e;if(t.charAt(0)==="."){const n=t.slice(1);t=document.getElementsByClassName(n)[0]}else t.charAt(0)!=="#"?e=t:e=t.slice(1),t=document.getElementById(e);if(!t)throw"Can not find container in document with id "+e}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,e=t.length;for(let n=0;n<e;n++)t[n].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),Yt.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&x._isInDocument(t)&&this.container().removeChild(t);const e=Wi.indexOf(this);return e>-1&&Wi.splice(e,1),x.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(x.warn(S0),null)}_getPointerById(t){return this._pointerPositions.find(e=>e.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const e=new Re({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),n=e.getContext()._context,s=this.children;return(t.x||t.y)&&n.translate(-1*t.x,-1*t.y),s.forEach(function(r){if(!r.isVisible())return;const o=r._toKonvaCanvas(t);n.drawImage(o._canvas,t.x,t.y,o.getWidth()/o.getPixelRatio(),o.getHeight()/o.getPixelRatio())}),e}getIntersection(t){if(!t)return null;const e=this.children,n=e.length,s=n-1;for(let r=s;r>=0;r--){const o=e[r].getIntersection(t);if(o)return o}return null}_resizeDOM(){const t=this.width(),e=this.height();this.content&&(this.content.style.width=t+Xr,this.content.style.height=e+Xr),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach(n=>{n.setSize({width:t,height:e}),n.draw()})}add(t,...e){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.add(arguments[s]);return this}super.add(t);const n=this.children.length;return n>x0&&x.warn("The stage has "+n+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),B.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return Pa(t,this)}setPointerCapture(t){Aa(t,this)}releaseCapture(t){Hi(t)}getLayers(){return this.children}_bindContentEvents(){B.isBrowser&&v0.forEach(([t,e])=>{this.content.addEventListener(t,n=>{this[e](n)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const e=ti(t.type);e&&this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const e=ti(t.type);e&&this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){const e=ti(t.type),n=Oi(t.type);if(!e)return;this.setPointersPositions(t);const s=this._getTargetShape(n),r=!(B.isDragging()||B.isTransforming())||B.hitOnDragEnabled;s&&r?(s._fireAndBubble(e.pointerout,{evt:t}),s._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[n+"targetShape"]=null):r&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const e=ti(t.type),n=Oi(t.type);if(!e)return;this.setPointersPositions(t);let s=!1;this._changedPointerPositions.forEach(r=>{const o=this.getIntersection(r);if(ht.justDragged=!1,B["_"+n+"ListenClick"]=!0,!o||!o.isListening()){this[n+"ClickStartShape"]=void 0;return}B.capturePointerEventsEnabled&&o.setPointerCapture(r.id),this[n+"ClickStartShape"]=o,o._fireAndBubble(e.pointerdown,{evt:t,pointerId:r.id}),s=!0;const a=t.type.indexOf("touch")>=0;o.preventDefault()&&t.cancelable&&a&&t.preventDefault()}),s||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const e=ti(t.type),n=Oi(t.type);if(!e)return;const s=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(B.isDragging()&&ht.node.preventDefault()&&t.cancelable&&s&&t.preventDefault(),this.setPointersPositions(t),!(!(B.isDragging()||B.isTransforming())||B.hitOnDragEnabled))return;const o={};let a=!1;const l=this._getTargetShape(n);this._changedPointerPositions.forEach(c=>{const h=ns(c.id)||this.getIntersection(c),d=c.id,f={evt:t,pointerId:d},g=l!==h;if(g&&l&&(l._fireAndBubble(e.pointerout,{...f},h),l._fireAndBubble(e.pointerleave,{...f},h)),h){if(o[h._id])return;o[h._id]=!0}h&&h.isListening()?(a=!0,g&&(h._fireAndBubble(e.pointerover,{...f},l),h._fireAndBubble(e.pointerenter,{...f},l),this[n+"targetShape"]=h),h._fireAndBubble(e.pointermove,{...f})):l&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:d}),this[n+"targetShape"]=null)}),a||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const e=ti(t.type),n=Oi(t.type);if(!e)return;this.setPointersPositions(t);const s=this[n+"ClickStartShape"],r=this[n+"ClickEndShape"],o={};let a=!1;this._changedPointerPositions.forEach(l=>{const c=ns(l.id)||this.getIntersection(l);if(c){if(c.releaseCapture(l.id),o[c._id])return;o[c._id]=!0}const h=l.id,d={evt:t,pointerId:h};let f=!1;B["_"+n+"InDblClickWindow"]?(f=!0,clearTimeout(this[n+"DblTimeout"])):ht.justDragged||(B["_"+n+"InDblClickWindow"]=!0,clearTimeout(this[n+"DblTimeout"])),this[n+"DblTimeout"]=setTimeout(function(){B["_"+n+"InDblClickWindow"]=!1},B.dblClickWindow),c&&c.isListening()?(a=!0,this[n+"ClickEndShape"]=c,c._fireAndBubble(e.pointerup,{...d}),B["_"+n+"ListenClick"]&&s&&s===c&&(c._fireAndBubble(e.pointerclick,{...d}),f&&r&&r===c&&c._fireAndBubble(e.pointerdblclick,{...d}))):(this[n+"ClickEndShape"]=null,a||(this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),a=!0),B["_"+n+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:h}),f&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:h}))}),a||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),B["_"+n+"ListenClick"]=!1,t.cancelable&&n!=="touch"&&n!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(Ps,{evt:t}):this._fire(Ps,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(As,{evt:t}):this._fire(As,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const e=ns(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(ri,ir(t)),Hi(t.pointerId)}_lostpointercapture(t){Hi(t.pointerId)}setPointersPositions(t){const e=this._getContentPosition();let n=null,s=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,r=>{this._pointerPositions.push({id:r.identifier,x:(r.clientX-e.left)/e.scaleX,y:(r.clientY-e.top)/e.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,r=>{this._changedPointerPositions.push({id:r.identifier,x:(r.clientX-e.left)/e.scaleX,y:(r.clientY-e.top)/e.scaleY})})):(n=(t.clientX-e.left)/e.scaleX,s=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:n,y:s},this._pointerPositions=[{x:n,y:s,id:x._getFirstPointerId(t)}],this._changedPointerPositions=[{x:n,y:s,id:x._getFirstPointerId(t)}])}_setPointerPosition(t){x.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new Re({width:this.width(),height:this.height()}),this.bufferHitCanvas=new tr({pixelRatio:1,width:this.width(),height:this.height()}),!B.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return x.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}}zn.prototype.nodeType=m0;St(zn);p.addGetterSetter(zn,"container");B.isBrowser&&document.addEventListener("visibilitychange",()=>{Wi.forEach(i=>{i.batchDraw()})});const Na="hasShadow",Ba="shadowRGBA",Ha="patternImage",Wa="linearGradient",za="radialGradient";let fn;function rs(){return fn||(fn=x.createCanvasElement().getContext("2d"),fn)}const zi={};function C0(i){const t=this.attrs.fillRule;t?i.fill(t):i.fill()}function w0(i){i.stroke()}function T0(i){const t=this.attrs.fillRule;t?i.fill(t):i.fill()}function P0(i){i.stroke()}function A0(){this._clearCache(Na)}function E0(){this._clearCache(Ba)}function R0(){this._clearCache(Ha)}function M0(){this._clearCache(Wa)}function k0(){this._clearCache(za)}class E extends L{constructor(t){super(t);let e,n=0;for(;e=x.getHitColor(),!(e&&!(e in zi));)if(n++,n>=1e4){x.warn("Failed to find a unique color key for a shape. Konva may work incorrectly. Most likely your browser is using canvas farbling. Consider disabling it."),e=x.getRandomColor();break}this.colorKey=e,zi[e]=this}getContext(){return x.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return x.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(Na,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(Ha,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const e=rs().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(e&&e.setTransform){const n=new zt;n.translate(this.fillPatternX(),this.fillPatternY()),n.rotate(B.getAngle(this.fillPatternRotation())),n.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),n.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const s=n.getMatrix(),r=typeof DOMMatrix>"u"?{a:s[0],b:s[1],c:s[2],d:s[3],e:s[4],f:s[5]}:new DOMMatrix(s);e.setTransform(r)}return e}}_getLinearGradient(){return this._getCache(Wa,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const e=rs(),n=this.fillLinearGradientStartPoint(),s=this.fillLinearGradientEndPoint(),r=e.createLinearGradient(n.x,n.y,s.x,s.y);for(let o=0;o<t.length;o+=2)r.addColorStop(t[o],t[o+1]);return r}}_getRadialGradient(){return this._getCache(za,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const e=rs(),n=this.fillRadialGradientStartPoint(),s=this.fillRadialGradientEndPoint(),r=e.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),s.x,s.y,this.fillRadialGradientEndRadius());for(let o=0;o<t.length;o+=2)r.addColorStop(t[o],t[o+1]);return r}}getShadowRGBA(){return this._getCache(Ba,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=x.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const e=this.getStage();if(!e)return!1;const n=e.bufferHitCanvas;return n.getContext().clear(),this.drawHit(n,void 0,!0),n.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return L.prototype.destroy.call(this),delete zi[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;if(!((e=this.attrs.perfectDrawEnabled)!==null&&e!==void 0?e:!0))return!1;const s=t||this.hasFill(),r=this.hasStroke(),o=this.getAbsoluteOpacity()!==1;if(s&&r&&o)return!0;const a=this.hasShadow(),l=this.shadowForStrokeEnabled();return!!(s&&r&&a&&l)}setStrokeHitEnabled(t){x.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let e=!1,n=this.getParent();for(;n;){if(n.isCached()){e=!0;break}n=n.getParent()}const s=t.skipTransform,r=t.relativeTo||e&&this.getStage()||void 0,o=this.getSelfRect(),l=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,c=o.width+l,h=o.height+l,d=!t.skipShadow&&this.hasShadow(),f=d?this.shadowOffsetX():0,g=d?this.shadowOffsetY():0,u=c+Math.abs(f),_=h+Math.abs(g),C=d&&this.shadowBlur()||0,b=u+C*2,v=_+C*2,w={width:b,height:v,x:-(l/2+C)+Math.min(f,0)+o.x,y:-(l/2+C)+Math.min(g,0)+o.y};return s?w:this._transformedRect(w,r)}drawScene(t,e,n){const s=this.getLayer(),r=t||s.getCanvas(),o=r.getContext(),a=this._getCanvasCache(),l=this.getSceneFunc(),c=this.hasShadow();let h;const d=e===this;if(!this.isVisible()&&!d)return this;if(a){o.save();const f=this.getAbsoluteTransform(e).getMatrix();return o.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(o),o.restore(),this}if(!l)return this;if(o.save(),this._useBufferCanvas()){h=this.getStage();const f=n||h.bufferCanvas,g=f.getContext();n?(g.save(),g.setTransform(1,0,0,1,0,0),g.clearRect(0,0,f.width,f.height),g.restore()):g.clear(),g.save(),g._applyLineJoin(this),g._applyMiterLimit(this);const u=this.getAbsoluteTransform(e).getMatrix();g.transform(u[0],u[1],u[2],u[3],u[4],u[5]),l.call(this,g,this),g.restore();const _=f.pixelRatio;c&&o._applyShadow(this),d||(o._applyOpacity(this),o._applyGlobalCompositeOperation(this)),o.drawImage(f._canvas,f.x||0,f.y||0,f.width/_,f.height/_)}else{if(o._applyLineJoin(this),o._applyMiterLimit(this),!d){const f=this.getAbsoluteTransform(e).getMatrix();o.transform(f[0],f[1],f[2],f[3],f[4],f[5]),o._applyOpacity(this),o._applyGlobalCompositeOperation(this)}c&&o._applyShadow(this),l.call(this,o,this)}return o.restore(),this}drawHit(t,e,n=!1){if(!this.shouldDrawHit(e,n))return this;const s=this.getLayer(),r=t||s.hitCanvas,o=r&&r.getContext(),a=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),c=l&&l.hit;if(this.colorKey||x.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),c){o.save();const d=this.getAbsoluteTransform(e).getMatrix();return o.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedHitCanvas(o),o.restore(),this}if(!a)return this;if(o.save(),o._applyLineJoin(this),o._applyMiterLimit(this),!(this===e)){const d=this.getAbsoluteTransform(e).getMatrix();o.transform(d[0],d[1],d[2],d[3],d[4],d[5])}return a.call(this,o,this),o.restore(),this}drawHitFromCache(t=0){const e=this._getCanvasCache(),n=this._getCachedSceneCanvas(),s=e.hit,r=s.getContext(),o=s.getWidth(),a=s.getHeight();r.clear(),r.drawImage(n._canvas,0,0,o,a);try{const l=r.getImageData(0,0,o,a),c=l.data,h=c.length,d=x._hexToRgb(this.colorKey);for(let f=0;f<h;f+=4)c[f+3]>t?(c[f]=d.r,c[f+1]=d.g,c[f+2]=d.b,c[f+3]=255):c[f+3]=0;r.putImageData(l,0,0)}catch(l){x.error("Unable to draw hit graph from cached scene canvas. "+l.message)}return this}hasPointerCapture(t){return Pa(t,this)}setPointerCapture(t){Aa(t,this)}releaseCapture(t){Hi(t)}}E.prototype._fillFunc=C0;E.prototype._strokeFunc=w0;E.prototype._fillFuncHit=T0;E.prototype._strokeFuncHit=P0;E.prototype._centroid=!1;E.prototype.nodeType="Shape";St(E);E.prototype.eventListeners={};E.prototype.on.call(E.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",A0);E.prototype.on.call(E.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",E0);E.prototype.on.call(E.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",R0);E.prototype.on.call(E.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",M0);E.prototype.on.call(E.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",k0);p.addGetterSetter(E,"stroke",void 0,wa());p.addGetterSetter(E,"strokeWidth",2,G());p.addGetterSetter(E,"fillAfterStrokeEnabled",!1);p.addGetterSetter(E,"hitStrokeWidth","auto",er());p.addGetterSetter(E,"strokeHitEnabled",!0,Qt());p.addGetterSetter(E,"perfectDrawEnabled",!0,Qt());p.addGetterSetter(E,"shadowForStrokeEnabled",!0,Qt());p.addGetterSetter(E,"lineJoin");p.addGetterSetter(E,"lineCap");p.addGetterSetter(E,"miterLimit");p.addGetterSetter(E,"sceneFunc");p.addGetterSetter(E,"hitFunc");p.addGetterSetter(E,"dash");p.addGetterSetter(E,"dashOffset",0,G());p.addGetterSetter(E,"shadowColor",void 0,Ve());p.addGetterSetter(E,"shadowBlur",0,G());p.addGetterSetter(E,"shadowOpacity",1,G());p.addComponentsGetterSetter(E,"shadowOffset",["x","y"]);p.addGetterSetter(E,"shadowOffsetX",0,G());p.addGetterSetter(E,"shadowOffsetY",0,G());p.addGetterSetter(E,"fillPatternImage");p.addGetterSetter(E,"fill",void 0,wa());p.addGetterSetter(E,"fillPatternX",0,G());p.addGetterSetter(E,"fillPatternY",0,G());p.addGetterSetter(E,"fillLinearGradientColorStops");p.addGetterSetter(E,"strokeLinearGradientColorStops");p.addGetterSetter(E,"fillRadialGradientStartRadius",0);p.addGetterSetter(E,"fillRadialGradientEndRadius",0);p.addGetterSetter(E,"fillRadialGradientColorStops");p.addGetterSetter(E,"fillPatternRepeat","repeat");p.addGetterSetter(E,"fillEnabled",!0);p.addGetterSetter(E,"strokeEnabled",!0);p.addGetterSetter(E,"shadowEnabled",!0);p.addGetterSetter(E,"dashEnabled",!0);p.addGetterSetter(E,"strokeScaleEnabled",!0);p.addGetterSetter(E,"fillPriority","color");p.addComponentsGetterSetter(E,"fillPatternOffset",["x","y"]);p.addGetterSetter(E,"fillPatternOffsetX",0,G());p.addGetterSetter(E,"fillPatternOffsetY",0,G());p.addComponentsGetterSetter(E,"fillPatternScale",["x","y"]);p.addGetterSetter(E,"fillPatternScaleX",1,G());p.addGetterSetter(E,"fillPatternScaleY",1,G());p.addComponentsGetterSetter(E,"fillLinearGradientStartPoint",["x","y"]);p.addComponentsGetterSetter(E,"strokeLinearGradientStartPoint",["x","y"]);p.addGetterSetter(E,"fillLinearGradientStartPointX",0);p.addGetterSetter(E,"strokeLinearGradientStartPointX",0);p.addGetterSetter(E,"fillLinearGradientStartPointY",0);p.addGetterSetter(E,"strokeLinearGradientStartPointY",0);p.addComponentsGetterSetter(E,"fillLinearGradientEndPoint",["x","y"]);p.addComponentsGetterSetter(E,"strokeLinearGradientEndPoint",["x","y"]);p.addGetterSetter(E,"fillLinearGradientEndPointX",0);p.addGetterSetter(E,"strokeLinearGradientEndPointX",0);p.addGetterSetter(E,"fillLinearGradientEndPointY",0);p.addGetterSetter(E,"strokeLinearGradientEndPointY",0);p.addComponentsGetterSetter(E,"fillRadialGradientStartPoint",["x","y"]);p.addGetterSetter(E,"fillRadialGradientStartPointX",0);p.addGetterSetter(E,"fillRadialGradientStartPointY",0);p.addComponentsGetterSetter(E,"fillRadialGradientEndPoint",["x","y"]);p.addGetterSetter(E,"fillRadialGradientEndPointX",0);p.addGetterSetter(E,"fillRadialGradientEndPointY",0);p.addGetterSetter(E,"fillPatternRotation",0);p.addGetterSetter(E,"fillRule",void 0,Ve());p.backCompat(E,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const O0="beforeDraw",L0="draw",Ua=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],I0=Ua.length;class $e extends Yt{constructor(t){super(t),this.canvas=new Re,this.hitCanvas=new tr({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){L.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!L.prototype.moveUp.call(this))return!1;const e=this.getStage();return!e||!e.content?!1:(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(L.prototype.moveDown.call(this)){const t=this.getStage();if(t){const e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(L.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return L.prototype.remove.call(this),t&&t.parentNode&&x._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){const e=t.getType();e!=="Group"&&e!=="Shape"&&x.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),L.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){x.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){x.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,x.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let e=1,n=!1;for(;;){for(let s=0;s<I0;s++){const r=Ua[s],o=this._getIntersection({x:t.x+r.x*e,y:t.y+r.y*e}),a=o.shape;if(a)return a;if(n=!!o.antialiased,!o.antialiased)break}if(n)e+=1;else return null}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,s=n[3];if(s===255){const r=x.getHitColorKey(n[0],n[1],n[2]),o=zi[r];return o?{shape:o}:{antialiased:!0}}else if(s>0)return{antialiased:!0};return{}}drawScene(t,e,n){const s=this.getLayer(),r=t||s&&s.getCanvas();return this._fire(O0,{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),Yt.prototype.drawScene.call(this,r,e,n),this._fire(L0,{node:this}),this}drawHit(t,e){const n=this.getLayer(),s=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),Yt.prototype.drawHit.call(this,s,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){x.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return x.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return x.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}$e.prototype.nodeType="Layer";St($e);p.addGetterSetter($e,"imageSmoothingEnabled",!0);p.addGetterSetter($e,"clearBeforeDraw",!0);p.addGetterSetter($e,"hitGraphEnabled",!0,Qt());class nr extends $e{constructor(t){super(t),this.listening(!1),x.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}nr.prototype.nodeType="FastLayer";St(nr);class fi extends Yt{_validateAdd(t){const e=t.getType();e!=="Group"&&e!=="Shape"&&x.throw("You may only add groups and shapes to groups.")}}fi.prototype.nodeType="Group";St(fi);const os=(function(){return Ye.performance&&Ye.performance.now?function(){return Ye.performance.now()}:function(){return new Date().getTime()}})();class Kt{constructor(t,e){this.id=Kt.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:os(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){let e=[];return t&&(e=Array.isArray(t)?t:[t]),this.layers=e,this}getLayers(){return this.layers}addLayer(t){const e=this.layers,n=e.length;for(let s=0;s<n;s++)if(e[s]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const e=Kt.animations,n=e.length;for(let s=0;s<n;s++)if(e[s].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=os(),Kt._addAnimation(this),this}stop(){return Kt._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const e=t.id,n=this.animations,s=n.length;for(let r=0;r<s;r++)if(n[r].id===e){this.animations.splice(r,1);break}}static _runFrames(){const t={},e=this.animations;for(let n=0;n<e.length;n++){const s=e[n],r=s.layers,o=s.func;s._updateFrameObject(os());const a=r.length;let l;if(o?l=o.call(s,s.frame)!==!1:l=!0,!!l)for(let c=0;c<a;c++){const h=r[c];h._id!==void 0&&(t[h._id]=h)}}for(const n in t)t.hasOwnProperty(n)&&t[n].batchDraw()}static _animationLoop(){const t=Kt;t.animations.length?(t._runFrames(),x.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,x.requestAnimFrame(this._animationLoop))}}Kt.animations=[];Kt.animIdCounter=0;Kt.animRunning=!1;const G0={node:1,duration:1,easing:1,onFinish:1,yoyo:1},D0=1,$r=2,qr=3,Qr=["fill","stroke","shadowColor"];let F0=0;class N0{constructor(t,e,n,s,r,o,a){this.prop=t,this.propFunc=e,this.begin=s,this._pos=s,this.duration=o,this._change=0,this.prevPos=0,this.yoyo=a,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=r-this.begin,this.pause()}fire(t){const e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=$r,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=qr,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===$r?this.setTime(t):this.state===qr&&this.setTime(this.duration-t)}pause(){this.state=D0,this.fire("onPause")}getTimer(){return new Date().getTime()}}class pt{constructor(t){const e=this,n=t.node,s=n._id,r=t.easing||Ui.Linear,o=!!t.yoyo;let a,l;typeof t.duration>"u"?a=.3:t.duration===0?a=.001:a=t.duration,this.node=n,this._id=F0++;const c=n.getLayer()||(n instanceof B.Stage?n.getLayers():null);c||x.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new Kt(function(){e.tween.onEnterFrame()},c),this.tween=new N0(l,function(h){e._tweenFunc(h)},r,0,1,a*1e3,o),this._addListeners(),pt.attrs[s]||(pt.attrs[s]={}),pt.attrs[s][this._id]||(pt.attrs[s][this._id]={}),pt.tweens[s]||(pt.tweens[s]={});for(l in t)G0[l]===void 0&&this._addAttr(l,t[l]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,e){const n=this.node,s=n._id;let r,o,a,l,c;const h=pt.tweens[s][t];h&&delete pt.attrs[s][h][t];let d=n.getAttr(t);if(x._isArray(e))if(r=[],o=Math.max(e.length,d.length),t==="points"&&e.length!==d.length&&(e.length>d.length?(l=d,d=x._prepareArrayForTween(d,e,n.closed())):(a=e,e=x._prepareArrayForTween(e,d,n.closed()))),t.indexOf("fill")===0)for(let f=0;f<o;f++)if(f%2===0)r.push(e[f]-d[f]);else{const g=x.colorToRGBA(d[f]);c=x.colorToRGBA(e[f]),d[f]=g,r.push({r:c.r-g.r,g:c.g-g.g,b:c.b-g.b,a:c.a-g.a})}else for(let f=0;f<o;f++)r.push(e[f]-d[f]);else Qr.indexOf(t)!==-1?(d=x.colorToRGBA(d),c=x.colorToRGBA(e),r={r:c.r-d.r,g:c.g-d.g,b:c.b-d.b,a:c.a-d.a}):r=e-d;pt.attrs[s][this._id][t]={start:d,diff:r,end:e,trueEnd:a,trueStart:l},pt.tweens[s][t]=this._id}_tweenFunc(t){const e=this.node,n=pt.attrs[e._id][this._id];let s,r,o,a,l,c,h,d;for(s in n){if(r=n[s],o=r.start,a=r.diff,d=r.end,x._isArray(o))if(l=[],h=Math.max(o.length,d.length),s.indexOf("fill")===0)for(c=0;c<h;c++)c%2===0?l.push((o[c]||0)+a[c]*t):l.push("rgba("+Math.round(o[c].r+a[c].r*t)+","+Math.round(o[c].g+a[c].g*t)+","+Math.round(o[c].b+a[c].b*t)+","+(o[c].a+a[c].a*t)+")");else for(c=0;c<h;c++)l.push((o[c]||0)+a[c]*t);else Qr.indexOf(s)!==-1?l="rgba("+Math.round(o.r+a.r*t)+","+Math.round(o.g+a.g*t)+","+Math.round(o.b+a.b*t)+","+(o.a+a.a*t)+")":l=o+a*t;e.setAttr(s,l)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,e=pt.attrs[t._id][this._id];e.points&&e.points.trueEnd&&t.setAttr("points",e.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,e=pt.attrs[t._id][this._id];e.points&&e.points.trueStart&&t.points(e.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,e=this._id,n=pt.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const s in n)delete pt.tweens[t][s];delete pt.attrs[t][e],pt.tweens[t]&&(Object.keys(pt.tweens[t]).length===0&&delete pt.tweens[t],Object.keys(pt.attrs[t]).length===0&&delete pt.attrs[t])}}pt.attrs={};pt.tweens={};L.prototype.to=function(i){const t=i.onFinish;i.node=this,i.onFinish=function(){this.destroy(),t&&t()},new pt(i).play()};const Ui={BackEaseIn(i,t,e,n){return e*(i/=n)*i*((1.70158+1)*i-1.70158)+t},BackEaseOut(i,t,e,n){return e*((i=i/n-1)*i*((1.70158+1)*i+1.70158)+1)+t},BackEaseInOut(i,t,e,n){let s=1.70158;return(i/=n/2)<1?e/2*(i*i*(((s*=1.525)+1)*i-s))+t:e/2*((i-=2)*i*(((s*=1.525)+1)*i+s)+2)+t},ElasticEaseIn(i,t,e,n,s,r){let o=0;return i===0?t:(i/=n)===1?t+e:(r||(r=n*.3),!s||s<Math.abs(e)?(s=e,o=r/4):o=r/(2*Math.PI)*Math.asin(e/s),-(s*Math.pow(2,10*(i-=1))*Math.sin((i*n-o)*(2*Math.PI)/r))+t)},ElasticEaseOut(i,t,e,n,s,r){let o=0;return i===0?t:(i/=n)===1?t+e:(r||(r=n*.3),!s||s<Math.abs(e)?(s=e,o=r/4):o=r/(2*Math.PI)*Math.asin(e/s),s*Math.pow(2,-10*i)*Math.sin((i*n-o)*(2*Math.PI)/r)+e+t)},ElasticEaseInOut(i,t,e,n,s,r){let o=0;return i===0?t:(i/=n/2)===2?t+e:(r||(r=n*(.3*1.5)),!s||s<Math.abs(e)?(s=e,o=r/4):o=r/(2*Math.PI)*Math.asin(e/s),i<1?-.5*(s*Math.pow(2,10*(i-=1))*Math.sin((i*n-o)*(2*Math.PI)/r))+t:s*Math.pow(2,-10*(i-=1))*Math.sin((i*n-o)*(2*Math.PI)/r)*.5+e+t)},BounceEaseOut(i,t,e,n){return(i/=n)<1/2.75?e*(7.5625*i*i)+t:i<2/2.75?e*(7.5625*(i-=1.5/2.75)*i+.75)+t:i<2.5/2.75?e*(7.5625*(i-=2.25/2.75)*i+.9375)+t:e*(7.5625*(i-=2.625/2.75)*i+.984375)+t},BounceEaseIn(i,t,e,n){return e-Ui.BounceEaseOut(n-i,0,e,n)+t},BounceEaseInOut(i,t,e,n){return i<n/2?Ui.BounceEaseIn(i*2,0,e,n)*.5+t:Ui.BounceEaseOut(i*2-n,0,e,n)*.5+e*.5+t},EaseIn(i,t,e,n){return e*(i/=n)*i+t},EaseOut(i,t,e,n){return-e*(i/=n)*(i-2)+t},EaseInOut(i,t,e,n){return(i/=n/2)<1?e/2*i*i+t:-e/2*(--i*(i-2)-1)+t},StrongEaseIn(i,t,e,n){return e*(i/=n)*i*i*i*i+t},StrongEaseOut(i,t,e,n){return e*((i=i/n-1)*i*i*i*i+1)+t},StrongEaseInOut(i,t,e,n){return(i/=n/2)<1?e/2*i*i*i*i*i+t:e/2*((i-=2)*i*i*i*i+2)+t},Linear(i,t,e,n){return e*i/n+t}},Jr=x._assign(B,{Util:x,Transform:zt,Node:L,Container:Yt,Stage:zn,stages:Wi,Layer:$e,FastLayer:nr,Group:fi,DD:ht,Shape:E,shapes:zi,Animation:Kt,Tween:pt,Easings:Ui,Context:Hn,Canvas:Zs});class be extends E{_sceneFunc(t){const e=B.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,n),t.arc(0,0,this.innerRadius(),e,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),e=this.outerRadius(),n=this.clockwise(),s=B.getAngle(n?360-this.angle():this.angle()),r=Math.cos(Math.min(s,Math.PI)),o=1,a=Math.sin(Math.min(Math.max(Math.PI,s),3*Math.PI/2)),l=Math.sin(Math.min(s,Math.PI/2)),c=r*(r>0?t:e),h=o*e,d=a*(a>0?t:e),f=l*(l>0?e:t);return{x:c,y:n?-1*f:d,width:h-c,height:f-d}}}be.prototype._centroid=!0;be.prototype.className="Arc";be.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];St(be);p.addGetterSetter(be,"innerRadius",0,G());p.addGetterSetter(be,"outerRadius",0,G());p.addGetterSetter(be,"angle",0,G());p.addGetterSetter(be,"clockwise",!1,Qt());function Es(i,t,e,n,s,r,o){const a=Math.sqrt(Math.pow(e-i,2)+Math.pow(n-t,2)),l=Math.sqrt(Math.pow(s-e,2)+Math.pow(r-n,2)),c=o*a/(a+l),h=o*l/(a+l),d=e-c*(s-i),f=n-c*(r-t),g=e+h*(s-i),u=n+h*(r-t);return[d,f,g,u]}function Zr(i,t){const e=i.length,n=[];for(let s=2;s<e-2;s+=2){const r=Es(i[s-2],i[s-1],i[s],i[s+1],i[s+2],i[s+3],t);isNaN(r[0])||(n.push(r[0]),n.push(r[1]),n.push(i[s]),n.push(i[s+1]),n.push(r[2]),n.push(r[3]))}return n}function B0(i){const t=[[i[0],i[2],i[4],i[6]],[i[1],i[3],i[5],i[7]]],e=[];for(const n of t){const s=-3*n[0]+9*n[1]-9*n[2]+3*n[3];if(s!==0){const r=6*n[0]-12*n[1]+6*n[2],o=-3*n[0]+3*n[1],a=r*r-4*s*o;if(a>=0){const l=Math.sqrt(a);e.push((-r+l)/(2*s)),e.push((-r-l)/(2*s))}}}return e.filter(n=>n>0&&n<1).flatMap(n=>t.map(s=>{const r=1-n;return r*r*r*s[0]+3*r*r*n*s[1]+3*r*n*n*s[2]+n*n*n*s[3]}))}class xe extends E{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const e=this.points(),n=e.length,s=this.tension(),r=this.closed(),o=this.bezier();if(!n)return;let a=0;if(t.beginPath(),t.moveTo(e[0],e[1]),s!==0&&n>4){const l=this.getTensionPoints(),c=l.length;for(a=r?0:4,r||t.quadraticCurveTo(l[0],l[1],l[2],l[3]);a<c-2;)t.bezierCurveTo(l[a++],l[a++],l[a++],l[a++],l[a++],l[a++]);r||t.quadraticCurveTo(l[c-2],l[c-1],e[n-2],e[n-1])}else if(o)for(a=2;a<n;)t.bezierCurveTo(e[a++],e[a++],e[a++],e[a++],e[a++],e[a++]);else for(a=2;a<n;a+=2)t.lineTo(e[a],e[a+1]);r?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Zr(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),e=t.length,n=this.tension(),s=Es(t[e-2],t[e-1],t[0],t[1],t[2],t[3],n),r=Es(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],n),o=Zr(t,n);return[s[2],s[3]].concat(o).concat([r[0],r[1],t[e-2],t[e-1],r[2],r[3],s[0],s[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:this.bezier()?t=[t[0],t[1],...B0(this.points()),t[t.length-2],t[t.length-1]]:t=this.points();let e=t[0],n=t[0],s=t[1],r=t[1],o,a;for(let l=0;l<t.length/2;l++)o=t[l*2],a=t[l*2+1],e=Math.min(e,o),n=Math.max(n,o),s=Math.min(s,a),r=Math.max(r,a);return{x:e,y:s,width:n-e,height:r-s}}}xe.prototype.className="Line";xe.prototype._attrsAffectingSize=["points","bezier","tension"];St(xe);p.addGetterSetter(xe,"closed",!1);p.addGetterSetter(xe,"bezier",!1);p.addGetterSetter(xe,"tension",0,G());p.addGetterSetter(xe,"points",[],e0());const H0=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],W0=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],z0=[[1],[1,1],[1,2,1],[1,3,3,1]],to=(i,t,e)=>{let n,s;const o=e/2;n=0;for(let a=0;a<20;a++)s=o*H0[20][a]+o,n+=W0[20][a]*U0(i,t,s);return o*n},eo=(i,t,e)=>{e===void 0&&(e=1);const n=i[0]-2*i[1]+i[2],s=t[0]-2*t[1]+t[2],r=2*i[1]-2*i[0],o=2*t[1]-2*t[0],a=4*(n*n+s*s),l=4*(n*r+s*o),c=r*r+o*o;if(a===0)return e*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(t[2]-t[0],2));const h=l/(2*a),d=c/a,f=e+h,g=d-h*h,u=f*f+g>0?Math.sqrt(f*f+g):0,_=h*h+g>0?Math.sqrt(h*h+g):0,C=h+Math.sqrt(h*h+g)!==0?g*Math.log(Math.abs((f+u)/(h+_))):0;return Math.sqrt(a)/2*(f*u-h*_+C)};function U0(i,t,e){const n=Rs(1,e,i),s=Rs(1,e,t),r=n*n+s*s;return Math.sqrt(r)}const Rs=(i,t,e)=>{const n=e.length-1;let s,r;if(n===0)return 0;if(i===0){r=0;for(let o=0;o<=n;o++)r+=z0[n][o]*Math.pow(1-t,n-o)*Math.pow(t,o)*e[o];return r}else{s=new Array(n);for(let o=0;o<n;o++)s[o]=n*(e[o+1]-e[o]);return Rs(i-1,t,s)}},io=(i,t,e)=>{let n=1,s=i/t,r=(i-e(s))/t,o=0;for(;n>.001;){const a=e(s+r),l=Math.abs(i-a)/t;if(l<n)n=l,s+=r;else{const c=e(s-r),h=Math.abs(i-c)/t;h<n?(n=h,s-=r):r/=2}if(o++,o>500)break}return s};class _t extends E{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=_t.parsePathData(this.data()),this.pathLength=_t.getPathLength(this.dataArray)}_sceneFunc(t){const e=this.dataArray;t.beginPath();let n=!1;for(let s=0;s<e.length;s++){const r=e[s].command,o=e[s].points;switch(r){case"L":t.lineTo(o[0],o[1]);break;case"M":t.moveTo(o[0],o[1]);break;case"C":t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":t.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":const a=o[0],l=o[1],c=o[2],h=o[3],d=o[4],f=o[5],g=o[6],u=o[7],_=c>h?c:h,C=c>h?1:c/h,b=c>h?h/c:1;t.translate(a,l),t.rotate(g),t.scale(C,b),t.arc(0,0,_,d,d+f,1-u),t.scale(1/C,1/b),t.rotate(-g),t.translate(-a,-l);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(l){if(l.command==="A"){const c=l.points[4],h=l.points[5],d=l.points[4]+h;let f=Math.PI/180;if(Math.abs(c-d)<f&&(f=Math.abs(c-d)),h<0)for(let g=c-f;g>d;g-=f){const u=_t.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],g,0);t.push(u.x,u.y)}else for(let g=c+f;g<d;g+=f){const u=_t.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],g,0);t.push(u.x,u.y)}}else if(l.command==="C")for(let c=0;c<=1;c+=.01){const h=_t.getPointOnCubicBezier(c,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);t.push(h.x,h.y)}else t=t.concat(l.points)});let e=t[0],n=t[0],s=t[1],r=t[1],o,a;for(let l=0;l<t.length/2;l++)o=t[l*2],a=t[l*2+1],isNaN(o)||(e=Math.min(e,o),n=Math.max(n,o)),isNaN(a)||(s=Math.min(s,a),r=Math.max(r,a));return{x:e,y:s,width:n-e,height:r-s}}getLength(){return this.pathLength}getPointAtLength(t){return _t.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,e,n,s){return Math.sqrt((n-t)*(n-t)+(s-e)*(s-e))}static getPathLength(t){let e=0;for(let n=0;n<t.length;++n)e+=t[n].pathLength;return e}static getPointAtLengthOfDataArray(t,e){let n,s=0,r=e.length;if(!r)return null;for(;s<r&&t>e[s].pathLength;)t-=e[s].pathLength,++s;if(s===r)return n=e[s-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return e[s].command==="M"?(n=e[s].points.slice(0,2),{x:n[0],y:n[1]}):{x:e[s].start.x,y:e[s].start.y};const o=e[s],a=o.points;switch(o.command){case"L":return _t.getPointOnLine(t,o.start.x,o.start.y,a[0],a[1]);case"C":return _t.getPointOnCubicBezier(io(t,_t.getPathLength(e),_=>to([o.start.x,a[0],a[2],a[4]],[o.start.y,a[1],a[3],a[5]],_)),o.start.x,o.start.y,a[0],a[1],a[2],a[3],a[4],a[5]);case"Q":return _t.getPointOnQuadraticBezier(io(t,_t.getPathLength(e),_=>eo([o.start.x,a[0],a[2]],[o.start.y,a[1],a[3]],_)),o.start.x,o.start.y,a[0],a[1],a[2],a[3]);case"A":const l=a[0],c=a[1],h=a[2],d=a[3],f=a[5],g=a[6];let u=a[4];return u+=f*t/o.pathLength,_t.getPointOnEllipticalArc(l,c,h,d,u,g)}return null}static getPointOnLine(t,e,n,s,r,o,a){o=o??e,a=a??n;const l=this.getLineLength(e,n,s,r);if(l<1e-10)return{x:e,y:n};if(s===e)return{x:o,y:a+(r>n?t:-t)};const c=(r-n)/(s-e),h=Math.sqrt(t*t/(1+c*c))*(s<e?-1:1),d=c*h;if(Math.abs(a-n-c*(o-e))<1e-10)return{x:o+h,y:a+d};const f=((o-e)*(s-e)+(a-n)*(r-n))/(l*l),g=e+f*(s-e),u=n+f*(r-n),_=this.getLineLength(o,a,g,u),C=Math.sqrt(t*t-_*_),b=Math.sqrt(C*C/(1+c*c))*(s<e?-1:1),v=c*b;return{x:g+b,y:u+v}}static getPointOnCubicBezier(t,e,n,s,r,o,a,l,c){function h(C){return C*C*C}function d(C){return 3*C*C*(1-C)}function f(C){return 3*C*(1-C)*(1-C)}function g(C){return(1-C)*(1-C)*(1-C)}const u=l*h(t)+o*d(t)+s*f(t)+e*g(t),_=c*h(t)+a*d(t)+r*f(t)+n*g(t);return{x:u,y:_}}static getPointOnQuadraticBezier(t,e,n,s,r,o,a){function l(g){return g*g}function c(g){return 2*g*(1-g)}function h(g){return(1-g)*(1-g)}const d=o*l(t)+s*c(t)+e*h(t),f=a*l(t)+r*c(t)+n*h(t);return{x:d,y:f}}static getPointOnEllipticalArc(t,e,n,s,r,o){const a=Math.cos(o),l=Math.sin(o),c={x:n*Math.cos(r),y:s*Math.sin(r)};return{x:t+(c.x*a-c.y*l),y:e+(c.x*l+c.y*a)}}static parsePathData(t){if(!t)return[];let e=t;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(let d=0;d<n.length;d++)e=e.replace(new RegExp(n[d],"g"),"|"+n[d]);const s=e.split("|"),r=[],o=[];let a=0,l=0;const c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let h;for(let d=1;d<s.length;d++){let f=s[d],g=f.charAt(0);for(f=f.slice(1),o.length=0;h=c.exec(f);)o.push(h[0]);let u=[],_=g==="A"||g==="a"?0:-1;for(let C=0,b=o.length;C<b;C++){const v=o[C];if(v==="00"){u.push(0,0),_>=0&&(_+=2,_>=7&&(_-=7));continue}if(_>=0){if(_===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(v)){u.push(parseInt(v[0],10)),u.push(parseInt(v[1],10)),u.push(parseFloat(v.slice(2))),_+=3,_>=7&&(_-=7);continue}if(v==="11"||v==="10"||v==="01"){u.push(parseInt(v[0],10)),u.push(parseInt(v[1],10)),_+=2,_>=7&&(_-=7);continue}if(v==="0"||v==="1"){u.push(parseInt(v,10)),_+=1,_>=7&&(_-=7);continue}}else if(_===4){if(/^[01]\d+(?:\.\d+)?$/.test(v)){u.push(parseInt(v[0],10)),u.push(parseFloat(v.slice(1))),_+=2,_>=7&&(_-=7);continue}if(v==="0"||v==="1"){u.push(parseInt(v,10)),_+=1,_>=7&&(_-=7);continue}}const w=parseFloat(v);isNaN(w)?u.push(0):u.push(w),_+=1,_>=7&&(_-=7)}else{const w=parseFloat(v);isNaN(w)?u.push(0):u.push(w)}}for(;u.length>0&&!isNaN(u[0]);){let C="",b=[];const v=a,w=l;let S,I,k,K,F,X,D,O,N,tt;switch(g){case"l":a+=u.shift(),l+=u.shift(),C="L",b.push(a,l);break;case"L":a=u.shift(),l=u.shift(),b.push(a,l);break;case"m":const it=u.shift(),q=u.shift();if(a+=it,l+=q,C="M",r.length>2&&r[r.length-1].command==="z"){for(let W=r.length-2;W>=0;W--)if(r[W].command==="M"){a=r[W].points[0]+it,l=r[W].points[1]+q;break}}b.push(a,l),g="l";break;case"M":a=u.shift(),l=u.shift(),C="M",b.push(a,l),g="L";break;case"h":a+=u.shift(),C="L",b.push(a,l);break;case"H":a=u.shift(),C="L",b.push(a,l);break;case"v":l+=u.shift(),C="L",b.push(a,l);break;case"V":l=u.shift(),C="L",b.push(a,l);break;case"C":b.push(u.shift(),u.shift(),u.shift(),u.shift()),a=u.shift(),l=u.shift(),b.push(a,l);break;case"c":b.push(a+u.shift(),l+u.shift(),a+u.shift(),l+u.shift()),a+=u.shift(),l+=u.shift(),C="C",b.push(a,l);break;case"S":I=a,k=l,S=r[r.length-1],S.command==="C"&&(I=a+(a-S.points[2]),k=l+(l-S.points[3])),b.push(I,k,u.shift(),u.shift()),a=u.shift(),l=u.shift(),C="C",b.push(a,l);break;case"s":I=a,k=l,S=r[r.length-1],S.command==="C"&&(I=a+(a-S.points[2]),k=l+(l-S.points[3])),b.push(I,k,a+u.shift(),l+u.shift()),a+=u.shift(),l+=u.shift(),C="C",b.push(a,l);break;case"Q":b.push(u.shift(),u.shift()),a=u.shift(),l=u.shift(),b.push(a,l);break;case"q":b.push(a+u.shift(),l+u.shift()),a+=u.shift(),l+=u.shift(),C="Q",b.push(a,l);break;case"T":I=a,k=l,S=r[r.length-1],S.command==="Q"&&(I=a+(a-S.points[0]),k=l+(l-S.points[1])),a=u.shift(),l=u.shift(),C="Q",b.push(I,k,a,l);break;case"t":I=a,k=l,S=r[r.length-1],S.command==="Q"&&(I=a+(a-S.points[0]),k=l+(l-S.points[1])),a+=u.shift(),l+=u.shift(),C="Q",b.push(I,k,a,l);break;case"A":K=u.shift(),F=u.shift(),X=u.shift(),D=u.shift(),O=u.shift(),N=a,tt=l,a=u.shift(),l=u.shift(),C="A",b=this.convertEndpointToCenterParameterization(N,tt,a,l,D,O,K,F,X);break;case"a":K=u.shift(),F=u.shift(),X=u.shift(),D=u.shift(),O=u.shift(),N=a,tt=l,a+=u.shift(),l+=u.shift(),C="A",b=this.convertEndpointToCenterParameterization(N,tt,a,l,D,O,K,F,X);break}r.push({command:C||g,points:b,start:{x:v,y:w},pathLength:this.calcLength(v,w,C||g,b)})}(g==="z"||g==="Z")&&r.push({command:"z",points:[],start:void 0,pathLength:0})}return r}static calcLength(t,e,n,s){let r,o,a,l;const c=_t;switch(n){case"L":return c.getLineLength(t,e,s[0],s[1]);case"C":return to([t,s[0],s[2],s[4]],[e,s[1],s[3],s[5]],1);case"Q":return eo([t,s[0],s[2]],[e,s[1],s[3]],1);case"A":r=0;const h=s[4],d=s[5],f=s[4]+d;let g=Math.PI/180;if(Math.abs(h-f)<g&&(g=Math.abs(h-f)),o=c.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],h,0),d<0)for(l=h-g;l>f;l-=g)a=c.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),r+=c.getLineLength(o.x,o.y,a.x,a.y),o=a;else for(l=h+g;l<f;l+=g)a=c.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),r+=c.getLineLength(o.x,o.y,a.x,a.y),o=a;return a=c.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],f,0),r+=c.getLineLength(o.x,o.y,a.x,a.y),r}return 0}static convertEndpointToCenterParameterization(t,e,n,s,r,o,a,l,c){const h=c*(Math.PI/180),d=Math.cos(h)*(t-n)/2+Math.sin(h)*(e-s)/2,f=-1*Math.sin(h)*(t-n)/2+Math.cos(h)*(e-s)/2,g=d*d/(a*a)+f*f/(l*l);g>1&&(a*=Math.sqrt(g),l*=Math.sqrt(g));let u=Math.sqrt((a*a*(l*l)-a*a*(f*f)-l*l*(d*d))/(a*a*(f*f)+l*l*(d*d)));r===o&&(u*=-1),isNaN(u)&&(u=0);const _=u*a*f/l,C=u*-l*d/a,b=(t+n)/2+Math.cos(h)*_-Math.sin(h)*C,v=(e+s)/2+Math.sin(h)*_+Math.cos(h)*C,w=function(D){return Math.sqrt(D[0]*D[0]+D[1]*D[1])},S=function(D,O){return(D[0]*O[0]+D[1]*O[1])/(w(D)*w(O))},I=function(D,O){return(D[0]*O[1]<D[1]*O[0]?-1:1)*Math.acos(S(D,O))},k=I([1,0],[(d-_)/a,(f-C)/l]),K=[(d-_)/a,(f-C)/l],F=[(-1*d-_)/a,(-1*f-C)/l];let X=I(K,F);return S(K,F)<=-1&&(X=Math.PI),S(K,F)>=1&&(X=0),o===0&&X>0&&(X=X-2*Math.PI),o===1&&X<0&&(X=X+2*Math.PI),[b,v,a,l,k,X,h,o]}}_t.prototype.className="Path";_t.prototype._attrsAffectingSize=["data"];St(_t);p.addGetterSetter(_t,"data");class qe extends xe{_sceneFunc(t){super._sceneFunc(t);const e=Math.PI*2,n=this.points();let s=n;const r=this.tension()!==0&&n.length>4;r&&(s=this.getTensionPoints());const o=this.pointerLength(),a=n.length;let l,c;if(r){const f=[s[s.length-4],s[s.length-3],s[s.length-2],s[s.length-1],n[a-2],n[a-1]],g=_t.calcLength(s[s.length-4],s[s.length-3],"C",f),u=_t.getPointOnQuadraticBezier(Math.min(1,1-o/g),f[0],f[1],f[2],f[3],f[4],f[5]);l=n[a-2]-u.x,c=n[a-1]-u.y}else l=n[a-2]-n[a-4],c=n[a-1]-n[a-3];const h=(Math.atan2(c,l)+e)%e,d=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[a-2],n[a-1]),t.rotate(h),t.moveTo(0,0),t.lineTo(-o,d/2),t.lineTo(-o,-d/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),r?(l=(s[0]+s[2])/2-n[0],c=(s[1]+s[3])/2-n[1]):(l=n[2]-n[0],c=n[3]-n[1]),t.rotate((Math.atan2(-c,-l)+e)%e),t.moveTo(0,0),t.lineTo(-o,d/2),t.lineTo(-o,-d/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x,y:t.y-e,width:t.width,height:t.height+e*2}}}qe.prototype.className="Arrow";St(qe);p.addGetterSetter(qe,"pointerLength",10,G());p.addGetterSetter(qe,"pointerWidth",10,G());p.addGetterSetter(qe,"pointerAtBeginning",!1);p.addGetterSetter(qe,"pointerAtEnding",!0);class gi extends E{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}gi.prototype._centroid=!0;gi.prototype.className="Circle";gi.prototype._attrsAffectingSize=["radius"];St(gi);p.addGetterSetter(gi,"radius",0,G());class De extends E{_sceneFunc(t){const e=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),e!==n&&t.scale(1,n/e),t.arc(0,0,e,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}De.prototype.className="Ellipse";De.prototype._centroid=!0;De.prototype._attrsAffectingSize=["radiusX","radiusY"];St(De);p.addComponentsGetterSetter(De,"radius",["x","y"]);p.addGetterSetter(De,"radiusX",0,G());p.addGetterSetter(De,"radiusY",0,G());class jt extends E{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",e=>{this._removeImageLoad(e.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),e=this.hasShadow();return t&&e?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const e=this.getWidth(),n=this.getHeight(),s=this.cornerRadius(),r=this.attrs.image;let o;if(r){const a=this.attrs.cropWidth,l=this.attrs.cropHeight;a&&l?o=[r,this.cropX(),this.cropY(),a,l,0,0,e,n]:o=[r,0,0,e,n]}(this.hasFill()||this.hasStroke()||s)&&(t.beginPath(),s?x.drawRoundedRectPath(t,e,n,s):t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)),r&&(s&&t.clip(),t.drawImage.apply(t,o))}_hitFunc(t){const e=this.width(),n=this.height(),s=this.cornerRadius();t.beginPath(),s?x.drawRoundedRectPath(t,e,n,s):t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e,n;return(n=(t=this.attrs.width)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.width)!==null&&n!==void 0?n:0}getHeight(){var t,e,n;return(n=(t=this.attrs.height)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.height)!==null&&n!==void 0?n:0}static fromURL(t,e,n=null){const s=x.createImageElement();s.onload=function(){const r=new jt({image:s});e(r)},s.onerror=n,s.crossOrigin="Anonymous",s.src=t}}jt.prototype.className="Image";jt.prototype._attrsAffectingSize=["image"];St(jt);p.addGetterSetter(jt,"cornerRadius",0,Wn(4));p.addGetterSetter(jt,"image");p.addComponentsGetterSetter(jt,"crop",["x","y","width","height"]);p.addGetterSetter(jt,"cropX",0,G());p.addGetterSetter(jt,"cropY",0,G());p.addGetterSetter(jt,"cropWidth",0,G());p.addGetterSetter(jt,"cropHeight",0,G());const Ya=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],Y0="Change.konva",j0="none",Ms="up",ks="right",Os="down",Ls="left",K0=Ya.length;class sr extends fi{constructor(t){super(t),this.on("add.konva",function(e){this._addListeners(e.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let e=this,n;const s=function(){e._sync()};for(n=0;n<K0;n++)t.on(Ya[n]+Y0,s)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),e=this.getTag(),n,s,r,o,a,l,c;if(t&&e){switch(n=t.width(),s=t.height(),r=e.pointerDirection(),o=e.pointerWidth(),c=e.pointerHeight(),a=0,l=0,r){case Ms:a=n/2,l=-1*c;break;case ks:a=n+o,l=s/2;break;case Os:a=n/2,l=s+c;break;case Ls:a=-1*o,l=s/2;break}e.setAttrs({x:-1*a,y:-1*l,width:n,height:s}),t.setAttrs({x:-1*a,y:-1*l})}}}sr.prototype.className="Label";St(sr);class Qe extends E{_sceneFunc(t){const e=this.width(),n=this.height(),s=this.pointerDirection(),r=this.pointerWidth(),o=this.pointerHeight(),a=this.cornerRadius();let l=0,c=0,h=0,d=0;typeof a=="number"?l=c=h=d=Math.min(a,e/2,n/2):(l=Math.min(a[0]||0,e/2,n/2),c=Math.min(a[1]||0,e/2,n/2),d=Math.min(a[2]||0,e/2,n/2),h=Math.min(a[3]||0,e/2,n/2)),t.beginPath(),t.moveTo(l,0),s===Ms&&(t.lineTo((e-r)/2,0),t.lineTo(e/2,-1*o),t.lineTo((e+r)/2,0)),t.lineTo(e-c,0),t.arc(e-c,c,c,Math.PI*3/2,0,!1),s===ks&&(t.lineTo(e,(n-o)/2),t.lineTo(e+r,n/2),t.lineTo(e,(n+o)/2)),t.lineTo(e,n-d),t.arc(e-d,n-d,d,0,Math.PI/2,!1),s===Os&&(t.lineTo((e+r)/2,n),t.lineTo(e/2,n+o),t.lineTo((e-r)/2,n)),t.lineTo(h,n),t.arc(h,n-h,h,Math.PI/2,Math.PI,!1),s===Ls&&(t.lineTo(0,(n+o)/2),t.lineTo(-1*r,n/2),t.lineTo(0,(n-o)/2)),t.lineTo(0,l),t.arc(l,l,l,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,e=0,n=this.pointerWidth(),s=this.pointerHeight(),r=this.pointerDirection(),o=this.width(),a=this.height();return r===Ms?(e-=s,a+=s):r===Os?a+=s:r===Ls?(t-=n*1.5,o+=n):r===ks&&(o+=n*1.5),{x:t,y:e,width:o,height:a}}}Qe.prototype.className="Tag";St(Qe);p.addGetterSetter(Qe,"pointerDirection",j0);p.addGetterSetter(Qe,"pointerWidth",0,G());p.addGetterSetter(Qe,"pointerHeight",0,G());p.addGetterSetter(Qe,"cornerRadius",0,Wn(4));class tn extends E{_sceneFunc(t){const e=this.cornerRadius(),n=this.width(),s=this.height();t.beginPath(),e?x.drawRoundedRectPath(t,n,s,e):t.rect(0,0,n,s),t.closePath(),t.fillStrokeShape(this)}}tn.prototype.className="Rect";St(tn);p.addGetterSetter(tn,"cornerRadius",0,Wn(4));class Fe extends E{_sceneFunc(t){const e=this._getPoints(),n=this.radius(),s=this.sides(),r=this.cornerRadius();if(t.beginPath(),r)x.drawRoundedPolygonPath(t,e,s,n,r);else{t.moveTo(e[0].x,e[0].y);for(let o=1;o<e.length;o++)t.lineTo(e[o].x,e[o].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,n=[];for(let s=0;s<t;s++)n.push({x:e*Math.sin(s*2*Math.PI/t),y:-1*e*Math.cos(s*2*Math.PI/t)});return n}getSelfRect(){const t=this._getPoints();let e=t[0].x,n=t[0].x,s=t[0].y,r=t[0].y;return t.forEach(o=>{e=Math.min(e,o.x),n=Math.max(n,o.x),s=Math.min(s,o.y),r=Math.max(r,o.y)}),{x:e,y:s,width:n-e,height:r-s}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Fe.prototype.className="RegularPolygon";Fe.prototype._centroid=!0;Fe.prototype._attrsAffectingSize=["radius"];St(Fe);p.addGetterSetter(Fe,"radius",0,G());p.addGetterSetter(Fe,"sides",0,G());p.addGetterSetter(Fe,"cornerRadius",0,Wn(4));const no=Math.PI*2;class Je extends E{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,no,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),no,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Je.prototype.className="Ring";Je.prototype._centroid=!0;Je.prototype._attrsAffectingSize=["innerRadius","outerRadius"];St(Je);p.addGetterSetter(Je,"innerRadius",0,G());p.addGetterSetter(Je,"outerRadius",0,G());class he extends E{constructor(t){super(t),this._updated=!0,this.anim=new Kt(()=>{const e=this._updated;return this._updated=!1,e}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const e=this.animation(),n=this.frameIndex(),s=n*4,r=this.animations()[e],o=this.frameOffsets(),a=r[s+0],l=r[s+1],c=r[s+2],h=r[s+3],d=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,c,h),t.closePath(),t.fillStrokeShape(this)),d)if(o){const f=o[e],g=n*2;t.drawImage(d,a,l,c,h,f[g+0],f[g+1],c,h)}else t.drawImage(d,a,l,c,h,0,0,c,h)}_hitFunc(t){const e=this.animation(),n=this.frameIndex(),s=n*4,r=this.animations()[e],o=this.frameOffsets(),a=r[s+2],l=r[s+3];if(t.beginPath(),o){const c=o[e],h=n*2;t.rect(c[h+0],c[h+1],a,l)}else t.rect(0,0,a,l);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),e=this.animation(),n=this.animations(),s=n[e],r=s.length/4;t<r-1?this.frameIndex(t+1):this.frameIndex(0)}}he.prototype.className="Sprite";St(he);p.addGetterSetter(he,"animation");p.addGetterSetter(he,"animations");p.addGetterSetter(he,"frameOffsets");p.addGetterSetter(he,"image");p.addGetterSetter(he,"frameIndex",0,G());p.addGetterSetter(he,"frameRate",17,G());p.backCompat(he,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class Ne extends E{_sceneFunc(t){const e=this.innerRadius(),n=this.outerRadius(),s=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(let r=1;r<s*2;r++){const o=r%2===0?n:e,a=o*Math.sin(r*Math.PI/s),l=-1*o*Math.cos(r*Math.PI/s);t.lineTo(a,l)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Ne.prototype.className="Star";Ne.prototype._centroid=!0;Ne.prototype._attrsAffectingSize=["innerRadius","outerRadius"];St(Ne);p.addGetterSetter(Ne,"numPoints",5,G());p.addGetterSetter(Ne,"innerRadius",0,G());p.addGetterSetter(Ne,"outerRadius",0,G());function we(i){return[...i].reduce((t,e,n,s)=>{if(new RegExp("\\p{Emoji}","u").test(e)){const r=s[n+1];r&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(r)?(t.push(e+r),s[n+1]=""):t.push(e)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(e+(s[n+1]||""))?t.push(e+s[n+1]):n>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(e)?t[t.length-1]+=e:e&&t.push(e);return t},[])}const ei="auto",X0="center",ja="inherit",Ti="justify",V0="Change.konva",$0="2d",so="-",Ka="left",q0="text",Q0="Text",J0="top",Z0="bottom",ro="middle",Xa="normal",td="px ",un=" ",ed="right",oo="rtl",id="word",nd="char",ao="none",as="",Va=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],sd=Va.length;function rd(i){return i.split(",").map(t=>{t=t.trim();const e=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!n&&(t=`"${t}"`),t}).join(", ")}let gn;function ls(){return gn||(gn=x.createCanvasElement().getContext($0),gn)}function od(i){i.fillText(this._partialText,this._partialTextX,this._partialTextY)}function ad(i){i.setAttr("miterLimit",2),i.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function ld(i){return i=i||{},!i.fillLinearGradientColorStops&&!i.fillRadialGradientColorStops&&!i.fillPatternImage&&(i.fill=i.fill||"black"),i}class bt extends E{constructor(t){super(ld(t)),this._partialTextX=0,this._partialTextY=0;for(let e=0;e<sd;e++)this.on(Va[e]+V0,this._setTextData);this._setTextData()}_sceneFunc(t){var e,n;const s=this.textArr,r=s.length;if(!this.text())return;let o=this.padding(),a=this.fontSize(),l=this.lineHeight()*a,c=this.verticalAlign(),h=this.direction(),d=0,f=this.align(),g=this.getWidth(),u=this.letterSpacing(),_=this.charRenderFunc(),C=this.fill(),b=this.textDecoration(),v=this.underlineOffset(),w=b.indexOf("underline")!==-1,S=b.indexOf("line-through")!==-1,I;h=h===ja?t.direction:h;let k=l/2,K=ro;if(!B.legacyTextRendering){const F=this.measureSize("M");K="alphabetic";const X=(e=F.fontBoundingBoxAscent)!==null&&e!==void 0?e:F.actualBoundingBoxAscent,D=(n=F.fontBoundingBoxDescent)!==null&&n!==void 0?n:F.actualBoundingBoxDescent;k=(X-D)/2+l/2}for(h===oo&&t.setAttr("direction",h),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",K),t.setAttr("textAlign",Ka),c===ro?d=(this.getHeight()-r*l-o*2)/2:c===Z0&&(d=this.getHeight()-r*l-o*2),t.translate(o,d+o),I=0;I<r;I++){let F=0,X=0;const D=s[I],O=D.text,N=D.width,tt=D.lastInParagraph;if(t.save(),f===ed?F+=g-N-o*2:f===X0&&(F+=(g-N-o*2)/2),w){t.save(),t.beginPath();const q=v??(B.legacyTextRendering?Math.round(a/2):Math.round(a/4)),W=F,Q=k+X+q;t.moveTo(W,Q);const z=f===Ti&&!tt?g-o*2:N;t.lineTo(W+Math.round(z),Q),t.lineWidth=a/15;const ot=this._getLinearGradient();t.strokeStyle=ot||C,t.stroke(),t.restore()}const it=F;if(h!==oo&&(u!==0||f===Ti||_)){const q=O.split(" ").length-1,W=we(O);for(let Q=0;Q<W.length;Q++){const z=W[Q];if(z===" "&&!tt&&f===Ti&&(F+=(g-o*2-N)/q),this._partialTextX=F,this._partialTextY=k+X,this._partialText=z,_){t.save();const xt=s.slice(0,I).reduce((lt,At)=>lt+we(At.text).length,0),st=Q+xt;_({char:z,index:st,x:F,y:k+X,lineIndex:I,column:Q,isLastInLine:tt,width:this.measureSize(z).width,context:t})}t.fillStrokeShape(this),_&&t.restore(),F+=this.measureSize(z).width+u}}else u!==0&&t.setAttr("letterSpacing",`${u}px`),this._partialTextX=F,this._partialTextY=k+X,this._partialText=O,t.fillStrokeShape(this);if(S){t.save(),t.beginPath();const q=B.legacyTextRendering?0:-Math.round(a/4),W=it;t.moveTo(W,k+X+q);const Q=f===Ti&&!tt?g-o*2:N;t.lineTo(W+Math.round(Q),k+X+q),t.lineWidth=a/15;const z=this._getLinearGradient();t.strokeStyle=z||C,t.stroke(),t.restore()}t.restore(),r>1&&(k+=l)}}_hitFunc(t){const e=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)}setText(t){const e=x._isString(t)?t:t==null?"":t+"";return this._setAttr(q0,e),this}getWidth(){return this.attrs.width===ei||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===ei||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return x.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,n,s,r,o,a,l,c,h,d,f;let g=ls(),u=this.fontSize(),_;g.save(),g.font=this._getContextFont(),_=g.measureText(t),g.restore();const C=u/100;return{actualBoundingBoxAscent:(e=_.actualBoundingBoxAscent)!==null&&e!==void 0?e:71.58203125*C,actualBoundingBoxDescent:(n=_.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(s=_.actualBoundingBoxLeft)!==null&&s!==void 0?s:-7.421875*C,actualBoundingBoxRight:(r=_.actualBoundingBoxRight)!==null&&r!==void 0?r:75.732421875*C,alphabeticBaseline:(o=_.alphabeticBaseline)!==null&&o!==void 0?o:0,emHeightAscent:(a=_.emHeightAscent)!==null&&a!==void 0?a:100*C,emHeightDescent:(l=_.emHeightDescent)!==null&&l!==void 0?l:-20*C,fontBoundingBoxAscent:(c=_.fontBoundingBoxAscent)!==null&&c!==void 0?c:91*C,fontBoundingBoxDescent:(h=_.fontBoundingBoxDescent)!==null&&h!==void 0?h:21*C,hangingBaseline:(d=_.hangingBaseline)!==null&&d!==void 0?d:72.80000305175781*C,ideographicBaseline:(f=_.ideographicBaseline)!==null&&f!==void 0?f:-21*C,width:_.width,height:u}}_getContextFont(){return this.fontStyle()+un+this.fontVariant()+un+(this.fontSize()+td)+rd(this.fontFamily())}_addTextLine(t){this.align()===Ti&&(t=t.trim());const n=this._getTextWidth(t);return this.textArr.push({text:t,width:n,lastInParagraph:!1})}_getTextWidth(t){const e=this.letterSpacing(),n=t.length;return ls().measureText(t).width+e*n}_setTextData(){let t=this.text().split(`
`),e=+this.fontSize(),n=0,s=this.lineHeight()*e,r=this.attrs.width,o=this.attrs.height,a=r!==ei&&r!==void 0,l=o!==ei&&o!==void 0,c=this.padding(),h=r-c*2,d=o-c*2,f=0,g=this.wrap(),u=g!==ao,_=g!==nd&&u,C=this.ellipsis();this.textArr=[],ls().font=this._getContextFont();const b=C?this._getTextWidth(as):0;for(let v=0,w=t.length;v<w;++v){let S=t[v],I=this._getTextWidth(S);if(a&&I>h)for(;S.length>0;){let k=0,K=we(S).length,F="",X=0;for(;k<K;){const D=k+K>>>1,O=we(S),N=O.slice(0,D+1).join(""),tt=this._getTextWidth(N);(C&&l&&f+s>d?tt+b:tt)<=h?(k=D+1,F=N,X=tt):K=D}if(F){if(_){const N=we(S),tt=we(F),it=N[tt.length],q=it===un||it===so;let W;if(q&&X<=h)W=tt.length;else{const Q=tt.lastIndexOf(un),z=tt.lastIndexOf(so);W=Math.max(Q,z)+1}W>0&&(k=W,F=N.slice(0,k).join(""),X=this._getTextWidth(F))}if(F=F.trimRight(),this._addTextLine(F),n=Math.max(n,X),f+=s,this._shouldHandleEllipsis(f)){this._tryToAddEllipsisToLastLine();break}if(S=we(S).slice(k).join("").trimLeft(),S.length>0&&(I=this._getTextWidth(S),I<=h)){this._addTextLine(S),f+=s,n=Math.max(n,I);break}}else break}else this._addTextLine(S),f+=s,n=Math.max(n,I),this._shouldHandleEllipsis(f)&&v<w-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&f+s>d)break}this.textHeight=e,this.textWidth=n}_shouldHandleEllipsis(t){const e=+this.fontSize(),n=this.lineHeight()*e,s=this.attrs.height,r=s!==ei&&s!==void 0,o=this.padding(),a=s-o*2;return!(this.wrap()!==ao)||r&&t+n>a}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,e=t!==ei&&t!==void 0,n=this.padding(),s=t-n*2,r=this.ellipsis(),o=this.textArr[this.textArr.length-1];!o||!r||(e&&(this._getTextWidth(o.text+as)<s||(o.text=o.text.slice(0,o.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+as))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,e=this.hasShadow();return t&&e?!0:super._useBufferCanvas()}}bt.prototype._fillFunc=od;bt.prototype._strokeFunc=ad;bt.prototype.className=Q0;bt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];St(bt);p.overWriteSetter(bt,"width",er());p.overWriteSetter(bt,"height",er());p.addGetterSetter(bt,"direction",ja);p.addGetterSetter(bt,"fontFamily","Arial");p.addGetterSetter(bt,"fontSize",12,G());p.addGetterSetter(bt,"fontStyle",Xa);p.addGetterSetter(bt,"fontVariant",Xa);p.addGetterSetter(bt,"padding",0,G());p.addGetterSetter(bt,"align",Ka);p.addGetterSetter(bt,"verticalAlign",J0);p.addGetterSetter(bt,"lineHeight",1,G());p.addGetterSetter(bt,"wrap",id);p.addGetterSetter(bt,"ellipsis",!1,Qt());p.addGetterSetter(bt,"letterSpacing",0,G());p.addGetterSetter(bt,"text","",Ve());p.addGetterSetter(bt,"textDecoration","");p.addGetterSetter(bt,"underlineOffset",void 0,G());p.addGetterSetter(bt,"charRenderFunc",void 0);const hd="",$a="normal";function qa(i){i.fillText(this.partialText,0,0)}function Qa(i){i.strokeText(this.partialText,0,0)}class Pt extends E{constructor(t){super(t),this.dummyCanvas=x.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return _t.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const e=this.pathLength;return t>e?null:_t.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=_t.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const e=this.textDecoration(),n=this.fill(),s=this.fontSize(),r=this.glyphInfo,o=e.indexOf("underline")!==-1,a=e.indexOf("line-through")!==-1;o&&t.beginPath();for(let l=0;l<r.length;l++){t.save();const c=r[l].p0;t.translate(c.x,c.y),t.rotate(r[l].rotation),this.partialText=r[l].text,t.fillStrokeShape(this),o&&(l===0&&t.moveTo(0,s/2+1),t.lineTo(r[l].width,s/2+1)),t.restore()}if(o&&(t.strokeStyle=n,t.lineWidth=s/20,t.stroke()),a){t.beginPath();for(let l=0;l<r.length;l++){t.save();const c=r[l].p0;t.translate(c.x,c.y),t.rotate(r[l].rotation),l===0&&t.moveTo(0,0),t.lineTo(r[l].width,0),t.restore()}t.strokeStyle=n,t.lineWidth=s/20,t.stroke()}t.restore()}_hitFunc(t){t.beginPath();const e=this.glyphInfo;if(e.length>=1){const n=e[0].p0;t.moveTo(n.x,n.y)}for(let n=0;n<e.length;n++){const s=e[n].p1;t.lineTo(s.x,s.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return x.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return bt.prototype.setText.call(this,t)}_getContextFont(){return bt.prototype._getContextFont.call(this)}_getTextSize(t){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const s=n.measureText(t);return n.restore(),{width:s.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const t=we(this.text()),e=[];let n=0;for(let d=0;d<t.length;d++)e.push({char:t[d],width:this._getTextSize(t[d]).width}),n+=e[d].width;const{height:s}=this._getTextSize(this.attrs.text);if(this.textWidth=n,this.textHeight=s,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),o=this.align(),a=this.kerningFunc(),l=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let c=0;o==="center"&&(c=Math.max(0,this.pathLength/2-l/2)),o==="right"&&(c=Math.max(0,this.pathLength-l));let h=c;for(let d=0;d<e.length;d++){const f=this._getPointAtLength(h);if(!f)return;const g=e[d].char;let u=e[d].width+r;if(g===" "&&o==="justify"){const S=this.text().split(" ").length-1;u+=(this.pathLength-l)/S}const _=this._getPointAtLength(h+u);if(!_)return;const C=_t.getLineLength(f.x,f.y,_.x,_.y);let b=0;if(a)try{b=a(e[d-1].char,g)*this.fontSize()}catch{b=0}f.x+=b,_.x+=b,this.textWidth+=b;const v=_t.getPointOnLine(b+C/2,f.x,f.y,_.x,_.y),w=Math.atan2(_.y-f.y,_.x-f.x);this.glyphInfo.push({transposeX:v.x,transposeY:v.y,text:t[d],rotation:w,p0:f,p1:_,width:C}),h+=u}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(c){t.push(c.p0.x),t.push(c.p0.y),t.push(c.p1.x),t.push(c.p1.y)});let e=t[0]||0,n=t[0]||0,s=t[1]||0,r=t[1]||0,o,a;for(let c=0;c<t.length/2;c++)o=t[c*2],a=t[c*2+1],e=Math.min(e,o),n=Math.max(n,o),s=Math.min(s,a),r=Math.max(r,a);const l=this.fontSize();return{x:e-l/2,y:s-l/2,width:n-e+l,height:r-s+l}}destroy(){return x.releaseCanvas(this.dummyCanvas),super.destroy()}}Pt.prototype._fillFunc=qa;Pt.prototype._strokeFunc=Qa;Pt.prototype._fillFuncHit=qa;Pt.prototype._strokeFuncHit=Qa;Pt.prototype.className="TextPath";Pt.prototype._attrsAffectingSize=["text","fontSize","data"];St(Pt);p.addGetterSetter(Pt,"data");p.addGetterSetter(Pt,"fontFamily","Arial");p.addGetterSetter(Pt,"fontSize",12,G());p.addGetterSetter(Pt,"fontStyle",$a);p.addGetterSetter(Pt,"align","left");p.addGetterSetter(Pt,"letterSpacing",0,G());p.addGetterSetter(Pt,"textBaseline","middle");p.addGetterSetter(Pt,"fontVariant",$a);p.addGetterSetter(Pt,"text",hd);p.addGetterSetter(Pt,"textDecoration","");p.addGetterSetter(Pt,"kerningFunc",void 0);const Ja="tr-konva",cd=["resizeEnabledChange","rotateAnchorOffsetChange","rotateAnchorAngleChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(i=>i+`.${Ja}`).join(" "),lo="nodesRect",dd=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],fd={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},ud="ontouchstart"in B._global;function gd(i,t,e){if(i==="rotater")return e;t+=x.degToRad(fd[i]||0);const n=(x.radToDeg(t)%360+360)%360;return x._inRange(n,315+22.5,360)||x._inRange(n,0,22.5)?"ns-resize":x._inRange(n,45-22.5,45+22.5)?"nesw-resize":x._inRange(n,90-22.5,90+22.5)?"ew-resize":x._inRange(n,135-22.5,135+22.5)?"nwse-resize":x._inRange(n,180-22.5,180+22.5)?"ns-resize":x._inRange(n,225-22.5,225+22.5)?"nesw-resize":x._inRange(n,270-22.5,270+22.5)?"ew-resize":x._inRange(n,315-22.5,315+22.5)?"nwse-resize":(x.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const En=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function pd(i){return{x:i.x+i.width/2*Math.cos(i.rotation)+i.height/2*Math.sin(-i.rotation),y:i.y+i.height/2*Math.cos(i.rotation)+i.width/2*Math.sin(i.rotation)}}function Za(i,t,e){const n=e.x+(i.x-e.x)*Math.cos(t)-(i.y-e.y)*Math.sin(t),s=e.y+(i.x-e.x)*Math.sin(t)+(i.y-e.y)*Math.cos(t);return{...i,rotation:i.rotation+t,x:n,y:s}}function md(i,t){const e=pd(i);return Za(i,t,e)}function _d(i,t,e){let n=t;for(let s=0;s<i.length;s++){const r=B.getAngle(i[s]),o=Math.abs(r-t)%(Math.PI*2);Math.min(o,Math.PI*2-o)<e&&(n=r)}return n}let Is=0;class rt extends fi{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(cd,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return x.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return Ja+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const e=t.filter(s=>s.isAncestorOf(this)?(x.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=e,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(s=>{const r=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(s._attrsAffectingSize.length){const o=s._attrsAffectingSize.map(a=>a+"Change."+this._getEventNamespace()).join(" ");s.on(o,r)}s.on(dd.map(o=>o+`.${this._getEventNamespace()}`).join(" "),r),s.on(`absoluteTransformChange.${this._getEventNamespace()}`,r),this._proxyDrag(s)}),this._resetTransformCache(),this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,n=>{e=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!e)return;const s=t.getAbsolutePosition(),r=s.x-e.x,o=s.y-e.y;this.nodes().forEach(a=>{if(a===t||a.isDragging())return;const l=a.getAbsolutePosition();a.setAbsolutePosition({x:l.x+r,y:l.y+o}),a.startDrag(n)}),e=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(lo),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(lo,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),n){const s=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),r=t.getAbsoluteScale(n),o=t.getAbsolutePosition(n),a=s.x*r.x-t.offsetX()*r.x,l=s.y*r.y-t.offsetY()*r.y,c=(B.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),h={x:o.x+a*Math.cos(c)+l*Math.sin(-c),y:o.y+l*Math.cos(c)+a*Math.sin(c),width:s.width*r.x,height:s.height*r.y,rotation:c};return Za(h,-B.getAngle(e),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const e=[];this.nodes().map(c=>{const h=c.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),d=[{x:h.x,y:h.y},{x:h.x+h.width,y:h.y},{x:h.x+h.width,y:h.y+h.height},{x:h.x,y:h.y+h.height}],f=c.getAbsoluteTransform();d.forEach(function(g){const u=f.point(g);e.push(u)})});const n=new zt;n.rotate(-B.getAngle(this.rotation()));let s=1/0,r=1/0,o=-1/0,a=-1/0;e.forEach(function(c){const h=n.point(c);s===void 0&&(s=o=h.x,r=a=h.y),s=Math.min(s,h.x),r=Math.min(r,h.y),o=Math.max(o,h.x),a=Math.max(a,h.y)}),n.invert();const l=n.point({x:s,y:r});return{x:l.x,y:l.y,width:o-s,height:a-r,rotation:B.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),En.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const e=new tn({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:ud?10:"auto"}),n=this;e.on("mousedown touchstart",function(s){n._handleMouseDown(s)}),e.on("dragstart",s=>{e.stopDrag(),s.cancelBubble=!0}),e.on("dragend",s=>{s.cancelBubble=!0}),e.on("mouseenter",()=>{const s=B.getAngle(this.rotation()),r=this.rotateAnchorCursor(),o=gd(t,s,r);e.getStage().content&&(e.getStage().content.style.cursor=o),this._cursorChange=!0}),e.on("mouseout",()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(e)}_createBack(){const t=new E({name:"back",width:0,height:0,sceneFunc(e,n){const s=n.getParent(),r=s.padding(),o=n.width(),a=n.height();if(e.beginPath(),e.rect(-r,-r,o+r*2,a+r*2),s.rotateEnabled()&&s.rotateLineVisible()){const l=s.rotateAnchorAngle(),c=s.rotateAnchorOffset(),h=x.degToRad(l),d=Math.sin(h),f=-Math.cos(h),g=o/2,u=a/2;let _=1/0;f<0?_=Math.min(_,-u/f):f>0&&(_=Math.min(_,(a-u)/f)),d<0?_=Math.min(_,-g/d):d>0&&(_=Math.min(_,(o-g)/d));const C=g+d*_,b=u+f*_,v=x._sign(a),w=C+d*c*v,S=b+f*c*v;e.moveTo(C,b),e.lineTo(w,S)}e.fillStrokeShape(n)},hitFunc:(e,n)=>{if(!this.shouldOverdrawWholeArea())return;const s=this.padding();e.beginPath(),e.rect(-s,-s,n.width()+s*2,n.height()+s*2),e.fillStrokeShape(n)}});this.add(t),this._proxyDrag(t),t.on("dragstart",e=>{e.cancelBubble=!0}),t.on("dragmove",e=>{e.cancelBubble=!0}),t.on("dragend",e=>{e.cancelBubble=!0}),this.on("dragmove",e=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const e=this._getNodeRect(),n=e.width,s=e.height,r=Math.sqrt(Math.pow(n,2)+Math.pow(s,2));this.sin=Math.abs(s/r),this.cos=Math.abs(n/r),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const o=t.target.getAbsolutePosition(),a=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:a.x-o.x,y:a.y-o.y},Is++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:t.evt,target:l})})}_handleMouseMove(t){let e,n,s;const r=this.findOne("."+this._movingAnchorName),o=r.getStage();o.setPointersPositions(t);const a=o.getPointerPosition();let l={x:a.x-this._anchorDragOffset.x,y:a.y-this._anchorDragOffset.y};const c=r.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(c,l,t)),r.setAbsolutePosition(l);const h=r.getAbsolutePosition();if(c.x===h.x&&c.y===h.y)return;if(this._movingAnchorName==="rotater"){const v=this._getNodeRect();e=r.x()-v.width/2,n=-r.y()+v.height/2;const w=B.getAngle(this.rotateAnchorAngle());let S=Math.atan2(-n,e)+Math.PI/2-w;v.height<0&&(S-=Math.PI);const k=B.getAngle(this.rotation())+S,K=B.getAngle(this.rotationSnapTolerance()),X=_d(this.rotationSnaps(),k,K)-v.rotation,D=md(v,X);this._fitNodesInto(D,t);return}const d=this.shiftBehavior();let f;d==="inverted"?f=this.keepRatio()&&!t.shiftKey:d==="none"?f=this.keepRatio():f=this.keepRatio()||t.shiftKey;let g=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(f){const v=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};s=Math.sqrt(Math.pow(v.x-r.x(),2)+Math.pow(v.y-r.y(),2));const w=this.findOne(".top-left").x()>v.x?-1:1,S=this.findOne(".top-left").y()>v.y?-1:1;e=s*this.cos*w,n=s*this.sin*S,this.findOne(".top-left").x(v.x-e),this.findOne(".top-left").y(v.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(r.y());else if(this._movingAnchorName==="top-right"){if(f){const v=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};s=Math.sqrt(Math.pow(r.x()-v.x,2)+Math.pow(v.y-r.y(),2));const w=this.findOne(".top-right").x()<v.x?-1:1,S=this.findOne(".top-right").y()>v.y?-1:1;e=s*this.cos*w,n=s*this.sin*S,this.findOne(".top-right").x(v.x+e),this.findOne(".top-right").y(v.y-n)}var u=r.position();this.findOne(".top-left").y(u.y),this.findOne(".bottom-right").x(u.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(r.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(r.x());else if(this._movingAnchorName==="bottom-left"){if(f){const v=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};s=Math.sqrt(Math.pow(v.x-r.x(),2)+Math.pow(r.y()-v.y,2));const w=v.x<r.x()?-1:1,S=r.y()<v.y?-1:1;e=s*this.cos*w,n=s*this.sin*S,r.x(v.x-e),r.y(v.y+n)}u=r.position(),this.findOne(".top-left").x(u.x),this.findOne(".bottom-right").y(u.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(r.y());else if(this._movingAnchorName==="bottom-right"){if(f){const v=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};s=Math.sqrt(Math.pow(r.x()-v.x,2)+Math.pow(r.y()-v.y,2));const w=this.findOne(".bottom-right").x()<v.x?-1:1,S=this.findOne(".bottom-right").y()<v.y?-1:1;e=s*this.cos*w,n=s*this.sin*S,this.findOne(".bottom-right").x(v.x+e),this.findOne(".bottom-right").y(v.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(g=this.centeredScaling()||t.altKey,g){const v=this.findOne(".top-left"),w=this.findOne(".bottom-right"),S=v.x(),I=v.y(),k=this.getWidth()-w.x(),K=this.getHeight()-w.y();w.move({x:-S,y:-I}),v.move({x:k,y:K})}const _=this.findOne(".top-left").getAbsolutePosition();e=_.x,n=_.y;const C=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),b=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:n,width:C,height:b,rotation:B.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var e;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();Is--,this._fire("transformend",{evt:t,target:n}),(e=this.getLayer())===null||e===void 0||e.batchDraw(),n&&this._nodes.forEach(s=>{var r;s._fire("transformend",{evt:t,target:s}),(r=s.getLayer())===null||r===void 0||r.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,e){const n=this._getNodeRect(),s=1;if(x._inRange(t.width,-this.padding()*2-s,s)){this.update();return}if(x._inRange(t.height,-this.padding()*2-s,s)){this.update();return}const r=new zt;if(r.rotate(B.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const f=r.point({x:-this.padding()*2,y:0});t.x+=f.x,t.y+=f.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=f.x,this._anchorDragOffset.y-=f.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const f=r.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=f.x,this._anchorDragOffset.y-=f.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const f=r.point({x:0,y:-this.padding()*2});t.x+=f.x,t.y+=f.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=f.x,this._anchorDragOffset.y-=f.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const f=r.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=f.x,this._anchorDragOffset.y-=f.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const f=this.boundBoxFunc()(n,t);f?t=f:x.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const o=1e7,a=new zt;a.translate(n.x,n.y),a.rotate(n.rotation),a.scale(n.width/o,n.height/o);const l=new zt,c=t.width/o,h=t.height/o;this.flipEnabled()===!1?(l.translate(t.x,t.y),l.rotate(t.rotation),l.translate(t.width<0?t.width:0,t.height<0?t.height:0),l.scale(Math.abs(c),Math.abs(h))):(l.translate(t.x,t.y),l.rotate(t.rotation),l.scale(c,h));const d=l.multiply(a.invert());this._nodes.forEach(f=>{var g;if(!f.getStage())return;const u=f.getParent().getAbsoluteTransform(),_=f.getTransform().copy();_.translate(f.offsetX(),f.offsetY());const C=new zt;C.multiply(u.copy().invert()).multiply(d).multiply(u).multiply(_);const b=C.decompose();f.setAttrs(b),(g=f.getLayer())===null||g===void 0||g.batchDraw()}),this.rotation(x._getRotation(t.rotation)),this._nodes.forEach(f=>{this._fire("transform",{evt:e,target:f}),f._fire("transform",{evt:e,target:f})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t;const e=this._getNodeRect();this.rotation(x._getRotation(e.rotation));const n=e.width,s=e.height,r=this.enabledAnchors(),o=this.resizeEnabled(),a=this.padding(),l=this.anchorSize(),c=this.find("._anchor");c.forEach(k=>{k.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+a,offsetY:l/2+a,visible:o&&r.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:l/2+a,visible:o&&r.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:l/2-a,offsetY:l/2+a,visible:o&&r.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:s/2,offsetX:l/2+a,visible:o&&r.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:s/2,offsetX:l/2-a,visible:o&&r.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:s,offsetX:l/2+a,offsetY:l/2-a,visible:o&&r.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:s,offsetY:l/2-a,visible:o&&r.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:s,offsetX:l/2-a,offsetY:l/2-a,visible:o&&r.indexOf("bottom-right")>=0});const h=this.rotateAnchorAngle(),d=this.rotateAnchorOffset(),f=x.degToRad(h),g=Math.sin(f),u=-Math.cos(f),_=n/2,C=s/2;let b=1/0;u<0?b=Math.min(b,-C/u):u>0&&(b=Math.min(b,(s-C)/u)),g<0?b=Math.min(b,-_/g):g>0&&(b=Math.min(b,(n-_)/g));const v=_+g*b,w=C+u*b,S=x._sign(s);this._batchChangeChild(".rotater",{x:v+g*d*S,y:w+u*d*S-a*u,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:s,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(k=>k.draggable()),x:0,y:0});const I=this.anchorStyleFunc();I&&c.forEach(k=>{I(k)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),fi.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return L.prototype.toObject.call(this)}clone(t){return L.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}rt.isTransforming=()=>Is>0;function yd(i){return i instanceof Array||x.warn("enabledAnchors value should be an array"),i instanceof Array&&i.forEach(function(t){En.indexOf(t)===-1&&x.warn("Unknown anchor name: "+t+". Available names are: "+En.join(", "))}),i||[]}rt.prototype.className="Transformer";St(rt);p.addGetterSetter(rt,"enabledAnchors",En,yd);p.addGetterSetter(rt,"flipEnabled",!0,Qt());p.addGetterSetter(rt,"resizeEnabled",!0);p.addGetterSetter(rt,"anchorSize",10,G());p.addGetterSetter(rt,"rotateEnabled",!0);p.addGetterSetter(rt,"rotateLineVisible",!0);p.addGetterSetter(rt,"rotationSnaps",[]);p.addGetterSetter(rt,"rotateAnchorOffset",50,G());p.addGetterSetter(rt,"rotateAnchorAngle",0,G());p.addGetterSetter(rt,"rotateAnchorCursor","crosshair");p.addGetterSetter(rt,"rotationSnapTolerance",5,G());p.addGetterSetter(rt,"borderEnabled",!0);p.addGetterSetter(rt,"anchorStroke","rgb(0, 161, 255)");p.addGetterSetter(rt,"anchorStrokeWidth",1,G());p.addGetterSetter(rt,"anchorFill","white");p.addGetterSetter(rt,"anchorCornerRadius",0,G());p.addGetterSetter(rt,"borderStroke","rgb(0, 161, 255)");p.addGetterSetter(rt,"borderStrokeWidth",1,G());p.addGetterSetter(rt,"borderDash");p.addGetterSetter(rt,"keepRatio",!0);p.addGetterSetter(rt,"shiftBehavior","default");p.addGetterSetter(rt,"centeredScaling",!1);p.addGetterSetter(rt,"ignoreStroke",!1);p.addGetterSetter(rt,"padding",0,G());p.addGetterSetter(rt,"nodes");p.addGetterSetter(rt,"node");p.addGetterSetter(rt,"boundBoxFunc");p.addGetterSetter(rt,"anchorDragBoundFunc");p.addGetterSetter(rt,"anchorStyleFunc");p.addGetterSetter(rt,"shouldOverdrawWholeArea",!1);p.addGetterSetter(rt,"useSingleNodeRotation",!0);p.backCompat(rt,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class ve extends E{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,B.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}ve.prototype.className="Wedge";ve.prototype._centroid=!0;ve.prototype._attrsAffectingSize=["radius"];St(ve);p.addGetterSetter(ve,"radius",0,G());p.addGetterSetter(ve,"angle",0,G());p.addGetterSetter(ve,"clockwise",!1);p.backCompat(ve,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function ho(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const bd=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],xd=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function vd(i,t){const e=i.data,n=i.width,s=i.height;let r,o,a,l,c,h,d,f,g,u,_,C,b,v,w,S,I,k,K,F;const X=t+t+1,D=n-1,O=s-1,N=t+1,tt=N*(N+1)/2,it=new ho,q=bd[t],W=xd[t];let Q=null,z=it,ot=null,xt=null;for(let st=1;st<X;st++)z=z.next=new ho,st===N&&(Q=z);z.next=it,a=o=0;for(let st=0;st<s;st++){C=b=v=w=l=c=h=d=0,f=N*(S=e[o]),g=N*(I=e[o+1]),u=N*(k=e[o+2]),_=N*(K=e[o+3]),l+=tt*S,c+=tt*I,h+=tt*k,d+=tt*K,z=it;for(let lt=0;lt<N;lt++)z.r=S,z.g=I,z.b=k,z.a=K,z=z.next;for(let lt=1;lt<N;lt++)r=o+((D<lt?D:lt)<<2),l+=(z.r=S=e[r])*(F=N-lt),c+=(z.g=I=e[r+1])*F,h+=(z.b=k=e[r+2])*F,d+=(z.a=K=e[r+3])*F,C+=S,b+=I,v+=k,w+=K,z=z.next;ot=it,xt=Q;for(let lt=0;lt<n;lt++)e[o+3]=K=d*q>>W,K!==0?(K=255/K,e[o]=(l*q>>W)*K,e[o+1]=(c*q>>W)*K,e[o+2]=(h*q>>W)*K):e[o]=e[o+1]=e[o+2]=0,l-=f,c-=g,h-=u,d-=_,f-=ot.r,g-=ot.g,u-=ot.b,_-=ot.a,r=a+((r=lt+t+1)<D?r:D)<<2,C+=ot.r=e[r],b+=ot.g=e[r+1],v+=ot.b=e[r+2],w+=ot.a=e[r+3],l+=C,c+=b,h+=v,d+=w,ot=ot.next,f+=S=xt.r,g+=I=xt.g,u+=k=xt.b,_+=K=xt.a,C-=S,b-=I,v-=k,w-=K,xt=xt.next,o+=4;a+=n}for(let st=0;st<n;st++){b=v=w=C=c=h=d=l=0,o=st<<2,f=N*(S=e[o]),g=N*(I=e[o+1]),u=N*(k=e[o+2]),_=N*(K=e[o+3]),l+=tt*S,c+=tt*I,h+=tt*k,d+=tt*K,z=it;for(let At=0;At<N;At++)z.r=S,z.g=I,z.b=k,z.a=K,z=z.next;let lt=n;for(let At=1;At<=t;At++)o=lt+st<<2,l+=(z.r=S=e[o])*(F=N-At),c+=(z.g=I=e[o+1])*F,h+=(z.b=k=e[o+2])*F,d+=(z.a=K=e[o+3])*F,C+=S,b+=I,v+=k,w+=K,z=z.next,At<O&&(lt+=n);o=st,ot=it,xt=Q;for(let At=0;At<s;At++)r=o<<2,e[r+3]=K=d*q>>W,K>0?(K=255/K,e[r]=(l*q>>W)*K,e[r+1]=(c*q>>W)*K,e[r+2]=(h*q>>W)*K):e[r]=e[r+1]=e[r+2]=0,l-=f,c-=g,h-=u,d-=_,f-=ot.r,g-=ot.g,u-=ot.b,_-=ot.a,r=st+((r=At+N)<O?r:O)*n<<2,l+=C+=ot.r=e[r],c+=b+=ot.g=e[r+1],h+=v+=ot.b=e[r+2],d+=w+=ot.a=e[r+3],ot=ot.next,f+=S=xt.r,g+=I=xt.g,u+=k=xt.b,_+=K=xt.a,C-=S,b-=I,v-=k,w-=K,xt=xt.next,o+=n}}const Sd=function(t){const e=Math.round(this.blurRadius());e>0&&vd(t,e)};p.addGetterSetter(L,"blurRadius",0,G(),p.afterSetFilter);const Cd=function(i){const t=this.brightness()*255,e=i.data,n=e.length;for(let s=0;s<n;s+=4)e[s]+=t,e[s+1]+=t,e[s+2]+=t};p.addGetterSetter(L,"brightness",0,G(),p.afterSetFilter);const wd=function(i){const t=this.brightness(),e=i.data,n=e.length;for(let s=0;s<n;s+=4)e[s]=Math.min(255,e[s]*t),e[s+1]=Math.min(255,e[s+1]*t),e[s+2]=Math.min(255,e[s+2]*t)},Td=function(i){const t=Math.pow((this.contrast()+100)/100,2),e=i.data,n=e.length;let s=150,r=150,o=150;for(let a=0;a<n;a+=4)s=e[a],r=e[a+1],o=e[a+2],s/=255,s-=.5,s*=t,s+=.5,s*=255,r/=255,r-=.5,r*=t,r+=.5,r*=255,o/=255,o-=.5,o*=t,o+=.5,o*=255,s=s<0?0:s>255?255:s,r=r<0?0:r>255?255:r,o=o<0?0:o>255?255:o,e[a]=s,e[a+1]=r,e[a+2]=o};p.addGetterSetter(L,"contrast",0,G(),p.afterSetFilter);const Pd=function(i){var t,e,n,s,r,o,a,l,c;const h=i.data,d=i.width,f=i.height,g=Math.min(1,Math.max(0,(e=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&e!==void 0?e:.5)),u=Math.min(1,Math.max(0,(s=(n=this.embossWhiteLevel)===null||n===void 0?void 0:n.call(this))!==null&&s!==void 0?s:.5)),C=(a={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(o=(r=this.embossDirection)===null||r===void 0?void 0:r.call(this))!==null&&o!==void 0?o:"top-left"])!==null&&a!==void 0?a:315,b=!!((c=(l=this.embossBlend)===null||l===void 0?void 0:l.call(this))!==null&&c!==void 0&&c),v=g*10,w=u*255,S=C*Math.PI/180,I=Math.cos(S),k=Math.sin(S),K=128/1020*v,F=new Uint8ClampedArray(h),X=new Float32Array(d*f);for(let it=0,q=0;q<h.length;q+=4,it++)X[it]=.2126*F[q]+.7152*F[q+1]+.0722*F[q+2];const D=[-1,0,1,-2,0,2,-1,0,1],O=[-1,-2,-1,0,0,0,1,2,1],N=[-d-1,-d,-d+1,-1,0,1,d-1,d,d+1],tt=it=>it<0?0:it>255?255:it;for(let it=1;it<f-1;it++)for(let q=1;q<d-1;q++){const W=it*d+q;let Q=0,z=0;Q+=X[W+N[0]]*D[0],z+=X[W+N[0]]*O[0],Q+=X[W+N[1]]*D[1],z+=X[W+N[1]]*O[1],Q+=X[W+N[2]]*D[2],z+=X[W+N[2]]*O[2],Q+=X[W+N[3]]*D[3],z+=X[W+N[3]]*O[3],Q+=X[W+N[5]]*D[5],z+=X[W+N[5]]*O[5],Q+=X[W+N[6]]*D[6],z+=X[W+N[6]]*O[6],Q+=X[W+N[7]]*D[7],z+=X[W+N[7]]*O[7],Q+=X[W+N[8]]*D[8],z+=X[W+N[8]]*O[8];const ot=I*Q+k*z,xt=tt(w+ot*K),st=W*4;if(b){const lt=xt-w;h[st]=tt(F[st]+lt),h[st+1]=tt(F[st+1]+lt),h[st+2]=tt(F[st+2]+lt),h[st+3]=F[st+3]}else h[st]=h[st+1]=h[st+2]=xt,h[st+3]=F[st+3]}for(let it=0;it<d;it++){let q=it*4,W=((f-1)*d+it)*4;h[q]=F[q],h[q+1]=F[q+1],h[q+2]=F[q+2],h[q+3]=F[q+3],h[W]=F[W],h[W+1]=F[W+1],h[W+2]=F[W+2],h[W+3]=F[W+3]}for(let it=1;it<f-1;it++){let q=it*d*4,W=(it*d+(d-1))*4;h[q]=F[q],h[q+1]=F[q+1],h[q+2]=F[q+2],h[q+3]=F[q+3],h[W]=F[W],h[W+1]=F[W+1],h[W+2]=F[W+2],h[W+3]=F[W+3]}return i};p.addGetterSetter(L,"embossStrength",.5,G(),p.afterSetFilter);p.addGetterSetter(L,"embossWhiteLevel",.5,G(),p.afterSetFilter);p.addGetterSetter(L,"embossDirection","top-left",void 0,p.afterSetFilter);p.addGetterSetter(L,"embossBlend",!1,void 0,p.afterSetFilter);function hs(i,t,e,n,s){const r=e-t,o=s-n;if(r===0)return n+o/2;if(o===0)return n;let a=(i-t)/r;return a=o*a+n,a}const Ad=function(i){const t=i.data,e=t.length;let n=t[0],s=n,r,o=t[1],a=o,l,c=t[2],h=c,d;const f=this.enhance();if(f===0)return;for(let w=0;w<e;w+=4)r=t[w+0],r<n?n=r:r>s&&(s=r),l=t[w+1],l<o?o=l:l>a&&(a=l),d=t[w+2],d<c?c=d:d>h&&(h=d);s===n&&(s=255,n=0),a===o&&(a=255,o=0),h===c&&(h=255,c=0);let g,u,_,C,b,v;if(f>0)g=s+f*(255-s),u=n-f*(n-0),_=a+f*(255-a),C=o-f*(o-0),b=h+f*(255-h),v=c-f*(c-0);else{const w=(s+n)*.5;g=s+f*(s-w),u=n+f*(n-w);const S=(a+o)*.5;_=a+f*(a-S),C=o+f*(o-S);const I=(h+c)*.5;b=h+f*(h-I),v=c+f*(c-I)}for(let w=0;w<e;w+=4)t[w+0]=hs(t[w+0],n,s,u,g),t[w+1]=hs(t[w+1],o,a,C,_),t[w+2]=hs(t[w+2],c,h,v,b)};p.addGetterSetter(L,"enhance",0,G(),p.afterSetFilter);const Ed=function(i){const t=i.data,e=t.length;for(let n=0;n<e;n+=4){const s=.34*t[n]+.5*t[n+1]+.16*t[n+2];t[n]=s,t[n+1]=s,t[n+2]=s}};p.addGetterSetter(L,"hue",0,G(),p.afterSetFilter);p.addGetterSetter(L,"saturation",0,G(),p.afterSetFilter);p.addGetterSetter(L,"luminance",0,G(),p.afterSetFilter);const Rd=function(i){const t=i.data,e=t.length,n=1,s=Math.pow(2,this.saturation()),r=Math.abs(this.hue()+360)%360,o=this.luminance()*127,a=n*s*Math.cos(r*Math.PI/180),l=n*s*Math.sin(r*Math.PI/180),c=.299*n+.701*a+.167*l,h=.587*n-.587*a+.33*l,d=.114*n-.114*a-.497*l,f=.299*n-.299*a-.328*l,g=.587*n+.413*a+.035*l,u=.114*n-.114*a+.293*l,_=.299*n-.3*a+1.25*l,C=.587*n-.586*a-1.05*l,b=.114*n+.886*a-.2*l;let v,w,S,I;for(let k=0;k<e;k+=4)v=t[k+0],w=t[k+1],S=t[k+2],I=t[k+3],t[k+0]=c*v+h*w+d*S+o,t[k+1]=f*v+g*w+u*S+o,t[k+2]=_*v+C*w+b*S+o,t[k+3]=I},Md=function(i){const t=i.data,e=t.length,n=Math.pow(2,this.value()),s=Math.pow(2,this.saturation()),r=Math.abs(this.hue()+360)%360,o=n*s*Math.cos(r*Math.PI/180),a=n*s*Math.sin(r*Math.PI/180),l=.299*n+.701*o+.167*a,c=.587*n-.587*o+.33*a,h=.114*n-.114*o-.497*a,d=.299*n-.299*o-.328*a,f=.587*n+.413*o+.035*a,g=.114*n-.114*o+.293*a,u=.299*n-.3*o+1.25*a,_=.587*n-.586*o-1.05*a,C=.114*n+.886*o-.2*a;for(let b=0;b<e;b+=4){const v=t[b+0],w=t[b+1],S=t[b+2],I=t[b+3];t[b+0]=l*v+c*w+h*S,t[b+1]=d*v+f*w+g*S,t[b+2]=u*v+_*w+C*S,t[b+3]=I}};p.addGetterSetter(L,"hue",0,G(),p.afterSetFilter);p.addGetterSetter(L,"saturation",0,G(),p.afterSetFilter);p.addGetterSetter(L,"value",0,G(),p.afterSetFilter);const kd=function(i){const t=i.data,e=t.length;for(let n=0;n<e;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]},Od=function(i,t,e){const n=i.data,s=t.data,r=i.width,o=i.height,a=e.polarCenterX||r/2,l=e.polarCenterY||o/2;let c=Math.sqrt(a*a+l*l),h=r-a,d=o-l;const f=Math.sqrt(h*h+d*d);c=f>c?f:c;const g=o,u=r,_=360/u*Math.PI/180;for(let C=0;C<u;C+=1){const b=Math.sin(C*_),v=Math.cos(C*_);for(let w=0;w<g;w+=1){h=Math.floor(a+c*w/g*v),d=Math.floor(l+c*w/g*b);let S=(d*r+h)*4;const I=n[S+0],k=n[S+1],K=n[S+2],F=n[S+3];S=(C+w*r)*4,s[S+0]=I,s[S+1]=k,s[S+2]=K,s[S+3]=F}}},Ld=function(i,t,e){const n=i.data,s=t.data,r=i.width,o=i.height,a=e.polarCenterX||r/2,l=e.polarCenterY||o/2;let c=Math.sqrt(a*a+l*l),h=r-a,d=o-l;const f=Math.sqrt(h*h+d*d);c=f>c?f:c;const g=o,u=r,_=0;let C,b;for(h=0;h<r;h+=1)for(d=0;d<o;d+=1){const v=h-a,w=d-l,S=Math.sqrt(v*v+w*w)*g/c;let I=(Math.atan2(w,v)*180/Math.PI+360+_)%360;I=I*u/360,C=Math.floor(I),b=Math.floor(S);let k=(b*r+C)*4;const K=n[k+0],F=n[k+1],X=n[k+2],D=n[k+3];k=(d*r+h)*4,s[k+0]=K,s[k+1]=F,s[k+2]=X,s[k+3]=D}},Id=function(i){const t=i.width,e=i.height;let n,s,r,o,a,l,c,h,d,f,g=Math.round(this.kaleidoscopePower());const u=Math.round(this.kaleidoscopeAngle()),_=Math.floor(t*(u%360)/360);if(g<1)return;const C=x.createCanvasElement();C.width=t,C.height=e;const b=C.getContext("2d").getImageData(0,0,t,e);x.releaseCanvas(C),Od(i,b,{polarCenterX:t/2,polarCenterY:e/2});let v=t/Math.pow(2,g);for(;v<=8;)v=v*2,g-=1;v=Math.ceil(v);let w=v,S=0,I=w,k=1;for(_+v>t&&(S=w,I=0,k=-1),s=0;s<e;s+=1)for(n=S;n!==I;n+=k)r=Math.round(n+_)%t,d=(t*s+r)*4,a=b.data[d+0],l=b.data[d+1],c=b.data[d+2],h=b.data[d+3],f=(t*s+n)*4,b.data[f+0]=a,b.data[f+1]=l,b.data[f+2]=c,b.data[f+3]=h;for(s=0;s<e;s+=1)for(w=Math.floor(v),o=0;o<g;o+=1){for(n=0;n<w+1;n+=1)d=(t*s+n)*4,a=b.data[d+0],l=b.data[d+1],c=b.data[d+2],h=b.data[d+3],f=(t*s+w*2-n-1)*4,b.data[f+0]=a,b.data[f+1]=l,b.data[f+2]=c,b.data[f+3]=h;w*=2}Ld(b,i,{})};p.addGetterSetter(L,"kaleidoscopePower",2,G(),p.afterSetFilter);p.addGetterSetter(L,"kaleidoscopeAngle",0,G(),p.afterSetFilter);function pn(i,t,e){let n=(e*i.width+t)*4;const s=[];return s.push(i.data[n++],i.data[n++],i.data[n++],i.data[n++]),s}function Pi(i,t){return Math.sqrt(Math.pow(i[0]-t[0],2)+Math.pow(i[1]-t[1],2)+Math.pow(i[2]-t[2],2))}function Gd(i){const t=[0,0,0];for(let e=0;e<i.length;e++)t[0]+=i[e][0],t[1]+=i[e][1],t[2]+=i[e][2];return t[0]/=i.length,t[1]/=i.length,t[2]/=i.length,t}function Dd(i,t){const e=pn(i,0,0),n=pn(i,i.width-1,0),s=pn(i,0,i.height-1),r=pn(i,i.width-1,i.height-1),o=t||10;if(Pi(e,n)<o&&Pi(n,r)<o&&Pi(r,s)<o&&Pi(s,e)<o){const a=Gd([n,e,r,s]),l=[];for(let c=0;c<i.width*i.height;c++){const h=Pi(a,[i.data[c*4],i.data[c*4+1],i.data[c*4+2]]);l[c]=h<o?0:255}return l}}function Fd(i,t){for(let e=0;e<i.width*i.height;e++)i.data[4*e+3]=t[e]}function Nd(i,t,e){const n=[1,1,1,1,0,1,1,1,1],s=Math.round(Math.sqrt(n.length)),r=Math.floor(s/2),o=[];for(let a=0;a<e;a++)for(let l=0;l<t;l++){const c=a*t+l;let h=0;for(let d=0;d<s;d++)for(let f=0;f<s;f++){const g=a+d-r,u=l+f-r;if(g>=0&&g<e&&u>=0&&u<t){const _=g*t+u,C=n[d*s+f];h+=i[_]*C}}o[c]=h===2040?255:0}return o}function Bd(i,t,e){const n=[1,1,1,1,1,1,1,1,1],s=Math.round(Math.sqrt(n.length)),r=Math.floor(s/2),o=[];for(let a=0;a<e;a++)for(let l=0;l<t;l++){const c=a*t+l;let h=0;for(let d=0;d<s;d++)for(let f=0;f<s;f++){const g=a+d-r,u=l+f-r;if(g>=0&&g<e&&u>=0&&u<t){const _=g*t+u,C=n[d*s+f];h+=i[_]*C}}o[c]=h>=1020?255:0}return o}function Hd(i,t,e){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],s=Math.round(Math.sqrt(n.length)),r=Math.floor(s/2),o=[];for(let a=0;a<e;a++)for(let l=0;l<t;l++){const c=a*t+l;let h=0;for(let d=0;d<s;d++)for(let f=0;f<s;f++){const g=a+d-r,u=l+f-r;if(g>=0&&g<e&&u>=0&&u<t){const _=g*t+u,C=n[d*s+f];h+=i[_]*C}}o[c]=h}return o}const Wd=function(i){const t=this.threshold();let e=Dd(i,t);return e&&(e=Nd(e,i.width,i.height),e=Bd(e,i.width,i.height),e=Hd(e,i.width,i.height),Fd(i,e)),i};p.addGetterSetter(L,"threshold",0,G(),p.afterSetFilter);const zd=function(i){const t=this.noise()*255,e=i.data,n=e.length,s=t/2;for(let r=0;r<n;r+=4)e[r+0]+=s-2*s*Math.random(),e[r+1]+=s-2*s*Math.random(),e[r+2]+=s-2*s*Math.random()};p.addGetterSetter(L,"noise",.2,G(),p.afterSetFilter);const Ud=function(i){let t=Math.ceil(this.pixelSize()),e=i.width,n=i.height,s=Math.ceil(e/t),r=Math.ceil(n/t),o=i.data;if(t<=0){x.error("pixelSize value can not be <= 0");return}for(let a=0;a<s;a+=1)for(let l=0;l<r;l+=1){let c=0,h=0,d=0,f=0;const g=a*t,u=g+t,_=l*t,C=_+t;let b=0;for(let v=g;v<u;v+=1)if(!(v>=e))for(let w=_;w<C;w+=1){if(w>=n)continue;const S=(e*w+v)*4;c+=o[S+0],h+=o[S+1],d+=o[S+2],f+=o[S+3],b+=1}c=c/b,h=h/b,d=d/b,f=f/b;for(let v=g;v<u;v+=1)if(!(v>=e))for(let w=_;w<C;w+=1){if(w>=n)continue;const S=(e*w+v)*4;o[S+0]=c,o[S+1]=h,o[S+2]=d,o[S+3]=f}}};p.addGetterSetter(L,"pixelSize",8,G(),p.afterSetFilter);const Yd=function(i){const t=Math.round(this.levels()*254)+1,e=i.data,n=e.length,s=255/t;for(let r=0;r<n;r+=1)e[r]=Math.floor(e[r]/s)*s};p.addGetterSetter(L,"levels",.5,G(),p.afterSetFilter);const jd=function(i){const t=i.data,e=t.length,n=this.red(),s=this.green(),r=this.blue();for(let o=0;o<e;o+=4){const a=(.34*t[o]+.5*t[o+1]+.16*t[o+2])/255;t[o]=a*n,t[o+1]=a*s,t[o+2]=a*r,t[o+3]=t[o+3]}};p.addGetterSetter(L,"red",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)});p.addGetterSetter(L,"green",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)});p.addGetterSetter(L,"blue",0,Ca,p.afterSetFilter);const Kd=function(i){const t=i.data,e=t.length,n=this.red(),s=this.green(),r=this.blue(),o=this.alpha();for(let a=0;a<e;a+=4){const l=1-o;t[a]=n*o+t[a]*l,t[a+1]=s*o+t[a+1]*l,t[a+2]=r*o+t[a+2]*l}};p.addGetterSetter(L,"red",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)});p.addGetterSetter(L,"green",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)});p.addGetterSetter(L,"blue",0,Ca,p.afterSetFilter);p.addGetterSetter(L,"alpha",1,function(i){return this._filterUpToDate=!1,i>1?1:i<0?0:i});const Xd=function(i){const t=i.data,e=t.length;for(let n=0;n<e;n+=4){const s=t[n+0],r=t[n+1],o=t[n+2];t[n+0]=Math.min(255,s*.393+r*.769+o*.189),t[n+1]=Math.min(255,s*.349+r*.686+o*.168),t[n+2]=Math.min(255,s*.272+r*.534+o*.131)}},Vd=function(i){const e=i.data;for(let n=0;n<e.length;n+=4){const s=e[n],r=e[n+1],o=e[n+2];.2126*s+.7152*r+.0722*o>=128&&(e[n]=255-s,e[n+1]=255-r,e[n+2]=255-o)}return i},$d=function(i){const t=this.threshold()*255,e=i.data,n=e.length;for(let s=0;s<n;s+=1)e[s]=e[s]<t?0:255};p.addGetterSetter(L,"threshold",.5,G(),p.afterSetFilter);const re=Jr.Util._assign(Jr,{Arc:be,Arrow:qe,Circle:gi,Ellipse:De,Image:jt,Label:sr,Tag:Qe,Line:xe,Path:_t,Rect:tn,RegularPolygon:Fe,Ring:Je,Sprite:he,Star:Ne,Text:bt,TextPath:Pt,Transformer:rt,Wedge:ve,Filters:{Blur:Sd,Brightness:wd,Brighten:Cd,Contrast:Td,Emboss:Pd,Enhance:Ad,Grayscale:Ed,HSL:Rd,HSV:Md,Invert:kd,Kaleidoscope:Id,Mask:Wd,Noise:zd,Pixelate:Ud,Posterize:Yd,RGB:jd,RGBA:Kd,Sepia:Xd,Solarize:Vd,Threshold:$d}}),qd=1.3;let Et=null,si=null,Nt=null,Vt=null,Ue={},Le=null,ui=new Map,Rn=null,Mn=null;function tl(){if(!Vt)return null;const i=Vt.nodes();return i&&i.length>0?i[0]:null}function co(i,t){return!i||!t?!0:i.x>=t.x&&i.y>=t.y&&i.x+i.width<=t.x+t.width&&i.y+i.height<=t.y+t.height}function cs(i){if(!i)return!0;const t=Rn?co(i,Rn):!0,e=Mn?co(i,Mn):!0;return t&&e}function Qd(i,t,e,n){if(!i||!t)return;Ue=e||{},Le=n;const s=i.offsetWidth,r=i.offsetHeight;Et&&Et.destroy(),Et=new re.Stage({container:i,width:s,height:r}),Mn={x:0,y:0,width:s,height:r},si=new re.Layer,Et.add(si);const o=s/320,a=r/420,l=Math.min(o,a),c=new re.Path({data:t.path,fill:"#151F2E",stroke:"#334155",strokeWidth:3/l,shadowColor:"black",shadowBlur:20,shadowOpacity:.5,scaleX:l,scaleY:l,x:(s-300*l)/2,y:(r-400*l)/2});si.add(c),Rn=c.getClientRect(),t.ribs&&t.ribs.forEach(h=>{const d=new re.Rect({x:h.x*l+c.x(),y:h.y*l+c.y(),width:h.w*l,height:h.h*l,fill:"rgba(255, 50, 50, 0.25)",stroke:"rgba(255, 50, 50, 0.5)",strokeWidth:1,name:"rib",listening:!1});si.add(d)}),Nt=new re.Layer,Et.add(Nt),Vt=new re.Transformer({anchorStroke:"#88E523",anchorFill:"#0B121E",anchorSize:15,borderStroke:"#88E523",borderDash:[4,4],centeredScaling:!0,rotateEnabled:!0}),Nt.add(Vt),Et.on("click tap",h=>{(h.target===Et||h.target===c)&&Vt.nodes([])}),si.draw(),Nt.draw()}function Jd(){Et&&(Et.destroy(),Et=null),si=null,Nt=null,Vt=null,Ue={},Le=null,ui.clear(),Rn=null,Mn=null}function Zd(i,t,e){if(!e||e.length===0)return 0;const n=[...e].sort((s,r)=>s.area-r.area);if(i<=n[0].area)return Ue[n[0].code]||n[0].basePrice||0;if(i>=n[n.length-1].area){const s=n[n.length-1];return Ue[s.code]||s.basePrice||0}for(let s=0;s<n.length-1;s++){const r=n[s],o=n[s+1];if(i>=r.area&&i<=o.area){const a=Ue[r.code]||r.basePrice||0,l=Ue[o.code]||o.basePrice||0,c=(i-r.area)/(o.area-r.area);return a+(l-a)*c}}return Ue[n[0].code]||n[0].basePrice||0}function el(i,t,e,n){if(!i||!Et)return;const s=i.scaleX(),r=i.scaleY();let o=0;i.className==="Ellipse"?o=Math.PI*(i.radiusX()*s)*(i.radiusY()*r):o=i.width()*s*(i.height()*r);const a=i.getClientRect(),l=Et.find(".rib");let c=!1;for(let f of l)if(re.Util.haveIntersection(f.getClientRect(),a)){c=!0;break}let h=Zd(o,t,n);c&&(h*=qd),c?(i.stroke("#FF4444"),i.fill("rgba(255, 68, 68, 0.3)")):(i.stroke(t==="circle"?"#88E523":"#A0AEC0"),i.fill(t==="circle"?"rgba(136, 229, 35, 0.3)":"rgba(200, 200, 200, 0.3)"));const d={id:e,type:t,areaPx:o,isComplex:c,price:h};if(ui.set(e,d),Le){const f=Array.from(ui.values());Le(f)}}function tf(i,t,e){if(!Et||!Nt||!Vt)return;const n=e.find(h=>h.code===t);if(!n)return;const s=Et.width()/2,r=Et.height()/2,o=Date.now();let a;i==="circle"?a=new re.Ellipse({x:s,y:r,radiusX:n.radius,radiusY:n.radius,fill:"rgba(136, 229, 35, 0.3)",stroke:"#88E523",strokeWidth:2,draggable:!0,name:"dent",id:o.toString()}):a=new re.Rect({x:s-n.w/2,y:r-n.h/2,width:n.w,height:n.h,cornerRadius:5,fill:"rgba(200, 200, 200, 0.3)",stroke:"#A0AEC0",strokeWidth:2,draggable:!0,name:"dent",id:o.toString()}),a._dentMeta={id:o,type:i,sizes:e},a.dragBoundFunc(h=>{const d=a.position(),f=a.getClientRect(),g=h.x-d.x,u=h.y-d.y,_={x:f.x+g,y:f.y+u,width:f.width,height:f.height};return cs(_)?h:d});const l=()=>{a._lastGoodTransform={x:a.x(),y:a.y(),scaleX:a.scaleX(),scaleY:a.scaleY(),rotation:a.rotation()}};l();const c=()=>{el(a,i,o,e);const h=a.getClientRect();cs(h)&&l()};a.on("dragmove transform",c),a.on("transformend",()=>{const h=a.getClientRect();!cs(h)&&a._lastGoodTransform&&a.setAttrs(a._lastGoodTransform),c()}),a.on("click tap",()=>{Vt.nodes([a])}),Nt.add(a),Vt.nodes([a]),c()}function fo(i){const t=tl();if(!t)return;t.rotation(t.rotation()+i);const e=t._dentMeta;e&&el(t,e.type,e.id,e.sizes),t.getLayer()&&t.getLayer().batchDraw()}function uo(){const i=tl();if(!i||!i._dentMeta)return;const t=i._dentMeta.id;if(ui.delete(t),Vt.nodes([]),i.destroy(),Nt&&Nt.draw(),Le){const e=Array.from(ui.values());Le(e)}}function go(){Nt&&(Nt.destroyChildren(),ui.clear(),Et&&Nt&&(Vt=new re.Transformer({anchorStroke:"#88E523",anchorFill:"#0B121E",anchorSize:15,borderStroke:"#88E523",borderDash:[4,4],centeredScaling:!0,rotateEnabled:!0}),Nt.add(Vt),Nt.draw()),Le&&Le([]))}const ii={repairTypes:[{code:"R1",name:" ",mult:1},{code:"R2",name:" ",mult:.85}],materials:[{code:"M1",name:"",mult:1},{code:"M2",name:"",mult:1.3}],carClasses:[{code:"CLASS_STD",name:"",mult:1},{code:"CLASS_PREM",name:" / ",mult:1.2}],risks:[{code:"RK1",name:"",matrixKey:"K1"},{code:"RK2",name:"",matrixKey:"K2"},{code:"RK3",name:"",matrixKey:"K3"},{code:"RK4",name:"",matrixKey:"K4"}],disassembly:[{code:"Z0",name:" ",price:0},{code:"Z1",name:"",price:1e3},{code:"Z2",name:"",price:2e3},{code:"Z3",name:"",price:4e3},{code:"Z4",name:"+",price:3e3}],defaultMasters:[{name:"",rate:5e3},{name:"",rate:2500}],circleSizes:[{code:"S2",name:" ",basePrice:2e3,radius:15,area:706},{code:"S4",name:"  ",basePrice:3e3,radius:25,area:1963},{code:"S6",name:" ",basePrice:5e3,radius:35,area:3848},{code:"S8",name:" ",basePrice:7e3,radius:45,area:6361},{code:"S10",name:"  ",basePrice:12e3,radius:60,area:11309},{code:"S11",name:" ",basePrice:15e3,radius:75,area:17671}],stripSizes:[{code:"LS1",name:" . ",basePrice:4e3,w:40,h:20,area:800},{code:"LS2",name:" ",basePrice:6e3,w:80,h:10,area:800},{code:"LS3",name:" ",basePrice:9e3,w:120,h:10,area:1200},{code:"LS4",name:" ",basePrice:13e3,w:150,h:50,area:7500},{code:"LS5",name:" ",basePrice:16e3,w:200,h:100,area:2e4},{code:"LS6",name:" ",basePrice:22e3,w:250,h:150,area:37500},{code:"LS7",name:" ",basePrice:3e4,w:280,h:200,area:56e3},{code:"LS8",name:" ",basePrice:42e3,w:300,h:300,area:9e4}],complexityMatrix:{S2:{K1:1,K2:1.15,K3:2.3,K4:4},S4:{K1:1,K2:1.6,K3:2.3,K4:4},S6:{K1:1,K2:1.4,K3:2,K4:3},S8:{K1:1,K2:1.4,K3:1.8,K4:3},S10:{K1:1,K2:1.3,K3:1.6,K4:2.2},S11:{K1:1,K2:1.2,K3:1.9,K4:2.7},STRIP_DEFAULT:{K1:.95,K2:1,K3:1.15,K4:1.3}}},ef={door:{id:"door",name:"",icon:"door",path:"M20,20 L280,20 Q300,20 300,50 L300,350 Q300,380 280,380 L20,380 Q0,380 0,350 L0,50 Q0,20 20,20 Z",ribs:[{x:0,y:150,w:300,h:20},{x:0,y:320,w:300,h:30}]},hood:{id:"hood",name:"",icon:"hood",path:"M50,20 L250,20 Q280,20 290,100 L300,350 Q300,380 150,390 Q0,380 0,350 L10,100 Q20,20 50,20 Z",ribs:[{x:140,y:20,w:20,h:370},{x:50,y:100,w:200,h:20}]},fender:{id:"fender",name:"",icon:"fender",path:"M20,20 L250,20 Q280,20 280,100 L280,350 Q150,250 20,350 L20,20 Z",ribs:[{x:20,y:180,w:260,h:40}]},trunk:{id:"trunk",name:"",icon:"trunk",path:"M20,20 L280,20 L280,350 L20,350 Z",ribs:[{x:0,y:200,w:300,h:30}]}},nf=(i,t)=>{const e=i.__vccOpts||i;for(const[n,s]of t)e[n]=s;return e},sf={id:"app",class:"max-w-md mx-auto relative h-screen flex flex-col bg-black text-white"},rf={key:0,class:"h-full flex flex-col"},of={key:0,class:"space-y-4 animate-fade-in pt-4 p-4"},af=["onClick"],lf={class:"text-4xl"},hf={class:"font-bold text-lg tracking-wide"},cf={key:1,class:"animate-fade-in h-full flex flex-col pt-4 p-4"},df={class:"flex items-center justify-between mb-4"},ff={class:"grid grid-cols-2 gap-3"},uf=["onClick"],gf={class:"text-metric-green text-opacity-80 font-black text-2xl"},pf={key:0},mf={key:1},_f={key:2},yf={key:3},bf={key:4},xf={class:"font-medium text-sm"},vf={key:2,class:"flex flex-col h-full animate-fade-in pt-2 p-4"},Sf={class:"flex justify-between items-center mb-2"},Cf={class:"text-xs text-metric-green font-bold uppercase tracking-widest"},wf={class:"flex-1 relative border border-white/10 rounded-xl overflow-hidden shadow-2xl konva-bg w-full min-h-[300px]",id:"canvas-wrapper"},Tf={key:0,class:"absolute inset-0 flex items-center justify-center pointer-events-none opacity-50"},Pf={class:"mt-3 grid grid-cols-2 gap-3"},Af={class:"bg-[#151F2E] w-full rounded-t-2xl p-5 border-t border-white/10 shadow-2xl space-y-4 pb-8"},Ef={class:"flex justify-between items-center border-b border-white/5 pb-3"},Rf={class:"text-white font-bold text-lg pl-1"},Mf={class:"grid grid-cols-2 gap-3 max-h-[50vh] overflow-y-auto"},kf=["onClick"],Of={class:"text-metric-green font-bold text-base"},Lf={class:"text-gray-400 text-xs text-center leading-tight"},If={key:1,class:"fixed top-4 left-1/2 transform -translate-x-1/2 z-40 card-metallic rounded-2xl p-4 relative overflow-hidden text-center max-w-[90%]"},Gf={key:0,class:"text-2xl align-top"},Df={__name:"App",setup(i){const t=bi("graphics"),e=bi(1),n=Xi({selectedClass:null,selectedPart:null,dents:[]}),s=bi(!1),r=bi(null),o=bi(null),a={carClasses:[{id:"sedan",name:"",icon:""},{id:"crossover",name:"",icon:""},{id:"suv",name:"",icon:""}],partsList:Object.values(ef)},l=Xi({prices:{}}),c=()=>{const D={};return ii.circleSizes.forEach(O=>D[O.code]=O.basePrice),ii.stripSizes.forEach(O=>D[O.code]=O.basePrice),D};Object.assign(l.prices,c());const h=localStorage.getItem("dentRepairSettings_v5");if(h)try{const D=JSON.parse(h);D.prices&&Object.assign(l.prices,D.prices)}catch(D){console.error("Failed to load settings",D)}const d=D=>new Intl.NumberFormat("ru-RU").format(D),f=D=>{const O=window.Telegram?.WebApp;O?.HapticFeedback&&O.isVersionAtLeast&&O.isVersionAtLeast("6.1")&&O.HapticFeedback.selectionChanged()},g=D=>{n.selectedClass=D,e.value=2,f()},u=D=>{n.selectedPart=D,e.value=3,f(),Wo(()=>{setTimeout(()=>{b()},100)})},_=()=>{e.value=2,n.dents=[],go(),f()},C=()=>{go(),n.dents=[],f()},b=()=>{!o.value||!n.selectedPart||Qd(o.value,n.selectedPart,l.prices,D=>{n.dents=D})},v=D=>{f(),r.value=D,s.value=!0},w=D=>{if(!n.selectedPart)return;f(),s.value=!1;const O=r.value,N=O==="circle"?ii.circleSizes:ii.stripSizes;tf(O,D,N)},S=()=>{fo(-15)},I=()=>{fo(15)},k=()=>{uo()},K=Ss(()=>{if(n.dents.length===0)return 0;const D=[...n.dents].sort((N,tt)=>tt.price-N.price);let O=D[0].price;for(let N=1;N<D.length;N++)O+=D[N].price*.5;return Math.round(O/100)*100}),F=Ss(()=>e.value===3?K.value:0);_n(F,D=>{if(window.Telegram?.WebApp?.MainButton){const O=window.Telegram.WebApp.MainButton;D>0?(O.setText(`: ${d(D)} `),O.show()):O.hide()}});const X=D=>{e.value===3&&(D.key==="Delete"||D.key==="Backspace")&&(D.preventDefault(),uo())};return Qo(()=>{window.Telegram?.WebApp&&(window.Telegram.WebApp.ready(),window.Telegram.WebApp.expand(),window.Telegram.WebApp.MainButton.setParams({color:"#88E523",text_color:"#000000"})),window.addEventListener("keydown",X)}),Jo(()=>{window.removeEventListener("keydown",X),Jd()}),(D,O)=>(Ct(),wt("div",sf,[t.value==="graphics"?(Ct(),wt("div",rf,[e.value===1?(Ct(),wt("div",of,[O[5]||(O[5]=$("h2",{class:"text-xl font-bold text-center mb-4 text-white"}," ",-1)),(Ct(!0),wt(Wt,null,qn(a.carClasses,N=>(Ct(),wt("button",{key:N.id,onClick:tt=>g(N),class:"w-full card-metallic p-6 rounded-2xl flex flex-col items-center gap-3 active:scale-95 transition-transform border border-white/5 hover:border-metric-green/50"},[$("span",lf,ie(N.icon),1),$("span",hf,ie(N.name),1)],8,af))),128))])):Se("",!0),e.value===2?(Ct(),wt("div",cf,[$("div",df,[$("button",{onClick:O[0]||(O[0]=N=>e.value=1),class:"text-sm text-metric-silver hover:text-white px-2"},"   "),O[6]||(O[6]=$("h2",{class:"text-xl font-bold text-white"}," ",-1)),O[7]||(O[7]=$("div",{class:"w-8"},null,-1))]),$("div",ff,[(Ct(!0),wt(Wt,null,qn(a.partsList,N=>(Ct(),wt("button",{key:N.id,onClick:tt=>u(N),class:"aspect-square card-metallic border border-white/5 rounded-2xl flex flex-col items-center justify-center gap-2 active:scale-95 transition-all hover:bg-white/5 hover:border-metric-green/30"},[$("div",gf,[N.icon==="door"?(Ct(),wt("span",pf,"")):N.icon==="hood"?(Ct(),wt("span",mf,"")):N.icon==="fender"?(Ct(),wt("span",_f,"")):N.icon==="trunk"?(Ct(),wt("span",yf,"")):(Ct(),wt("span",bf,""))]),$("span",xf,ie(N.name),1)],8,uf))),128))])])):Se("",!0),e.value===3?(Ct(),wt("div",vf,[$("div",Sf,[$("button",{onClick:_,class:"text-xs text-metric-silver px-2 py-1 rounded border border-white/10 hover:text-white"},"   "),$("span",Cf,ie(n.selectedPart?.name)+"  "+ie(n.selectedClass?.name),1),$("button",{onClick:C,class:"text-xs text-red-400 px-2 py-1 hover:text-red-300"},"  ")]),$("div",wf,[$("div",{ref_key:"konvaContainer",ref:o,id:"konva-container",class:"absolute inset-0 w-full h-full"},null,512),n.dents.length===0?(Ct(),wt("div",Tf,[...O[8]||(O[8]=[$("div",{class:"text-center"},[$("div",{class:"text-2xl mb-1"},""),$("span",{class:"text-xs uppercase font-bold tracking-widest"}," ")],-1)])])):Se("",!0)]),$("div",{class:"mt-3 grid grid-cols-3 gap-2 text-[11px]"},[$("button",{type:"button",class:"card-metallic px-2 py-2 rounded-xl flex flex-col items-center justify-center gap-1 active:scale-95 hover:border-metric-green/30 transition-all",onClick:S},[...O[9]||(O[9]=[$("span",{class:"text-base"}," -15",-1),$("span",{class:"text-[9px] text-gray-500"},"",-1)])]),$("button",{type:"button",class:"card-metallic px-2 py-2 rounded-xl flex flex-col items-center justify-center gap-1 active:scale-95 hover:border-metric-green/30 transition-all",onClick:I},[...O[10]||(O[10]=[$("span",{class:"text-base"}," +15",-1),$("span",{class:"text-[9px] text-gray-500"},"",-1)])]),$("button",{type:"button",class:"card-metallic px-2 py-2 rounded-xl flex flex-col items-center justify-center gap-1 active:scale-95 hover:border-red-400/60 transition-all",onClick:k},[...O[11]||(O[11]=[$("span",{class:"text-base text-red-400"},"",-1),$("span",{class:"text-[9px] text-gray-500"},"",-1)])])]),$("div",Pf,[$("button",{onClick:O[1]||(O[1]=N=>v("circle")),class:"card-metallic p-3 rounded-xl flex items-center gap-3 active:scale-95 hover:border-metric-green/30 transition-all"},[...O[12]||(O[12]=[$("div",{class:"w-6 h-6 rounded-full border-2 border-metric-green bg-metric-green/20"},null,-1),$("div",{class:"text-left"},[$("div",{class:"font-bold text-xs text-white"},""),$("div",{class:"text-[9px] text-gray-500"},"/")],-1)])]),$("button",{onClick:O[2]||(O[2]=N=>v("strip")),class:"card-metallic p-3 rounded-xl flex items-center gap-3 active:scale-95 hover:border-metric-green/30 transition-all"},[...O[13]||(O[13]=[$("div",{class:"w-6 h-2 bg-metric-silver rotate-45 rounded-sm"},null,-1),$("div",{class:"text-left"},[$("div",{class:"font-bold text-xs text-white"},""),$("div",{class:"text-[9px] text-gray-500"},"")],-1)])])])])):Se("",!0),s.value?(Ct(),wt("div",{key:3,class:"absolute inset-0 z-50 flex items-end justify-center bg-black/80 backdrop-blur-sm animate-fade-in",onClick:O[4]||(O[4]=vc(N=>s.value=!1,["self"]))},[$("div",Af,[$("div",Ef,[$("h3",Rf,"   ("+ie(r.value==="circle"?"/":"")+") ",1),$("button",{onClick:O[3]||(O[3]=N=>s.value=!1),class:"text-gray-400 p-2 text-xl"},"")]),$("div",Mf,[(Ct(!0),wt(Wt,null,qn(r.value==="circle"?ms(ii).circleSizes:ms(ii).stripSizes,N=>(Ct(),wt("button",{key:N.code,onClick:tt=>w(N.code),class:"card-metallic p-3 rounded-xl flex flex-col items-center justify-center gap-1 active:scale-95 transition-all hover:border-metric-green/50"},[$("span",Of,ie(N.code),1),$("span",Lf,ie(N.name),1)],8,kf))),128))])])])):Se("",!0)])):Se("",!0),e.value===3?(Ct(),wt("div",If,[O[14]||(O[14]=$("div",{class:"absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-white/10 to-transparent"},null,-1)),O[15]||(O[15]=$("div",{class:"text-[11px] uppercase font-bold text-gray-400 tracking-widest mb-1"}," ",-1)),$("div",{class:Yi(["text-5xl font-black transition-all duration-300",F.value>0?"text-metric-green drop-shadow-[0_0_15px_rgba(136,229,35,0.3)]":"text-gray-600"])},[ba(ie(F.value>0?d(F.value):"---")+" ",1),F.value>0?(Ct(),wt("span",Gf,"")):Se("",!0)],2),$("div",{class:Yi(["absolute bottom-0 left-1/2 transform -translate-x-1/2 w-1/2 h-4 blur-xl transition-all duration-300",F.value>0?"bg-metric-green/10":"bg-transparent"])},null,2)])):Se("",!0)]))}},Ff=nf(Df,[["__scopeId","data-v-29f34815"]]);wc(Ff).mount("#app");
